<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Vue3入门+就业 | 拾贰</title><meta name="keywords" content="Vue3"><meta name="author" content="拾贰"><meta name="copyright" content="拾贰"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Vue3入门+就业"><meta name="application-name" content="Vue3入门+就业"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Vue3入门+就业"><meta property="og:url" content="http://example.com/2024/11/27/Vue3/index.html"><meta property="og:site_name" content="拾贰"><meta property="og:description" content="一、入门1.Vue2和Vue3的简单区别 main.js中组件挂载方式不同  123456789101112131415import &amp;#123; createApp &amp;#125; from &amp;quot;vue&amp;quot;;import App from &amp;quot;.&amp;#x2F;App.vue&amp;quot;;"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg"><meta property="article:author" content="拾贰"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg"><meta name="description" content="一、入门1.Vue2和Vue3的简单区别 main.js中组件挂载方式不同  123456789101112131415import &amp;#123; createApp &amp;#125; from &amp;quot;vue&amp;quot;;import App from &amp;quot;.&amp;#x2F;App.vue&amp;quot;;"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/11/27/Vue3/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 前端开发爱好者","🔍 分享与热心帮助","🔨 设计开发一条龙","🏃 脚踏实地行动派","🧱 团队小组发动机"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 拾贰","link":"链接: ","source":"来源: 拾贰","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '拾贰',
  title: 'Vue3入门+就业',
  postAI: '',
  pageFillDescription: '一、入门, 1.Vue2和Vue3的简单区别, 二、就业, 1.Vite原理, 2.效率的提升, 静态提升, 预字符串化, 缓存事件处理函数, Block Tree, PatchFlag, 3.API和数据响应式的变化, 去掉了Vue构造函数, 组件实例中的API, 对比数据响应式, 面试题参考答案, 4.模板中的变化, v-model, v-if v-for, key, Fragment, 5.组件的变化, defineAsyncComponent, Teleport, 6.reactivityApi🔺, 获取响应式数据, 监听数据变化, 判断, 转换, 降低心智负担, 7.CompositionApi, setup, 生命周期函数, 面试题参考答案, 8.共享数据, vuex方案, global state, ProvideampInject, 对比, 9.script setup, 10.pinia, 10.1 Pinia基本概念, Pinia 的基本介绍, Pinia 优势, 真题解答, 10.2 Pinia快速入门, 安装 Pinia, 选项式风格, 组合式风格, 真题解答, 10.3 添加插件, 自定义插件, 添加第三方插件, 真题解答, 10.4 最佳实践与补充内容, 最佳实践, 补充内容, 真题解答, 10.5 Pinia部分源码解析, defineStore 方法, storeToRefs 方法一入门和的简单区别中组件挂载方式不同不存在构造函数的组件实例代理代理对象是一个组件实例选项式和组合式选项式代码结构比较乱组合式可以把统一模块的内容放一块实现高内聚模板中直接访问的组件实例会被包裹成一个对象使用访问所有生命周期钩子函数之前调用中是一个对象实例代理中是一个新增修改删除返回的东西会被附着在组件实例里面去补充该函数内只要用到了响应式数据这些响应式数据就会自动被作为依赖一旦被依赖的数据发生变化就会再次调用该函数使用写法来进行组件开发这个开发思维可以学一下学习投递封简历上午参加面试测试新任务的标题新增一个任务生成一个任务对象将其加入到任务列表中任务是否完成二就业原理面试题谈谈你对的理解最好对比说明原理图原理图面试题答案会先打包然后启动开发服务器请求服务器时直接给予打包结果而是直接启动开发服务器请求哪个模块再对该模块进行实时编译由于现代浏览器本身就支持会自动向依赖的发出请求充分利用这一点将开发环境下的模块文件就作为浏览器要执行的文件而不是像那样进行打包合并由于在启动的时候不需要打包也就意味着不需要分析模块的依赖不需要编译因此启动速度非常快当浏览器请求某个模块时再根据需要对模块内容进行编译这种按需动态编译的方式极大的缩减了编译时间项目越复杂模块越多的优势越明显在方面当改动了一个模块后仅需让浏览器重新请求该模块即可不像那样需要把该模块的相关依赖模块全部编译一次效率更高当需要打包到生产环境时使用传统的进行打包因此的主要优势在开发阶段另外由于利用的是因此在代码中不可以使用之所以可以用是因为它会先进行打包打包过后就没有这种浏览器不支持的代码了效率的提升客户端渲染效率比提升了倍渲染效率比提升了倍面试题的效率提升主要表现在哪些方面静态提升下面的静态节点会被提升元素节点没有绑定动态内容的静态节点的静态节点普通标签且不依赖动态属性由于只要数据有变动就会重复触发函数通过静态提升可以避免重复渲染直接使用即可静态属性会被提升重复利用静态属性防止每次渲染重新创建对象预字符串化当编译器遇到大量连续的静态内容会直接将其编译为一个普通字符串节点缓存事件处理函数保证事件处理函数只生成一次在对比新旧树的时候并不知道哪些节点是静态的哪些是动态的因此只能一层一层比较这就浪费了大部分时间在比对静态节点上会在根节点中记录哪个后代节点是动态节点对比的时候直接对比动态节点就行账号密码在对比每一个节点时并不知道这个节点哪些相关信息会发生变化因此只能将所有信息依次比对和数据响应式的变化面试题为什么中去掉了构造函数面试题谈谈你对数据响应式的理解去掉了构造函数在过去如果遇到一个页面有多个应用时往往会遇到一些问题此代码会影响所有的应用此代码会影响所有的应用此代码会影响所有的应用配置配置在中去掉了构造函数转而使用创建应用根组件根组件更多应用的组件实例中的在中组件实例是一个它仅提供了下列成员功能和一样属性方法对比数据响应式和均在相同的生命周期完成数据响应式但做法不一样面试题参考答案面试题为什么中去掉了构造函数的全局构造函数带来了诸多问题调用构造函数的静态方法会对所有应用生效不利于隔离不同应用的构造函数集成了太多功能不利于把这些功能使用普通函数导出能够充分利用优化打包体积没有把组件实例和应用两个概念区分开在中通过创建的对象既是一个应用同时又是一个特殊的组件中把两个概念区别开来通过创建的对象是一个应用它内部提供的方法是针对整个应用的而不再是一个特殊的组件面试题谈谈你对数据响应式的理解不再使用的方式定义完成数据响应式而是使用除了本身效率比更高之外由于不必递归遍历所有属性而是直接得到一个所以在中对数据的访问是动态的当访问某个属性的时候再动态的获取和设置这就极大的提升了在组件初始阶段的效率同时由于可以监控到成员的新增和删除因此在中新增成员删除成员索引访问等均可以触发重新渲染而这些在中是难以做到的补充因为是通过遍历对需要变成响应式的对象添加重新定义来实现的而且这个过程是在生命周期函数之前进行的如果后续在加一个属性则该属性是监听不到的所以该属性会丢失数据响应式所以就提供了这个方法模板中的变化比较让人诟病的一点就是提供了两种双向绑定和在中去掉了修饰符只需要使用进行双向绑定即可为了让更好的针对多个属性进行双向绑定作出了以下修改当对自定义组件使用指令时绑定的属性名由原来的变为事件名由原来的变为简写为简写为去掉了修饰符它原本的功能由的参数替代简写为简写为配置被移除允许自定义修饰符无此功能例子中的优先级现在高于所以每次修改数据都会循环进行判断不能这样写会影响效率中的优先级现在高于当使用进行循环时需要把值放到中而不是它的子元素中当使用分支的时候不再需要指定值因为会自动给予每个分支一个唯一的即便要手工给予值也必须给予每个分支唯一的不能因为要重用分支而给予相同的现在允许组件出现多个根节点组件的变化异步组件异步组件封装得到一个异步页面当在状态时将显示这里的组件得到一个异步组件当在状态时将显示这里的组件出错了响应式获取响应式数据传入返回备注对象代理深度代理对象中的所有成员对象代理只能读取代理对象中的成员不可修改对的访问是响应式的如果给的值是一个对象则会通过函数进行代理如果已经是代理则直接使用代理当读取值时会根据情况决定是否要运行函数应用如果想要让一个对象变为响应式数据可以使用或如果想要让一个对象的所有属性只读使用如果想要让一个非对象数据变为响应式数据使用如果想要根据已知的响应式数据得到一个新的响应式数据使用笔试题下面的代码输出结果是什么读取时才会打印如果不改变依赖值就只会打印一次因为有缓存笔试题按照下面的要求完成函数在这里补全函数这是一个只读的用户对象响应式数据默认为一个空对象这是一个函数传入用户姓名用于修改用户的名称这是一个函数传入用户年龄用户修改用户的年龄笔试题按照下面的要求完成函数在这里补全函数这里是一个只读对象响应式数据默认值为参数值这里是一个函数传入一个新的对象需要把新对象中的属性混合到原始对象中混合操作需要在的时间中防抖监听数据变化该函数会立即执行然后追中函数中用到的响应式数据响应式数据变化后会再次执行通过调用函数会停止监听停止监听等效于的监听单个数据的变化这样写是行不通的因为是一个常量为什么这样行因为这个函数是在里面调用的读取时会调用从而会收集依赖这样是因为是一个对象用时候会收集依赖监听多个数据的变化注意无论是还是当依赖项变化时回调函数的运行都是异步的微队列即依赖性变化完成后才会执行该函数应用除非遇到下面的场景否则均建议选择不希望回调函数一开始就执行数据改变时需要参考旧值需要监控一些回调函数中不会用到的数据也就是函数里面没有使用需要监听的依赖就无法收集依赖笔试题下面的代码输出结果是什么首次同步执行当依赖项变化时回调函数的运行都是异步的微队列即依赖性变化完成后才会执行该函数判断含义判断某个数据是否是由或判断某个数据是否是通过创建的详细判断某个数据是否是通过创建的判断某个数据是否是一个对象转换等同于应用得到一个响应式对象某个属性的格式把一个响应式对象的所有属性转换为格式然后包装到一个中返回应用这样展开写会丢失响应式降低心智负担所有的均以的结果返回以保证函数的返回结果中不包含或直接产生的数据在函数中尽量保证解构展开出来的所有响应式数据均是补充简单点说就是为了数据结构后丢失响应式面试题相比于有哪些优势不同于提供的函数很多是与组件深度绑定的不能脱离组件而存在该函数在组件属性被赋值后立即执行早于所有生命周期钩子函数是一个对象包含了所有的组件属性值是一个对象提供了组件所需的上下文信息对象的成员成员类型说明对象同的对象同的方法同的生命周期函数不再需要代码可直接置于中不再需要代码可直接置于中改改新新新增钩子函数说明钩子函数参数执行时机渲染收集到的每一次依赖时某个依赖变化导致组件重新渲染时跟踪或触发渲染的对象跟踪或触发渲染的属性跟踪或触发渲染的方式面试题参考答案面试题相比于有哪些优势从两个方面回答为了更好的逻辑复用和代码组织更好的类型推导有了配合可以在组件内部进行更加细粒度的控制使得组件中不同的功能高度聚合提升了代码的可维护性对于不同组件的相同功能也能够更好的复用相比于中没有了指向奇怪的所有的变得更加函数式这有利于和类型推断系统比如深度配合知识补充计算属性只有依赖的属性发生变化才会重新调用例如若这时是个对象数组它里面对象的内容发生变化时并不会重新调用若想解决这个问题可以在传过来之前给它包装成一个对象然后把下面的改为即可共享数据方案安装两个重要变动去掉了构造函数而使用创建仓库为了配合新增函数获得仓库对象由于的响应式系统本身可以脱离组件而存在因此可以充分利用这一点轻松制造多个全局响应式数据提供当前登录用户的共享数据直接引入使用即可以下代码仅供参考导入模块创建默认的全局单例响应式数据仅供该模块内部使用对外暴露的数据是只读的不能直接修改也可以进一步使用进行封装从而避免解构或展开后响应式丢失登录退出恢复登录状态在中提供了和配置可以让开发者在高层组件中注入数据然后在后代组件中使用这两个只能在组件中使用除了兼容的配置式注入在中添加了和方法可以在函数中注入和使用数据考虑到有些数据需要在整个应用中使用还在应用实例中加入了方法用于提供整个应用的共享数据在父组件中提供数据在子组件中接收数据因此我们可以利用这一点在整个应用中提供共享数据提供当前登录用户的共享数据以下代码仅供参考的在传入的应用实例中提供数据创建默认的响应式数据登录退出恢复登录状态提供全局数据对外只读如果没有该则提供默认值应用所有继续导入其他共享数据模块提供统一的数据注入接口继续注入其他共享数据对比组件数据共享可否脱离组件调试工具状态树自行决定自行决定量级重轻轻本身并不提供什么功能是一个语法糖这里面的内容相当于都写入了函数中定义的数据和变量会默认返回引入的组件会自行注册用代替且只能在语法糖语法内使用宏函数只在编译时有用运行时会转化成默认的写法用代替也是一样的传统写法中组件实例中的内容等同于组件函数中返回的内容这样有问题组件实例应该自我管理自己的实例成员然后引入了传统写法中也有函数想了解可以看文档补充当前模块路径可以得到完整的图片路径防止打包后路径出错基本概念面试题相比有什么样的优点为什么现在官方推荐使用是一个阵营的新的状态管理库现在官方已经推荐使用来代替或者你可以把看作是的最新的版本的基本介绍优势的基本介绍是一个西班牙语的单词表示菠萝的意思因为菠萝是由一小块一小块组成的这个和的思想就非常的吻合在中每个仓库都是单独的扁平化的存在的是由官方团队中的一个成员开发的最早是在年左右作为一项实验性工作所提出的当时的目的是将组合融入到中探索新版本的应有的形态随着探索的进行最终发现已经实现了大部分的提案因此就作为了最新版本的但是为了尊重作者本人名字保持不变仍然叫做相比的更少而且更简单还支持组合式还可以和一起使用来做类型的推断官网优势在中已经不存在只有在上面的代码中我们创建了一个仓库该仓库中提供三个选项分别是以及里面支持同步和异步来修改相当于将之前中的和合并了同步的修改仓库状态异步的修改仓库状态可以和一起使用以此来获得类型推断的支持这里定义了一个名为的接口指定了是类型指定了是类型关于仓库每一个仓库都是独立的扁平化的存在的不再像里面是通过嵌套支持插件扩展可以通过插件函数来扩展仓库的功能为仓库添加全局属性或者全局方法这里定义了一个名为的插件本质上就是一个函数从中恢复状态监听变化将变化保存到创建实例并注册插件更加轻量压缩之后体积只有左右基本上可以忽略这个库的存在真题解答题目相比有什么样的优点为什么现在官方推荐使用参考答案是由团队成员开发的下一代状态管理仓库相比可以看作是版本具有如下的优势不复存在只有中支持同步和异步方法修改状态与一起使用具有可靠的类型推断支持不再有模块嵌套只有的概念之间可以相互调用支持插件扩展可以非常方便实现本地存储等功能更加轻量压缩后体积只有左右快速入门面试题是否使用过简单谈一下的使用安装首先第一步需要安装可以通过下面的命令进行安装安装完毕后需要在应用中挂载创建实例在目录下面创建仓库目录在该目录下面创建对应的仓库文件注意名字一般是在仓库文件中我们可以通过来创建一个仓库如下仓库文件第二个参数支持两种风格以及创建的时候支持两种风格选项式以及组合式选项式风格该风格基本上和之前的是非常相似的只不过没有了无论是同步的方法还是异步的方法都写在里面仓库文件第二个参数支持两种风格以及针对上面的数据做一个二次计算可以看作是计算属性同步方法异步方法等待秒钟在组件中使用仓库数据时首先引入仓库方法并执行该方法拿到仓库如果是要获取数据为了保持数据的响应式应该使用方法接下来我们可以从仓库中解构数据出来如果是获取方法直接从里面解构出来即可从仓库将方法解构出来另外仓库还提供了两个好用的重置变更组合式风格组合式风格就和中的使用方法是一样的通过或者来定义仓库数据通过普通的方法来操作仓库数据无论是数据还是方法最终需要导出出去通过来做引入其他仓库组合风格创建仓库数据类似于学习打羽毛球玩游戏使用里面的计算属性来做接下来我们再来创建一个该使用的是其他仓库的数据添加新的事项切换事项对应的完成状态删除待办事项对应下标的某一项在一个仓库中可以使用其他仓库的数据两种风格都可以使用具体使用方式请自行查看文档真题解答题目是否使用过简单谈一下的使用参考答案在中核心概念有仓库的核心主要是用于维护仓库的数据用于对数据做二次计算的等同于的的计算值对仓库状态进行操作的方法相比中没有同步方法和异步方法都放在里面同时支持和内部支持两种编码风格分别是选项式编码风格基本就和之前的是相似的组合式编码风格和非常相似使用或者来定义仓库数据使用来做里面的方法直接书写即可最后将数据和方法通过导出添加插件面试题是否给添加过插件具体添加的方式是什么在中我们可以为仓库添加插件通过添加插件能够扩展以下的内容为添加新的属性定义时增加新的选项为增加新的方法包装现有的方法改变甚至取消实现副作用如本地存储仅应用插件于特定自定义插件首先建议插件单独拿一个目录来存放一个插件就是一个方法给所有的仓库添加了一条全局属性给特定的仓库来扩展内容为当前为的仓库来扩展属性重置仓库状态我们首先可以将初始状态深拷贝一份每个插件在扩展内容时会对所有的仓库进行内容扩展如果想要针对某一个仓库进行内容扩展可以通过来指定某一个仓库来扩展内容插件书写完毕后需要通过实例对插件进行一个注册操作引入自定义插件添加第三方插件有一些第三方插件直接通过安装使用即可具体的使用方法一定要参阅文档如持久化存储插件真题解答题目是否给添加过插件具体添加的方式是什么参考答案在中可以非常方便的添加插件一个插件就是一个函数该函数接收一个上下文对象通过对象可以拿到诸如等信息每个插件在扩展内容时会对所有的仓库进行内容扩展如果想要针对某一个仓库进行内容扩展可以通过来指定某一个仓库来扩展内容插件书写完毕后需要通过实例对插件进行一个注册操作另外我们还可以使用一些第三方插件直接通过安装使用即可安装完毕后使用方法和自定义插件是一样的具体的使用方法一定要参阅文档最佳实践与补充内容面试题在目前的应用中使用状态管理库进行状态管理时有哪些最佳实践请列举一至两条最佳实践分离状态逻辑和业务逻辑实际上这个就是我们使用状态管理库的目的我们使用状态管理库就是为了将组件的状态分离出来这样可以方便我们维护也方便组件之间进行状态的共享没有使用状态管理库使用状态管理库之后但是需要注意一点并非所有的应用都需要使用状态管理库这个取决于我们所开发的应用的规模大小如果只是小规模的应用使用状态管理库反而显得更麻烦选择来进行状态管理目前官方已经推荐开发者使用来替代作为状态管理库你可以将看作是相比真的真的真的很轻量大小只有左右基本上可以忽略当然相比之前的还有一些其他的优点另外如果你之前的项目使用的是那么你可以看一下官方的迁移指南避免直接操作的状态虽然我们可以直接操作的状态但是在中我们最好还是避免直接操作里面的状态而是通过对应的来读取来修改计数器待办事项直接操作的状态请填写新增项目与其对应的应该使用和等来处理状态的读取和修改请填写新增项目这样做的好处在于提高了代码的可维护性应该数据的改变始终来自于的方法而不是分散于组件的各个部分使用本身就是使用编写的因此我们在使用的时候能够非常方便的非常自然的使用使用可以更好的提供类型检查和代码提示让我们的代码更加可靠和易于维护官方文档对应将状态划分为多个模块在一个大型应用中如果将所有组件的状态放置在一个状态仓库中那么会显得该状态仓库非常的臃肿因此一般在大型项目中是一定会将状态仓库进行拆分的在早期的中就已经支持将状态仓库按照不同的功能模块进行拆分只不过在时期状态仓库拆分时按照的是嵌套的方式进行代码组织的在中组织状态仓库的形式不再采用像一样的嵌套而是采用的是扁平化的设计每一个状态仓库都是独立的这个其实也是这个名字的来源补充内容辅助函数模块订阅以及插件选项插件真题解答题目在目前的应用中使用状态管理库进行状态管理时有哪些最佳实践请列举一至两条参考答案在使用开发应用时有关组件的状态管理这一块有如下的最佳实践使用专门的状态仓库来管理组件状态以达到状态逻辑和业务逻辑的分离比起目前更推荐使用来管理仓库的状态尽量都集中使用中的方法来操作的状态避免直接操作使用以便得到更好的类型提示根据不同的功能模块来创建对应的独立的状态仓库部分源码解析养成阅读源码的习惯有如下的好处阅读源码可以帮助我们扩宽自己的视野可以看到优秀的程序员是如何书写代码的从而提升我们自己的编码水平知其然知其所以然如果你阅读过源码那么你自然能够知道某一个是如何实现背后的实现原理是什么那么你也就能够自然的避免在使用该时可能会遇到的一些会有一些自己独特的优化心得最后一点就是阅读源码能够冲击大厂大厂在面试的时候不会考察某个如何使用没什么意义因为经常也在变化一般都是考察背后的原理阅读源码时的一些注意事项阅读源码基于你已经使用过了该库或者该框架对里面的已经很熟悉了是一种自发的行为阅读源码一定要耐心不要陷入于细节在阅读源码的时候往往需要你站在一个更高的角度方法回顾方法的使用方法支持两种变成风格一种是另一种是风格风格可以将写到选项里面风格对应的源码如下会是一个布尔值如果是函数为否则为如果进入此说明是该仓库的是函数内部的变量存储仓库如果是风格就将第三个参数如果有赋值给否则就将配置对象赋值给参数为配置对象这个函数就是最终返回给外部的函数外部通过执行这个函数拿到仓库创建一个仓库并且将这个仓库注册到根据不同的风格开始创建仓库如果是风格调用的是如果是风格调用的是方法背后实际上也是在调用内部会创建一个名为的函数将选项转为函数内部的项目然后调用方法将函数作为第二个参数传递过去因此理论上来讲实践上要更加高效一些因为背后也是转为这些是你不阅读源码无法知道的在函数上面还挂了一个存储了该仓库的在向外部返回这个函数方法首先我们还是回顾该方法的用法源码如下针对版本的处理创建了一个空对象遍历仓库对象拿到仓库对象对应的每一项的值如果这个值本身是响应式的将这个值以原本的添加到对象上面整个循环完了之后所有响应式的值被添加到了对象上面向外部返回这个对象',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-04 09:31:35',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">拾贰</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HTML-CSS/" style="font-size: 1.05rem;">HTML+CSS<sup>4</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>4</sup></a><a href="/tags/React/" style="font-size: 1.05rem;">React<sup>2</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem;">TypeScript<sup>1</sup></a><a href="/tags/Uniapp/" style="font-size: 1.05rem;">Uniapp<sup>2</sup></a><a href="/tags/Vue/" style="font-size: 1.05rem;">Vue<sup>2</sup></a><a href="/tags/Vue2/" style="font-size: 1.05rem;">Vue2<sup>2</sup></a><a href="/tags/Vue3/" style="font-size: 1.05rem;">Vue3<sup>1</sup></a><a href="/tags/Webpack/" style="font-size: 1.05rem;">Webpack<sup>2</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/" style="font-size: 1.05rem;">工具库<sup>1</sup></a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 1.05rem;">工程化<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">网络<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B8%A1%E4%B8%80%E5%A4%A7%E5%B8%88%E8%AF%BE%E4%B9%8B%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/" itemprop="url">渡一大师课之技术提升</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Vue3/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Vue3</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Vue3入门+就业</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-11-27T05:23:16.877Z" title="发表于 2024-11-27 13:23:16">2024-11-27</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-12-04T01:31:35.048Z" title="更新于 2024-12-04 09:31:35">2024-12-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为新乡"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>新乡</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/11/27/Vue3/"><header><a class="post-meta-categories" href="/categories/%E6%B8%A1%E4%B8%80%E5%A4%A7%E5%B8%88%E8%AF%BE%E4%B9%8B%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/" itemprop="url">渡一大师课之技术提升</a><a href="/tags/Vue3/" tabindex="-1" itemprop="url">Vue3</a><h1 id="CrawlerTitle" itemprop="name headline">Vue3入门+就业</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">拾贰</span><time itemprop="dateCreated datePublished" datetime="2024-11-27T05:23:16.877Z" title="发表于 2024-11-27 13:23:16">2024-11-27</time><time itemprop="dateCreated datePublished" datetime="2024-12-04T01:31:35.048Z" title="更新于 2024-12-04 09:31:35">2024-12-04</time></header><h1 id="一、入门"><a href="#一、入门" class="headerlink" title="一、入门"></a>一、入门</h1><h2 id="1-Vue2和Vue3的简单区别"><a href="#1-Vue2和Vue3的简单区别" class="headerlink" title="1.Vue2和Vue3的简单区别"></a>1.Vue2和Vue3的简单区别</h2><ul>
<li>main.js中组件挂载方式不同</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//vue2</span></span><br><span class="line"><span class="comment">// const app = new Vue(options)</span></span><br><span class="line"><span class="comment">// Vue.use()</span></span><br><span class="line"><span class="comment">// app.$mount(&quot;#app&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//vue3</span></span><br><span class="line"><span class="comment">// 不存在构造函数Vue</span></span><br><span class="line"><span class="comment">// const app = createApp(App);</span></span><br><span class="line"><span class="comment">// app.mount(&quot;#app&quot;);</span></span><br><span class="line"><span class="comment">// app.use()</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>vue3的组件实例代理</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">    &lt;button @click=&quot;increase&quot;&gt;increase&lt;/button&gt;</span><br><span class="line">  &lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">	data: ()=&gt;&#123;</span><br><span class="line">        count: 0</span><br><span class="line">	&#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        increase() &#123;</span><br><span class="line">            console.log(this); // proxy代理对象，vue2是一个组件实例</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2024/11/27/6746badfc392e.jpg"></p>
<ul>
<li>选项式API和组合式API<ul>
<li>选项式API代码结构比较乱，组合式API可以把统一模块的内容放一块，实现高内聚</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;count:&#123;&#123; countRef &#125;&#125;&lt;/h1&gt; // 模板中直接访问的组件实例</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">    &lt;button @click=&quot;decrease&quot;&gt;decrease&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;increase&quot;&gt;increase&lt;/button&gt;</span><br><span class="line">  &lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; ref &#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">function useCount() &#123;</span><br><span class="line">  let countRef = ref(0); // countRef会被包裹成一个对象，使用.value访问</span><br><span class="line">  const increase = () =&gt; &#123;</span><br><span class="line">    countRef.value++;</span><br><span class="line">  &#125;;</span><br><span class="line">  const decrease = () =&gt; &#123;</span><br><span class="line">    countRef.value--;</span><br><span class="line">  &#125;;</span><br><span class="line">  return &#123;</span><br><span class="line">    countRef,</span><br><span class="line">    increase,</span><br><span class="line">    decrease,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    // console.log(&quot;所有生命周期钩子函数之前调用&quot;);</span><br><span class="line">    // console.log(this); // this -&gt; undefined</span><br><span class="line">    // setup中，count是一个对象</span><br><span class="line">    // 实例代理中，count是一个count.value</span><br><span class="line"></span><br><span class="line">    //1. 新增</span><br><span class="line"></span><br><span class="line">    //2. 修改</span><br><span class="line"></span><br><span class="line">    //3. 删除</span><br><span class="line">    return &#123;</span><br><span class="line">      ...useCount(), // 返回的东西会被附着在组件实例里面去</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>补充</p>
<ul>
<li>watchEffect</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">watchEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">	todoStorage.<span class="title function_">save</span>(todosRef.<span class="property">value</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 该函数内只要用到了响应式数据，这些响应式数据就会自动被作为依赖，一旦被依赖的数据发生变化，就会再次调用该函数</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用hooks写法来进行组件开发（这个开发思维可以学一下）</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">// App.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;section class=&quot;todoapp&quot;&gt;</span><br><span class="line">      &lt;header class=&quot;header&quot;&gt;</span><br><span class="line">        &lt;h1&gt;todos&lt;/h1&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          class=&quot;new-todo&quot;</span><br><span class="line">          autofocus=&quot;&quot;</span><br><span class="line">          autocomplete=&quot;off&quot;</span><br><span class="line">          placeholder=&quot;What needs to be done?&quot;</span><br><span class="line">          v-model=&quot;newTodoRef&quot;</span><br><span class="line">          @keyup.enter=&quot;addTodo&quot;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/header&gt;</span><br><span class="line">      &lt;section class=&quot;main&quot;&gt;</span><br><span class="line">        &lt;input id=&quot;toggle-all&quot; class=&quot;toggle-all&quot; type=&quot;checkbox&quot; /&gt;</span><br><span class="line">        &lt;label for=&quot;toggle-all&quot;&gt;Mark all as complete&lt;/label&gt;</span><br><span class="line">        &lt;ul class=&quot;todo-list&quot;&gt;</span><br><span class="line">          &lt;li class=&quot;todo&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;view&quot;&gt;</span><br><span class="line">              &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot; /&gt;</span><br><span class="line">              &lt;label&gt;学习composition api&lt;/label&gt;</span><br><span class="line">              &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;input class=&quot;edit&quot; type=&quot;text&quot; /&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &lt;li class=&quot;todo&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;view&quot;&gt;</span><br><span class="line">              &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot; /&gt;</span><br><span class="line">              &lt;label&gt;投递50封简历&lt;/label&gt;</span><br><span class="line">              &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;input class=&quot;edit&quot; type=&quot;text&quot; /&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">          &lt;li class=&quot;todo&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;view&quot;&gt;</span><br><span class="line">              &lt;input class=&quot;toggle&quot; type=&quot;checkbox&quot; /&gt;</span><br><span class="line">              &lt;label&gt;上午10:30 参加面试&lt;/label&gt;</span><br><span class="line">              &lt;button class=&quot;destroy&quot;&gt;&lt;/button&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;input class=&quot;edit&quot; type=&quot;text&quot; /&gt;</span><br><span class="line">          &lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">      &lt;/section&gt;</span><br><span class="line">      &lt;footer class=&quot;footer&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;todo-count&quot;&gt;</span><br><span class="line">          &lt;strong&gt;3&lt;/strong&gt;</span><br><span class="line">          &lt;span&gt;items left&lt;/span&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">        &lt;ul class=&quot;filters&quot;&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;#/all&quot; class=&quot;selected&quot;&gt;All&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;#/active&quot; class=&quot;&quot;&gt;Active&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">          &lt;li&gt;&lt;a href=&quot;#/completed&quot; class=&quot;&quot;&gt;Completed&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">        &lt;button class=&quot;clear-completed&quot; style=&quot;display: none&quot;&gt;</span><br><span class="line">          Clear completed</span><br><span class="line">        &lt;/button&gt;</span><br><span class="line">      &lt;/footer&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import useTodoList from &quot;./composition/useTodoList&quot;;</span><br><span class="line">import useNewTodo from &quot;./composition/useNewTodo&quot;;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const &#123; todosRef &#125; = useTodoList();</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      todosRef,</span><br><span class="line">      ...useNewTodo(todosRef),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// useTodoList.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref, watchEffect &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> todoStorage <span class="keyword">from</span> <span class="string">&quot;../util/todoStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useTodoList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> todosRef = <span class="title function_">ref</span>(todoStorage.<span class="title function_">fetch</span>());</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">todosRef</span> = todosRef; <span class="comment">// 测试</span></span><br><span class="line">  <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    todoStorage.<span class="title function_">save</span>(todosRef.<span class="property">value</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    todosRef,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// useNewTodo.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; generateId &#125; <span class="keyword">from</span> <span class="string">&quot;../util/todoStorage&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useNewTodo</span>(<span class="params">todosRef</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> newTodoRef = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>); <span class="comment">// 新任务的标题</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">addTodo</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 新增一个任务</span></span><br><span class="line">    <span class="keyword">const</span> value = newTodoRef.<span class="property">value</span> &amp;&amp; newTodoRef.<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line">    <span class="keyword">if</span> (!value) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 生成一个任务对象，将其加入到任务列表中</span></span><br><span class="line">    <span class="keyword">const</span> todo = &#123;</span><br><span class="line">      <span class="attr">id</span>: <span class="title function_">generateId</span>(),</span><br><span class="line">      <span class="attr">title</span>: value,</span><br><span class="line">      <span class="attr">completed</span>: <span class="literal">false</span>, <span class="comment">// 任务是否完成</span></span><br><span class="line">    &#125;;</span><br><span class="line">    todosRef.<span class="property">value</span>.<span class="title function_">push</span>(todo);</span><br><span class="line">    newTodoRef.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    newTodoRef,</span><br><span class="line">    addTodo,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="二、就业"><a href="#二、就业" class="headerlink" title="二、就业"></a>二、就业</h1><h2 id="1-Vite原理"><a href="#1-Vite原理" class="headerlink" title="1.Vite原理"></a>1.Vite原理</h2><blockquote>
<p>vite: <a target="_blank" rel="noopener" href="https://github.com/vitejs/vite">https://github.com/vitejs/vite</a></p>
<p>面试题：谈谈你对vite的理解，最好对比webpack说明</p>
</blockquote>
<p>webpack 原理图</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929144416.png" alt="image-20200929144416064" style="zoom:50%;" />

<p>vite 原理图</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929144957.png" alt="image-20200929144957808" style="zoom:50%;" />

<blockquote>
<p>面试题答案：</p>
<p>webpack会先打包，然后启动开发服务器，请求服务器时直接给予打包结果。<br>而vite是直接启动开发服务器，请求哪个模块再对该模块进行实时编译。<br>由于现代浏览器本身就支持ES Module，会自动向依赖的Module发出请求。vite充分利用这一点，将开发环境下的模块文件，就作为浏览器要执行的文件，而不是像webpack那样进行打包合并。<br>由于vite在启动的时候不需要打包，也就意味着不需要分析模块的依赖、不需要编译，因此启动速度非常快。当浏览器请求某个模块时，再根据需要对模块内容进行编译。这种按需动态编译的方式，极大的缩减了编译时间，项目越复杂、模块越多，vite的优势越明显。<br>在HMR方面，当改动了一个模块后，仅需让浏览器重新请求该模块即可，不像webpack那样需要把该模块的相关依赖模块全部编译一次，效率更高。<br>当需要打包到生产环境时，vite使用传统的rollup进行打包，因此，vite的主要优势在开发阶段。另外，由于vite利用的是ES Module，因此在代码中不可以使用CommonJS，webpack之所以可以用是因为它会先进行打包，打包过后就没有这种浏览器不支持的代码了。</p>
</blockquote>
<h2 id="2-效率的提升"><a href="#2-效率的提升" class="headerlink" title="2.效率的提升"></a>2.效率的提升</h2><blockquote>
<p>客户端渲染效率比vue2提升了1.3~2倍</p>
<p>SSR渲染效率比vue2提升了2~3倍</p>
</blockquote>
<blockquote>
<p>面试题：vue3的效率提升主要表现在哪些方面？</p>
</blockquote>
<h3 id="静态提升"><a href="#静态提升" class="headerlink" title="静态提升"></a>静态提升</h3><p>下面的静态节点会被提升</p>
<ul>
<li>元素节点</li>
<li>没有绑定动态内容</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue2 的静态节点</span></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">createVNode</span>(<span class="string">&quot;h1&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue3 的静态节点(普通标签，且不依赖动态属性)，由于只要数据有变动就会重复触发render函数，通过静态提升可以避免重复渲染</span></span><br><span class="line"><span class="keyword">const</span> hoisted = <span class="title function_">createVNode</span>(<span class="string">&quot;h1&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;Hello World&quot;</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">// 直接使用 hoisted 即可</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>静态属性会被提升，重复利用静态属性，防止每次渲染，重新创建对象</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123;user.name&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hoisted = &#123; <span class="attr">class</span>: <span class="string">&quot;user&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="title function_">createVNode</span>(<span class="string">&quot;div&quot;</span>, hoisted, user.<span class="property">name</span>)</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="预字符串化"><a href="#预字符串化" class="headerlink" title="预字符串化"></a>预字符串化</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;menu-bar-container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;logo&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>logo<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>menu<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>menu<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>menu<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>menu<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span>&gt;</span>menu<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; user.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当编译器遇到<strong>大量连续</strong>的静态内容，会直接将其编译为一个普通字符串节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _hoisted_2 = <span class="title function_">_createStaticVNode</span>(<span class="string">&quot;&lt;div class=\&quot;logo\&quot;&gt;&lt;h1&gt;logo&lt;/h1&gt;&lt;/div&gt;&lt;ul class=\&quot;nav\&quot;&gt;&lt;li&gt;&lt;a href=\&quot;\&quot;&gt;menu&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\&quot;\&quot;&gt;menu&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\&quot;\&quot;&gt;menu&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\&quot;\&quot;&gt;menu&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\&quot;\&quot;&gt;menu&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929170205.png" alt="image-20200929170205828" style="zoom:50%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929170304.png" alt="image-20200929170304873" style="zoom:50%;" />

<h3 id="缓存事件处理函数"><a href="#缓存事件处理函数" class="headerlink" title="缓存事件处理函数"></a>缓存事件处理函数</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;count++&quot;</span>&gt;</span>plus<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue2</span></span><br><span class="line"><span class="title function_">render</span>(<span class="params">ctx</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">createVNode</span>(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">onClick</span>: <span class="keyword">function</span>(<span class="params">$event</span>)&#123;</span><br><span class="line">      ctx.<span class="property">count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// vue3</span></span><br><span class="line"><span class="title function_">render</span>(<span class="params">ctx, _cache</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">createVNode</span>(<span class="string">&quot;button&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">onClick</span>: cache[<span class="number">0</span>] || (cache[<span class="number">0</span>] = <span class="function">(<span class="params">$event</span>) =&gt;</span> (ctx.<span class="property">count</span>++)) <span class="comment">// 保证事件处理函数只生成一次</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Block-Tree"><a href="#Block-Tree" class="headerlink" title="Block Tree"></a>Block Tree</h3><p>vue2在对比新旧树的时候，并不知道哪些节点是静态的，哪些是动态的，因此只能一层一层比较，这就浪费了大部分时间在比对静态节点上。vue3会在根节点中记录哪个后代节点是动态节点，对比的时候直接对比动态节点就行。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>账号：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;user.loginId&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>密码：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">&quot;user.loginPwd&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929172002.png" alt="image-20200929172002761" style="zoom:50%;" />

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929172555.png" alt="image-20200929172555681" style="zoom:50%;" />

<h3 id="PatchFlag"><a href="#PatchFlag" class="headerlink" title="PatchFlag"></a>PatchFlag</h3><p>vue2在对比每一个节点时，并不知道这个节点哪些相关信息会发生变化，因此只能将所有信息依次比对</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span> <span class="attr">title</span>=<span class="string">&quot;user name&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123;user.name&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20200929172805.png" alt="image-20200929172805674" style="zoom:50%;" />

<h2 id="3-API和数据响应式的变化"><a href="#3-API和数据响应式的变化" class="headerlink" title="3.API和数据响应式的变化"></a>3.API和数据响应式的变化</h2><blockquote>
<p>面试题1：为什么vue3中去掉了vue构造函数？</p>
<p>面试题2：谈谈你对vue3数据响应式的理解</p>
</blockquote>
<h3 id="去掉了Vue构造函数"><a href="#去掉了Vue构造函数" class="headerlink" title="去掉了Vue构造函数"></a>去掉了Vue构造函数</h3><p>在过去，如果遇到一个页面有多个<code>vue</code>应用时，往往会遇到一些问题</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vue2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">use</span>(...); <span class="comment">// 此代码会影响所有的vue应用</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">mixin</span>(...); <span class="comment">// 此代码会影响所有的vue应用</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title class_">Vue</span>.<span class="title function_">component</span>(...); <span class="comment">// 此代码会影响所有的vue应用</span></span></span><br><span class="line"><span class="language-javascript">                </span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 配置</span></span></span><br><span class="line"><span class="language-javascript">  &#125;).$mount(<span class="string">&quot;#app1&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 配置</span></span></span><br><span class="line"><span class="language-javascript">  &#125;).$mount(<span class="string">&quot;#app2&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在<code>vue3</code>中，去掉了<code>Vue</code>构造函数，转而使用<code>createApp</code>创建<code>vue</code>应用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vue3 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">	<span class="title function_">createApp</span>(根组件).<span class="title function_">use</span>(...).<span class="title function_">mixin</span>(...).<span class="title function_">component</span>(...).<span class="title function_">mount</span>(<span class="string">&quot;#app1&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">createApp</span>(根组件).<span class="title function_">mount</span>(<span class="string">&quot;#app2&quot;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>更多vue应用的api：<a target="_blank" rel="noopener" href="https://v3.vuejs.org/api/application-api.html">https://v3.vuejs.org/api/application-api.html</a></p>
</blockquote>
<h3 id="组件实例中的API"><a href="#组件实例中的API" class="headerlink" title="组件实例中的API"></a>组件实例中的API</h3><p>在<code>vue3</code>中，组件实例是一个<code>Proxy</code>，它仅提供了下列成员，功能和<code>vue2</code>一样</p>
<p>属性：<a target="_blank" rel="noopener" href="https://v3.vuejs.org/api/instance-properties.html">https://v3.vuejs.org/api/instance-properties.html</a></p>
<p>方法：<a target="_blank" rel="noopener" href="https://v3.vuejs.org/api/instance-methods.html">https://v3.vuejs.org/api/instance-methods.html</a></p>
<h3 id="对比数据响应式"><a href="#对比数据响应式" class="headerlink" title="对比数据响应式"></a>对比数据响应式</h3><p>vue2和vue3均在相同的生命周期完成数据响应式，但做法不一样</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20201014155433.png" alt="image-20201014155433311" style="zoom:50%;" />

<h3 id="面试题参考答案"><a href="#面试题参考答案" class="headerlink" title="面试题参考答案"></a>面试题参考答案</h3><p>面试题1：为什么vue3中去掉了vue构造函数？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vue2的全局构造函数带来了诸多问题：</span><br><span class="line">1. 调用构造函数的静态方法会对所有vue应用生效，不利于隔离不同应用</span><br><span class="line">2. vue2的构造函数集成了太多功能，不利于tree shaking，vue3把这些功能使用普通函数导出，能够充分利用tree shaking优化打包体积</span><br><span class="line">3. vue2没有把组件实例和vue应用两个概念区分开，在vue2中，通过new Vue创建的对象，既是一个vue应用，同时又是一个特殊的vue组件。vue3中，把两个概念区别开来，通过createApp创建的对象，是一个vue应用，它内部提供的方法是针对整个应用的，而不再是一个特殊的组件。</span><br></pre></td></tr></table></figure>

<p>面试题2：谈谈你对vue3数据响应式的理解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vue3不再使用Object.defineProperty的方式定义完成数据响应式，而是使用Proxy。</span><br><span class="line">除了Proxy本身效率比Object.defineProperty更高之外，由于不必递归遍历所有属性，而是直接得到一个Proxy。所以在vue3中，对数据的访问是动态的，当访问某个属性的时候，再动态的获取和设置，这就极大的提升了在组件初始阶段的效率。</span><br><span class="line">同时，由于Proxy可以监控到成员的新增和删除，因此，在vue3中新增成员、删除成员、索引访问等均可以触发重新渲染，而这些在vue2中是难以做到的。</span><br><span class="line">// 补充</span><br><span class="line">因为vue2是通过遍历对需要变成响应式的对象添加Object.defineProperty重新定义来实现的，而且这个过程是在生命周期函数Created之前进行的，如果后续在加一个属性，则该属性是监听不到的，所以该属性会丢失数据响应式，所以就提供了this.$set这个方法</span><br></pre></td></tr></table></figure>

<h2 id="4-模板中的变化"><a href="#4-模板中的变化" class="headerlink" title="4.模板中的变化"></a>4.模板中的变化</h2><h3 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h3><p><code>vue2</code>比较让人诟病的一点就是提供了两种双向绑定：<code>v-model</code>和<code>.sync</code>，在<code>vue3</code>中，去掉了<code>.sync</code>修饰符，只需要使用<code>v-model</code>进行双向绑定即可。</p>
<p>为了让<code>v-model</code>更好的针对多个属性进行双向绑定，<code>vue3</code>作出了以下修改</p>
<ul>
<li><p>当对自定义组件使用<code>v-model</code>指令时，绑定的属性名由原来的<code>value</code>变为<code>modelValue</code>，事件名由原来的<code>input</code>变为<code>update:modelValue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vue2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:value</span>=<span class="string">&quot;pageTitle&quot;</span> @<span class="attr">input</span>=<span class="string">&quot;pageTitle = $event&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 简写为 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- vue3 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:modelValue</span>=<span class="string">&quot;pageTitle&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">update:modelValue</span>=<span class="string">&quot;pageTitle = $event&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 简写为 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>去掉了<code>.sync</code>修饰符，它原本的功能由<code>v-model</code>的参数替代</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vue2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:title</span>=<span class="string">&quot;pageTitle&quot;</span> @<span class="attr">update:title</span>=<span class="string">&quot;pageTitle = $event&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 简写为 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:title.sync</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- vue3 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">:title</span>=<span class="string">&quot;pageTitle&quot;</span> @<span class="attr">update:title</span>=<span class="string">&quot;pageTitle = $event&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 简写为 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ChildComponent</span> <span class="attr">v-model:title</span>=<span class="string">&quot;pageTitle&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>model</code>配置被移除</p>
</li>
<li><p>允许自定义<code>v-model</code>修饰符</p>
<p>vue2 无此功能</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20201008163022.png" alt="image-20201008163021918" style="zoom:50%;" /></li>
</ul>
<ul>
<li>例子</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- vue3 ChildComponent --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;check-editor&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;check-editor-inner&quot;&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        class=&quot;checkbox&quot;</span><br><span class="line">        :class=&quot;&#123; checked: modelValue &#125;&quot;</span><br><span class="line">        @click=&quot;handleChecked&quot;</span><br><span class="line">      &gt;&lt;/div&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type=&quot;text&quot;</span><br><span class="line">        class=&quot;editor&quot;</span><br><span class="line">        :value=&quot;title&quot;</span><br><span class="line">        @input=&quot;handleTextChange&quot;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">    modelValue: Boolean, // v-model=&quot;pageTitle&quot;</span><br><span class="line">    title: String, // v-model:title=&quot;pageTitle&quot;</span><br><span class="line">    titleModifiers: &#123; // v-model:title.trim=&quot;pageTitle&quot;</span><br><span class="line">      default: () =&gt; (&#123;&#125;),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  setup(props, ctx) &#123;</span><br><span class="line">    const handleChecked = () =&gt; &#123;</span><br><span class="line">      ctx.emit(&quot;update:modelValue&quot;, !props.modelValue);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    const handleTextChange = (e) =&gt; &#123;</span><br><span class="line">      let value = e.target.value;</span><br><span class="line">      if (props.titleModifiers.trim) &#123;</span><br><span class="line">        value = value.trim();</span><br><span class="line">      &#125;</span><br><span class="line">      ctx.emit(&quot;update:title&quot;, value);</span><br><span class="line">    &#125;;</span><br><span class="line">    return &#123;</span><br><span class="line">      handleChecked,</span><br><span class="line">      handleTextChange,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.check-editor &#123;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">&#125;</span><br><span class="line">.check-editor-inner &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">&#125;</span><br><span class="line">.checkbox &#123;</span><br><span class="line">  width: 15px;</span><br><span class="line">  height: 15px;</span><br><span class="line">  border: 1px solid #dcdfe6;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  border-radius: 3px;</span><br><span class="line">  transition: 0.2s;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line">.checkbox:hover,</span><br><span class="line">.checkbox.checked &#123;</span><br><span class="line">  border-color: #409eff;</span><br><span class="line">&#125;</span><br><span class="line">.checkbox.checked::after &#123;</span><br><span class="line">  content: &quot;&quot;;</span><br><span class="line">  border-radius: 2px;</span><br><span class="line">  width: 9px;</span><br><span class="line">  height: 9px;</span><br><span class="line">  background: #409eff;</span><br><span class="line">&#125;</span><br><span class="line">.editor &#123;</span><br><span class="line">  border: none;</span><br><span class="line">  outline: none;</span><br><span class="line">  margin-left: 5px;</span><br><span class="line">  border-bottom: 1px solid #dcdfe6;</span><br><span class="line">  font-size: inherit;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<h3 id="v-if-v-for"><a href="#v-if-v-for" class="headerlink" title="v-if v-for"></a>v-if v-for</h3><ul>
<li>vue2中<code>v-for</code> 的优先级 现在高于 <code>v-if</code>,所以每次修改数据都会循环进行<code>v-if</code>判断，不能这样写，会影响效率</li>
<li>vue3中<code>v-if</code> 的优先级 现在高于 <code>v-for</code></li>
</ul>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><ul>
<li><p>当使用<code>&lt;template&gt;</code>进行<code>v-for</code>循环时，需要把<code>key</code>值放到<code>&lt;template&gt;</code>中，而不是它的子元素中</p>
</li>
<li><p>当使用<code>v-if v-else-if v-else</code>分支的时候，不再需要指定<code>key</code>值，因为<code>vue3</code>会自动给予每个分支一个唯一的<code>key</code></p>
<p>即便要手工给予<code>key</code>值，也必须给予每个分支唯一的<code>key</code>，<strong>不能因为要重用分支而给予相同的 key</strong></p>
</li>
</ul>
<h3 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h3><p><code>vue3</code>现在允许组件出现多个根节点</p>
<h2 id="5-组件的变化"><a href="#5-组件的变化" class="headerlink" title="5.组件的变化"></a>5.组件的变化</h2><h3 id="defineAsyncComponent"><a href="#defineAsyncComponent" class="headerlink" title="defineAsyncComponent"></a>defineAsyncComponent</h3><p>异步组件：<a target="_blank" rel="noopener" href="https://cn.vuejs.org/api/general.html#defineasynccomponent"><a target="_blank" rel="noopener" href="https://cn.vuejs.org/guide/components/async.html">异步组件 | Vue.js</a></a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 封装 --&gt;</span><br><span class="line"><span class="keyword">import</span> &#123; defineAsyncComponent, h &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Error</span> <span class="keyword">from</span> <span class="string">&quot;../components/Error.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Loading</span> <span class="keyword">from</span> <span class="string">&quot;../components/Loading.vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;nprogress/nprogress.css&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NProgress</span> <span class="keyword">from</span> <span class="string">&quot;nprogress&quot;</span>;</span><br><span class="line"><span class="title class_">NProgress</span>.<span class="title function_">configure</span>(&#123;</span><br><span class="line">  <span class="attr">trickleSpeed</span>: <span class="number">50</span>,</span><br><span class="line">  <span class="attr">showSpinner</span>: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">delay</span>(<span class="params">duration</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!duration) &#123;</span><br><span class="line">    duration = <span class="title function_">random</span>(<span class="number">1000</span>, <span class="number">5000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>();</span><br><span class="line">    &#125;, duration);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">random</span>(<span class="params">min, max</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (max - min)) + min;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到一个异步页面</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getAsyncPage</span>(<span class="params">path</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">defineAsyncComponent</span>(&#123;</span><br><span class="line">    <span class="attr">loader</span>: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">      <span class="title class_">NProgress</span>.<span class="title function_">start</span>();</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">delay</span>();</span><br><span class="line">      <span class="keyword">const</span> comp = <span class="keyword">await</span> <span class="keyword">import</span>(path);</span><br><span class="line">      <span class="title class_">NProgress</span>.<span class="title function_">done</span>();</span><br><span class="line">      <span class="keyword">return</span> comp;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">loadingComponent</span>: <span class="title class_">Loading</span>, <span class="comment">// 当promise在pending状态时，将显示这里的组件</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 得到一个异步组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getAsyncComponent</span>(<span class="params">path</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">defineAsyncComponent</span>(&#123;</span><br><span class="line">    <span class="attr">loader</span>: <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">delay</span>();</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.5</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">import</span>(path);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">loadingComponent</span>: <span class="title class_">Loading</span>, <span class="comment">// 当promise在pending状态时，将显示这里的组件</span></span><br><span class="line">    <span class="attr">errorComponent</span>: &#123;</span><br><span class="line">      <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">h</span>(<span class="title class_">Error</span>, <span class="string">&quot;出错了！！！&quot;</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Teleport"><a href="#Teleport" class="headerlink" title="Teleport"></a>Teleport</h3><p><a target="_blank" rel="noopener" href="https://cn.vuejs.org/guide/built-ins/teleport.html#teleport">Teleport | Vue.js</a></p>
<h2 id="6-reactivityApi🔺"><a href="#6-reactivityApi🔺" class="headerlink" title="6.reactivityApi🔺"></a>6.reactivityApi🔺</h2><blockquote>
<p>reactivity api: <a target="_blank" rel="noopener" href="https://v3.vuejs.org/api/reactivity-api%EF%BC%88%E5%93%8D%E5%BA%94%E5%BC%8FAPI%EF%BC%89">https://v3.vuejs.org/api/reactivity-api（响应式API）</a></p>
</blockquote>
<h3 id="获取响应式数据"><a href="#获取响应式数据" class="headerlink" title="获取响应式数据"></a>获取响应式数据</h3><table>
<thead>
<tr>
<th align="left">API</th>
<th>传入</th>
<th>返回</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>reactive</code></td>
<td><code>plain-object</code></td>
<td><code>对象代理</code></td>
<td>深度代理对象中的所有成员</td>
</tr>
<tr>
<td align="left"><code>readonly</code></td>
<td><code>plain-object</code> or <code>proxy</code></td>
<td><code>对象代理</code></td>
<td>只能读取代理对象中的成员，不可修改</td>
</tr>
<tr>
<td align="left"><code>ref</code></td>
<td><code>any</code></td>
<td><code>&#123; value: ... &#125;</code></td>
<td>对value的访问是响应式的<br />如果给value的值是一个对象，<br />则会通过<code>reactive</code>函数进行代理<br />如果已经是代理，则直接使用代理</td>
</tr>
<tr>
<td align="left"><code>computed</code></td>
<td><code>function</code></td>
<td><code>&#123; value: ... &#125;</code></td>
<td>当读取value值时，<br />会<strong>根据情况</strong>决定是否要运行函数</td>
</tr>
</tbody></table>
<p>应用：</p>
<ul>
<li>如果想要让一个对象变为响应式数据，可以使用<code>reactive</code>或<code>ref</code></li>
<li>如果想要让一个对象的所有属性只读，使用<code>readonly</code></li>
<li>如果想要让一个非对象数据变为响应式数据，使用<code>ref</code></li>
<li>如果想要根据已知的响应式数据得到一个新的响应式数据，使用<code>computed</code></li>
</ul>
<p>笔试题1：下面的代码输出结果是什么？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, readonly, ref, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">firstName</span>: <span class="string">&quot;Xu Ming&quot;</span>,</span><br><span class="line">  <span class="attr">lastName</span>: <span class="string">&quot;Deng&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> fullName = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;changed&quot;</span>); <span class="comment">// 读取fullName.value时才会打印，如果不改变依赖值，就只会打印一次，因为有缓存</span></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;state.lastName&#125;</span>, <span class="subst">$&#123;state.firstName&#125;</span>`</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;state ready&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fullname is&quot;</span>, fullName.<span class="property">value</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fullname is&quot;</span>, fullName.<span class="property">value</span>);</span><br><span class="line"><span class="keyword">const</span> imState = <span class="title function_">readonly</span>(state);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(imState === state);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stateRef = <span class="title function_">ref</span>(state);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stateRef.<span class="property">value</span> === state);</span><br><span class="line"></span><br><span class="line">state.<span class="property">firstName</span> = <span class="string">&quot;Cheng&quot;</span>;</span><br><span class="line">state.<span class="property">lastName</span> = <span class="string">&quot;Ji&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(imState.<span class="property">firstName</span>, imState.<span class="property">lastName</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fullname is&quot;</span>, fullName.<span class="property">value</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fullname is&quot;</span>, fullName.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imState2 = <span class="title function_">readonly</span>(stateRef);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(imState2.<span class="property">value</span> === stateRef.<span class="property">value</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>笔试题2：按照下面的要求完成函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useUser</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">// 在这里补全函数</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    user, <span class="comment">// 这是一个只读的用户对象，响应式数据，默认为一个空对象</span></span><br><span class="line">    setUserName, <span class="comment">// 这是一个函数，传入用户姓名，用于修改用户的名称</span></span><br><span class="line">    setUserAge, <span class="comment">// 这是一个函数，传入用户年龄，用户修改用户的年龄</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>笔试题3：按照下面的要求完成函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useDebounce</span>(<span class="params">obj, duration</span>)&#123;</span><br><span class="line">  <span class="comment">// 在这里补全函数</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    value, <span class="comment">// 这里是一个只读对象，响应式数据，默认值为参数值</span></span><br><span class="line">    setValue <span class="comment">// 这里是一个函数，传入一个新的对象，需要把新对象中的属性混合到原始对象中，混合操作需要在duration的时间中防抖</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="监听数据变化"><a href="#监听数据变化" class="headerlink" title="监听数据变化"></a>监听数据变化</h3><p><strong>watchEffect</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stop = <span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 该函数会立即执行，然后追中函数中用到的响应式数据，响应式数据变化后会再次执行</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过调用stop函数，会停止监听</span></span><br><span class="line"><span class="title function_">stop</span>(); <span class="comment">// 停止监听</span></span><br></pre></td></tr></table></figure>

<p><strong>watch</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 等效于vue2的$watch</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听单个数据的变化</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;)</span><br><span class="line"><span class="comment">/* watch(state.count, (newValue, oldValue) =&gt; &#123;</span></span><br><span class="line"><span class="comment">  // ...</span></span><br><span class="line"><span class="comment">&#125;, options) */</span> <span class="comment">// 这样写是行不通的，因为state.count是一个常量0</span></span><br><span class="line"><span class="title function_">watch</span>(<span class="function">() =&gt;</span> state.<span class="property">count</span>, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;, options) <span class="comment">// 为什么这样行，因为这个函数是在watch里面调用的，读取state.count时会调用get，从而会收集依赖</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> countRef = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_">watch</span>(countRef, <span class="function">(<span class="params">newValue, oldValue</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;, options) <span class="comment">// 这样是因为countRef是一个Ref对象,用.value时候会收集依赖</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听多个数据的变化</span></span><br><span class="line"><span class="title function_">watch</span>([<span class="function">() =&gt;</span> state.<span class="property">count</span>, countRef], <span class="function">(<span class="params">[new1, new2], [old1, old2]</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>注意：无论是<code>watchEffect</code>还是<code>watch</code>，当依赖项变化时，回调函数的运行都是异步的（微队列），即依赖性变化完成后，才会执行该函数</strong></p>
<p>应用：除非遇到下面的场景，否则均建议选择<code>watchEffect</code></p>
<ul>
<li>不希望回调函数一开始就执行</li>
<li>数据改变时，需要参考旧值</li>
<li>需要监控一些回调函数中不会用到的数据，也就是函数里面没有使用需要监听的依赖，watchEffect就无法收集依赖</li>
</ul>
<p>笔试题: 下面的代码输出结果是什么？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, watchEffect, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;watchEffect&quot;</span>, state.<span class="property">count</span>); <span class="comment">// 首次同步执行，当依赖项变化时，回调函数的运行都是异步的（微队列），即依赖性变化完成后，才会执行该函数</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">watch</span>(</span><br><span class="line">  <span class="function">() =&gt;</span> state.<span class="property">count</span>,</span><br><span class="line">  <span class="function">(<span class="params">count, oldCount</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;watch&quot;</span>, count, oldCount);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;start&quot;</span>);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;time out&quot;</span>);</span><br><span class="line">  state.<span class="property">count</span>++;</span><br><span class="line">  state.<span class="property">count</span>++;</span><br><span class="line">&#125;);</span><br><span class="line">state.<span class="property">count</span>++;</span><br><span class="line">state.<span class="property">count</span>++;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h3><table>
<thead>
<tr>
<th>API</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>isProxy</code></td>
<td>判断某个数据是否是由<code>reactive</code>或<code>readonly</code></td>
</tr>
<tr>
<td><code>isReactive</code></td>
<td>判断某个数据是否是通过<code>reactive</code>创建的<br />详细:<a target="_blank" rel="noopener" href="https://v3.vuejs.org/api/basic-reactivity.html#isreactive">https://v3.vuejs.org/api/basic-reactivity.html#isreactive</a></td>
</tr>
<tr>
<td><code>isReadonly</code></td>
<td>判断某个数据是否是通过<code>readonly</code>创建的</td>
</tr>
<tr>
<td><code>isRef</code></td>
<td>判断某个数据是否是一个<code>ref</code>对象</td>
</tr>
</tbody></table>
<h3 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h3><p><strong>unref</strong></p>
<p>等同于：<code>isRef(val) ? val.value : val</code></p>
<p>应用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useNewTodo</span>(<span class="params">todos</span>)&#123;</span><br><span class="line">  todos = <span class="title function_">unref</span>(todos);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>toRef</strong></p>
<p>得到一个响应式对象某个属性的ref格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fooRef = <span class="title function_">toRef</span>(state, <span class="string">&#x27;foo&#x27;</span>); <span class="comment">// fooRef: &#123;value: ...&#125;</span></span><br><span class="line"></span><br><span class="line">fooRef.<span class="property">value</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(state.<span class="property">foo</span>) <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">state.<span class="property">foo</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fooRef.<span class="property">value</span>) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p><strong>toRefs</strong></p>
<p>把一个响应式对象的所有属性转换为ref格式，然后包装到一个<code>plain-object</code>中返回</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="number">2</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stateAsRefs = <span class="title function_">toRefs</span>(state)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">stateAsRefs: not a proxy</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  foo: &#123; value: ... &#125;,</span></span><br><span class="line"><span class="comment">  bar: &#123; value: ... &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>应用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> state1 = <span class="title function_">reactive</span>(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>&#125;);</span><br><span class="line">  <span class="keyword">const</span> state2 = <span class="title function_">reactive</span>(&#123;<span class="attr">c</span>:<span class="number">3</span>, <span class="attr">d</span>:<span class="number">4</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...state1, <span class="comment">// lost reactivity</span></span><br><span class="line">    ...state2 <span class="comment">// lost reactivity 这样展开写会丢失响应式</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> state1 = <span class="title function_">reactive</span>(&#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>&#125;);</span><br><span class="line">  <span class="keyword">const</span> state2 = <span class="title function_">reactive</span>(&#123;<span class="attr">c</span>:<span class="number">3</span>, <span class="attr">d</span>:<span class="number">4</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...<span class="title function_">toRefs</span>(state1), <span class="comment">// reactivity</span></span><br><span class="line">    ...<span class="title function_">toRefs</span>(state2) <span class="comment">// reactivity</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// composition function</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">usePos</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> pos = <span class="title function_">reactive</span>(&#123;<span class="attr">x</span>:<span class="number">0</span>, <span class="attr">y</span>:<span class="number">0</span>&#125;);</span><br><span class="line">  <span class="keyword">return</span> pos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;x, y&#125; = <span class="title function_">usePos</span>(); <span class="comment">// lost reactivity</span></span><br><span class="line">  <span class="keyword">const</span> &#123;x, y&#125; = <span class="title function_">toRefs</span>(<span class="title function_">usePos</span>()); <span class="comment">// reactivity</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="降低心智负担"><a href="#降低心智负担" class="headerlink" title="降低心智负担"></a>降低心智负担</h3><p>所有的<code>composition function</code>均以<code>ref</code>的结果返回，以保证<code>setup</code>函数的返回结果中不包含<code>reactive</code>或<code>readonly</code>直接产生的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">usePos</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> pos = <span class="title function_">reactive</span>(&#123; <span class="attr">x</span>:<span class="number">0</span>, <span class="attr">y</span>:<span class="number">0</span> &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">toRefs</span>(pos); <span class="comment">//  &#123;x: refObj, y: refObj&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useBooks</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> books = <span class="title function_">ref</span>([]);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    books <span class="comment">// books is refObj</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useLoginUser</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="title function_">readonly</span>(&#123;</span><br><span class="line">    <span class="attr">isLogin</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">loginId</span>: <span class="literal">null</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">toRefs</span>(user); <span class="comment">// &#123; isLogin: refObj, loginId: refObj &#125;  all ref is readonly</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">// 在setup函数中，尽量保证解构、展开出来的所有响应式数据均是ref</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...<span class="title function_">usePos</span>(),</span><br><span class="line">    ...<span class="title function_">useBooks</span>(),</span><br><span class="line">    ...<span class="title function_">useLoginUser</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**补充:**简单点说toRefs就是为了数据结构后丢失响应式</p>
<h2 id="7-CompositionApi"><a href="#7-CompositionApi" class="headerlink" title="7.CompositionApi"></a>7.CompositionApi</h2><blockquote>
<p>面试题：composition api相比于option api有哪些优势？</p>
</blockquote>
<p>不同于reactivity api，composition api提供的函数很多是与组件深度绑定的，不能脱离组件而存在。</p>
<h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// component</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params">props, context</span>)&#123;</span><br><span class="line">    <span class="comment">// 该函数在组件属性被赋值后立即执行，早于所有生命周期钩子函数</span></span><br><span class="line">    <span class="comment">// props 是一个对象，包含了所有的组件属性值</span></span><br><span class="line">    <span class="comment">// context 是一个对象，提供了组件所需的上下文信息</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>context对象的成员</p>
<table>
<thead>
<tr>
<th>成员</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>attrs</td>
<td>对象</td>
<td>同<code>vue2</code>的<code>this.$attrs</code></td>
</tr>
<tr>
<td>slots</td>
<td>对象</td>
<td>同<code>vue2</code>的<code>this.$slots</code></td>
</tr>
<tr>
<td>emit</td>
<td>方法</td>
<td>同<code>vue2</code>的<code>this.$emit</code></td>
</tr>
</tbody></table>
<h3 id="生命周期函数"><a href="#生命周期函数" class="headerlink" title="生命周期函数"></a>生命周期函数</h3><table>
<thead>
<tr>
<th>vue2 option api</th>
<th>vue3 option api</th>
<th>vue 3 composition api</th>
</tr>
</thead>
<tbody><tr>
<td>beforeCreate</td>
<td>beforeCreate</td>
<td>不再需要，代码可直接置于setup中</td>
</tr>
<tr>
<td>created</td>
<td>created</td>
<td>不再需要，代码可直接置于setup中</td>
</tr>
<tr>
<td>beforeMount</td>
<td>beforeMount</td>
<td>onBeforeMount</td>
</tr>
<tr>
<td>mounted</td>
<td>mounted</td>
<td>onMounted</td>
</tr>
<tr>
<td>beforeUpdate</td>
<td>beforeUpdate</td>
<td>onBeforeUpdate</td>
</tr>
<tr>
<td>updated</td>
<td>updated</td>
<td>onUpdated</td>
</tr>
<tr>
<td>beforeDestroy</td>
<td>&#x3D;&#x3D;改&#x3D;&#x3D; beforeUnmount</td>
<td>onBeforeUnmount</td>
</tr>
<tr>
<td>destroyed</td>
<td>&#x3D;&#x3D;改&#x3D;&#x3D;unmounted</td>
<td>onUnmounted</td>
</tr>
<tr>
<td>errorCaptured</td>
<td>errorCaptured</td>
<td>onErrorCaptured</td>
</tr>
<tr>
<td>-</td>
<td>&#x3D;&#x3D;新&#x3D;&#x3D;renderTracked</td>
<td>onRenderTracked</td>
</tr>
<tr>
<td>-</td>
<td>&#x3D;&#x3D;新&#x3D;&#x3D;renderTriggered</td>
<td>onRenderTriggered</td>
</tr>
</tbody></table>
<p>新增钩子函数说明：</p>
<table>
<thead>
<tr>
<th>钩子函数</th>
<th>参数</th>
<th>执行时机</th>
</tr>
</thead>
<tbody><tr>
<td>renderTracked</td>
<td>DebuggerEvent</td>
<td>渲染vdom收集到的每一次依赖时</td>
</tr>
<tr>
<td>renderTriggered</td>
<td>DebuggerEvent</td>
<td>某个依赖变化导致组件重新渲染时</td>
</tr>
</tbody></table>
<p>DebuggerEvent:</p>
<ul>
<li>target: 跟踪或触发渲染的对象</li>
<li>key: 跟踪或触发渲染的属性</li>
<li>type: 跟踪或触发渲染的方式</li>
</ul>
<h3 id="面试题参考答案-1"><a href="#面试题参考答案-1" class="headerlink" title="面试题参考答案"></a>面试题参考答案</h3><p>面试题：composition api相比于option api有哪些优势？</p>
<blockquote>
<p>从两个方面回答：</p>
<ol>
<li>为了更好的逻辑复用和代码组织</li>
<li>更好的类型推导</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">有了composition api，配合reactivity api，可以在组件内部进行更加细粒度的控制，使得组件中不同的功能高度聚合，提升了代码的可维护性。对于不同组件的相同功能，也能够更好的复用。</span><br><span class="line">相比于option api，composition api中没有了指向奇怪的this，所有的api变得更加函数式，这有利于和类型推断系统比如TS深度配合。</span><br></pre></td></tr></table></figure>

<p><strong>知识补充</strong>：<code>computed</code>计算属性只有依赖的属性发生变化才会重新调用，例如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useGdpBar</span>(<span class="params">maxSize, gdp</span>) &#123;</span><br><span class="line">  <span class="comment">// 若gdp这时是个proxy对象数组，它里面对象的内容发生变化时，computed并不会重新调用</span></span><br><span class="line">  <span class="comment">// 若想解决这个问题可以在gdp传过来之前给它包装成一个ref对象，然后把下面的gdp改为gdp.value即可</span></span><br><span class="line">  <span class="keyword">const</span> bar = <span class="title function_">computed</span>(<span class="function">() =&gt;</span></span><br><span class="line">    gdp.<span class="title function_">map</span>(<span class="function">(<span class="params">it</span>) =&gt;</span> it)</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    bars,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-共享数据"><a href="#8-共享数据" class="headerlink" title="8.共享数据"></a>8.共享数据</h2><h3 id="vuex方案"><a href="#vuex方案" class="headerlink" title="vuex方案"></a>vuex方案</h3><p>安装<code>vuex@4.x</code></p>
<p>两个重要变动：</p>
<ul>
<li>去掉了构造函数<code>Vuex</code>，而使用<code>createStore</code>创建仓库</li>
<li>为了配合<code>composition api</code>，新增<code>useStore</code>函数获得仓库对象</li>
</ul>
<h3 id="global-state"><a href="#global-state" class="headerlink" title="global state"></a>global state</h3><p>由于<code>vue3</code>的响应式系统本身可以脱离组件而存在，因此可以充分利用这一点，轻松制造多个全局响应式数据</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20201026171519.png" alt="image-20201026171519761" style="zoom:50%;" />

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/useLoginUser 提供当前登录用户的共享数据,直接引入使用即可</span></span><br><span class="line"><span class="comment">// 以下代码仅供参考</span></span><br><span class="line"><span class="keyword">import</span> &#123; reactive, readonly &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> userServ <span class="keyword">from</span> <span class="string">&quot;../api/user&quot;</span>; <span class="comment">// 导入api模块</span></span><br><span class="line"><span class="comment">// 创建默认的全局单例响应式数据，仅供该模块内部使用</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">user</span>: <span class="literal">null</span>, <span class="attr">loading</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"><span class="comment">// 对外暴露的数据是只读的，不能直接修改</span></span><br><span class="line"><span class="comment">// 也可以进一步使用toRefs进行封装，从而避免解构或展开后响应式丢失</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> loginUserStore = <span class="title function_">readonly</span>(state);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">loginId, loginPwd</span>) &#123;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="keyword">await</span> userServ.<span class="title function_">login</span>(loginId, loginPwd);</span><br><span class="line">  state.<span class="property">loginUser</span> = user;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 退出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loginOut</span>(<span class="params"></span>) &#123;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">await</span> userServ.<span class="title function_">loginOut</span>();</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">  state.<span class="property">loginUser</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 恢复登录状态</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">whoAmI</span>(<span class="params"></span>) &#123;</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">const</span> user = <span class="keyword">await</span> userServ.<span class="title function_">whoAmI</span>();</span><br><span class="line">  state.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">  state.<span class="property">loginUser</span> = user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Provide-Inject"><a href="#Provide-Inject" class="headerlink" title="Provide&amp;Inject"></a>Provide&amp;Inject</h3><p>在<code>vue2</code>中，提供了<code>provide</code>和<code>inject</code>配置，可以让开发者在高层组件中注入数据，然后在后代组件中使用，这两个api只能在组件中使用</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20201026173949.png" alt="image-20201026173949874" style="zoom: 40%;" />

<p>除了兼容<code>vue2</code>的配置式注入，<code>vue3</code>在<code>composition api</code>中添加了<code>provide</code>和<code>inject</code>方法，可以在<code>setup</code>函数中注入和使用数据</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20201026174039.png" alt="image-20201026174039594" style="zoom:40%;" />

<p>考虑到有些数据需要在整个vue应用中使用，<code>vue3</code>还在应用实例中加入了<code>provide</code>方法，用于提供整个应用的共享数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">creaetApp</span>(<span class="title class_">App</span>)</span><br><span class="line">  .<span class="title function_">provide</span>(<span class="string">&quot;foo&quot;</span>, <span class="title function_">ref</span>(<span class="number">1</span>)) <span class="comment">// key value</span></span><br><span class="line">  .<span class="title function_">provide</span>(<span class="string">&quot;bar&quot;</span>, <span class="title function_">ref</span>(<span class="number">2</span>))</span><br><span class="line">	.<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br><span class="line"><span class="comment">// 在父组件中提供数据</span></span><br><span class="line"><span class="keyword">import</span> &#123; provide &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">   <span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">     <span class="title function_">provide</span>(<span class="string">&#x27;foo&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">   &#125;		</span><br><span class="line"> &#125;    </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"><span class="comment">// 在子组件中接收数据</span></span><br><span class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"> <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">   <span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">     <span class="keyword">const</span> foo = <span class="title function_">inject</span>(<span class="string">&#x27;foo&#x27;</span>)</span><br><span class="line">   &#125;		</span><br><span class="line"> &#125;    </span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20201026174611.png" alt="image-20201026174611477" style="zoom:40%;" />

<p>因此，我们可以利用这一点，在整个vue应用中提供共享数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store/useLoginUser 提供当前登录用户的共享数据</span></span><br><span class="line"><span class="comment">// 以下代码仅供参考</span></span><br><span class="line"><span class="keyword">import</span> &#123; readonly, reactive, inject &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> key = <span class="title class_">Symbol</span>(); <span class="comment">// Provide的key</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在传入的vue应用实例中提供数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">provideStore</span>(<span class="params">app</span>) &#123;</span><br><span class="line">  <span class="comment">// 创建默认的响应式数据</span></span><br><span class="line">  <span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">user</span>: <span class="literal">null</span>, <span class="attr">loading</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">  <span class="comment">// 登录</span></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">loginId, loginPwd</span>) &#123;</span><br><span class="line">    state.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> userServ.<span class="title function_">login</span>(loginId, loginPwd);</span><br><span class="line">    state.<span class="property">loginUser</span> = user;</span><br><span class="line">    state.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 退出</span></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">loginOut</span>(<span class="params"></span>) &#123;</span><br><span class="line">    state.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">await</span> userServ.<span class="title function_">loginOut</span>();</span><br><span class="line">    state.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">    state.<span class="property">loginUser</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 恢复登录状态</span></span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">whoAmI</span>(<span class="params"></span>) &#123;</span><br><span class="line">    state.<span class="property">loading</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> userServ.<span class="title function_">whoAmI</span>();</span><br><span class="line">    state.<span class="property">loading</span> = <span class="literal">false</span>;</span><br><span class="line">    state.<span class="property">loginUser</span> = user;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 提供全局数据</span></span><br><span class="line">  app.<span class="title function_">provide</span>(key, &#123;</span><br><span class="line">    <span class="attr">state</span>: <span class="title function_">readonly</span>(state), <span class="comment">// 对外只读</span></span><br><span class="line">    login,</span><br><span class="line">    loginOut,</span><br><span class="line">    whoAmI,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useStore</span>(<span class="params">defaultValue = <span class="literal">null</span></span>) &#123; <span class="comment">// 如果没有该key则提供默认值</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">inject</span>(key, defaultValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// store/index</span></span><br><span class="line"><span class="comment">// 应用所有store</span></span><br><span class="line"><span class="keyword">import</span> &#123; provideStore <span class="keyword">as</span> provideLoginUserStore &#125; <span class="keyword">from</span> <span class="string">&quot;./useLoginUser&quot;</span>;</span><br><span class="line"><span class="comment">// 继续导入其他共享数据模块...</span></span><br><span class="line"><span class="comment">// import &#123; provideStore as provideNewsStore &#125; from &quot;./useNews&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 提供统一的数据注入接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">provideStore</span>(<span class="params">app</span>) &#123;</span><br><span class="line">  <span class="title function_">provideLoginUserStore</span>(app);</span><br><span class="line">  <span class="comment">// 继续注入其他共享数据</span></span><br><span class="line">  <span class="comment">// provideNewsStore(app);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> provideStore <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>);</span><br><span class="line"><span class="title function_">provideStore</span>(app);</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h3><table>
<thead>
<tr>
<th></th>
<th>vuex</th>
<th>global state</th>
<th>Provide&amp;Inject</th>
</tr>
</thead>
<tbody><tr>
<td>组件数据共享</td>
<td>✅</td>
<td>✅</td>
<td>✅</td>
</tr>
<tr>
<td>可否脱离组件</td>
<td>✅</td>
<td>✅</td>
<td>❌</td>
</tr>
<tr>
<td>调试工具</td>
<td>✅</td>
<td>❌</td>
<td>✅</td>
</tr>
<tr>
<td>状态树</td>
<td>✅</td>
<td>自行决定</td>
<td>自行决定</td>
</tr>
<tr>
<td>量级</td>
<td>重</td>
<td>轻</td>
<td>轻</td>
</tr>
</tbody></table>
<h2 id="9-script-setup"><a href="#9-script-setup" class="headerlink" title="9.script setup"></a>9.script setup</h2><p>本身并不提供什么功能，是一个语法糖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">// 这里面的内容相当于都写入了setup函数中，定义的数据和变量会默认返回，引入的组件会自行注册，用defineProps代替props,且只能在语法糖语法内使用</span><br><span class="line">// defineProps宏函数只在编译时有用，运行时会转化成默认的props写法</span><br><span class="line">// 用defineEmits代替emits也是一样的</span><br><span class="line">// 传统写法中组件实例Ref中的内容等同于组件setup函数中返回的内容，这样有问题，组件实例应该自我管理自己的实例成员。然后引入了defineExpose,传统写法中也有    	  expose函数，想了解可以看文档</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p><strong>补充</strong>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&#x27;./assets/Wallpaper1.jpg&#x27;</span>,<span class="keyword">import</span>.<span class="property">meta</span>.<span class="property">url</span>) <span class="comment">// 当前模块路径，可以得到完整的图片路径，防止打包后路径出错</span></span><br></pre></td></tr></table></figure>

<h2 id="10-pinia"><a href="#10-pinia" class="headerlink" title="10.pinia"></a>10.pinia</h2><h3 id="10-1-Pinia基本概念"><a href="#10-1-Pinia基本概念" class="headerlink" title="10.1 Pinia基本概念"></a>10.1 Pinia基本概念</h3><blockquote>
<p>面试题：Pinia 相比 Vuex 有什么样的优点？为什么现在官方推荐使用 Pinia ？</p>
</blockquote>
<p>Pinia，是一个 Vue 阵营的新的状态管理库，现在 Vue 官方已经推荐使用 Pinia 来代替 Vuex，或者你可以把 Pinia 看作是 Vuex 的最新的版本。</p>
<ul>
<li>Pinia 的基本介绍</li>
<li>Pinia 优势</li>
</ul>
<h4 id="Pinia-的基本介绍"><a href="#Pinia-的基本介绍" class="headerlink" title="Pinia 的基本介绍"></a>Pinia 的基本介绍</h4><p>Pinia 是一个西班牙语的单词，表示“菠萝”的意思。因为菠萝是由一小块一小块组成的，这个和 Pinia 的思想就非常的吻合，在 Pinia 中，每个 Store 仓库都是单独的扁平化的存在的。</p>
<p>Pinia 是由 Vue 官方团队中的一个成员开发的，最早是在 2019 年 11 左右作为一项实验性工作所提出的，当时的目的是将组合 API 融入到 Vuex 中，探索新版本的 Vuex 应有的形态，随着探索的进行，最终发现 Pinia 已经实现了 Vuex5 大部分的提案，因此 Pinia 就作为了最新版本的 Vuex，但是为了尊重作者本人，名字保持不变，仍然叫做 Pinia。</p>
<p>相比 Vuex，Pinia 的 API 更少而且更简单，还支持组合式 API，还可以和 Typescript 一起使用来做类型的推断。</p>
<p>pinia 官网：<a target="_blank" rel="noopener" href="https://pinia.vuejs.org/">https://pinia.vuejs.org/</a></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2023-03-21-093840.png" alt="image-20230321173840739" style="zoom:50%;" />



<h4 id="Pinia-优势"><a href="#Pinia-优势" class="headerlink" title="Pinia 优势"></a>Pinia 优势</h4><ol>
<li>在 Pinia 中，已经不存在 mutations，只有 state、getters、actions</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>,&#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">doubleCount</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在上面的代码中，我们创建了一个仓库，该仓库中提供三个选项，分别是 state、getters 以及 actions。</p>
<ol start="2">
<li>actions 里面支持同步和异步来修改 store，相当于将之前 Vuex 中的 mutation 和 action 合并了</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">// 同步的修改仓库状态</span></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">decrement</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>--</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 异步的修改仓库状态</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">incrementAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>))</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">increment</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">decrementAsync</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>))</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">decrement</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<ol start="3">
<li>可以和 TypeScript 一起使用，以此来获得类型推断的支持</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里定义了一个名为 Todo 的接口</span></span><br><span class="line">interface <span class="title class_">Todo</span> &#123;</span><br><span class="line">  <span class="attr">id</span>: number;</span><br><span class="line">  <span class="attr">text</span>: string;</span><br><span class="line">  <span class="attr">done</span>: boolean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTodoStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;todo&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">todos</span>: [] <span class="keyword">as</span> <span class="title class_">Todo</span>[],</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">completedTodos</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">todos</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">todo</span> =&gt;</span> todo.<span class="property">done</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">// text 指定了是 string 类型</span></span><br><span class="line">    <span class="title function_">addTodoItem</span>(<span class="params">text: string</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> id = state.<span class="property">todos</span>.<span class="property">length</span> + <span class="number">1</span></span><br><span class="line">      <span class="keyword">const</span> newTodo = &#123; id, text, <span class="attr">done</span>: <span class="literal">false</span> &#125;</span><br><span class="line">      state.<span class="property">todos</span>.<span class="title function_">push</span>(newTodo)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// todo 指定了是 Todo 类型</span></span><br><span class="line">    <span class="title function_">toggleTodoItem</span>(<span class="params">todo: Todo</span>) &#123;</span><br><span class="line">      todo.<span class="property">done</span> = !todo.<span class="property">done</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">fetchTodos</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://jsonplaceholder.typicode.com/todos&#x27;</span>)</span><br><span class="line">      <span class="keyword">const</span> todos = <span class="keyword">await</span> response.<span class="title function_">json</span>() <span class="keyword">as</span> <span class="title class_">Todo</span>[]</span><br><span class="line">      state.<span class="property">todos</span> = todos</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<ol start="4">
<li>关于 Store 仓库，每一个 Store 仓库都是独立的扁平化的存在的，不再像 Vuex 里面是通过 modules 嵌套</li>
<li>支持插件扩展，可以通过插件（函数）来扩展仓库的功能，为仓库添加全局属性或者全局方法</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// 这里定义了一个名为 localStoragePlugin 的插件，本质上就是一个函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">localStoragePlugin</span> = (<span class="params">context: PiniaPluginContext</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> key = <span class="string">&#x27;my-app-state&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 从 localStorage 中恢复状态</span></span><br><span class="line">  context.<span class="property">state</span> = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(key) || context.<span class="property">state</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 监听 state 变化，将变化保存到 localStorage</span></span><br><span class="line">  context.<span class="title function_">subscribe</span>(<span class="function">(<span class="params">mutation</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(key, context.<span class="property">state</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 Pinia 实例，并注册 localStoragePlugin 插件</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>()</span><br><span class="line">pinia.<span class="title function_">use</span>(localStoragePlugin)</span><br></pre></td></tr></table></figure>



<ol start="6">
<li>更加轻量，压缩之后体积只有 1kb 左右，基本上可以忽略这个库的存在</li>
</ol>
<h4 id="真题解答"><a href="#真题解答" class="headerlink" title="真题解答"></a>真题解答</h4><blockquote>
<p>题目：Pinia 相比 Vuex 有什么样的优点？为什么现在官方推荐使用 Pinia ？</p>
<p>参考答案：</p>
<p>Pinia 是由 Vue.js 团队成员开发的下一代状态管理仓库，相比 Vuex 3.x&#x2F;4.x，Pinia 可以看作是 Vuex5 版本。</p>
<p>Pinia 具有如下的优势：</p>
<ul>
<li><p>mutations 不复存在。只有 state 、getters 、actions。</p>
</li>
<li><p>actions 中支持同步和异步方法修改 state 状态。</p>
</li>
<li><p>与 TypeScript 一起使用具有可靠的类型推断支持。</p>
</li>
<li><p>不再有模块嵌套，只有 Store 的概念，Store 之间可以相互调用。</p>
</li>
<li><p>支持插件扩展，可以非常方便实现本地存储等功能。</p>
</li>
<li><p>更加轻量，压缩后体积只有 1kb 左右。</p>
</li>
</ul>
</blockquote>
<h3 id="10-2-Pinia快速入门"><a href="#10-2-Pinia快速入门" class="headerlink" title="10.2 Pinia快速入门"></a>10.2 Pinia快速入门</h3><blockquote>
<p>面试题：是否使用过 Pinia？简单谈一下 Pinia 的使用？</p>
</blockquote>
<h4 id="安装-Pinia"><a href="#安装-Pinia" class="headerlink" title="安装 Pinia"></a>安装 Pinia</h4><p>首先第一步，需要安装 Pinia，可以通过下面的命令进行安装：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install pinia</span><br></pre></td></tr></table></figure>

<p>安装完毕后，需要在 Vue 应用中挂载 Pinia</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="comment">// 创建 pinia 实例</span></span><br><span class="line"><span class="keyword">const</span> pinia = <span class="title function_">createPinia</span>();</span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(router).<span class="title function_">use</span>(pinia).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>在 src 目录下面创建仓库目录 store，在该目录下面创建对应的仓库文件，注意名字一般是 useXXXStore</p>
<p>在仓库文件中，我们可以通过 defineStore 来创建一个 pinia 仓库，如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 仓库文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二个参数支持两种风格：options api 以及 composition api</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&quot;counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">num</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>创建的时候支持两种风格，选项式 API 以及组合式 API。</p>
<h4 id="选项式风格"><a href="#选项式风格" class="headerlink" title="选项式风格"></a>选项式风格</h4><p>该风格基本上和之前的 Vuex 是非常相似的，只不过没有 mutation 了，无论是同步的方法还是异步的方法，都写在 actions 里面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 仓库文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二个参数支持两种风格：options api 以及 composition api</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&quot;counter&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">num</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="comment">// 针对上面 state 的数据做一个二次计算</span></span><br><span class="line">    <span class="comment">// 可以看作是计算属性</span></span><br><span class="line">    <span class="attr">doubleCount</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">num</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">// 同步方法</span></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">num</span>++;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">decrement</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">num</span>--;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 异步方法</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">asyncIncrement</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="comment">// 等待 1 秒钟</span></span><br><span class="line">      <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>));</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">increment</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">asyncDecrement</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">await</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="built_in">setTimeout</span>(resolve, <span class="number">1000</span>));</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">decrement</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在组件中使用仓库数据时，首先引入仓库方法，并执行该方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/store/useCounterStore.js&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">useCounterStore</span>(); <span class="comment">// 拿到仓库</span></span><br></pre></td></tr></table></figure>

<p>如果是要获取数据，为了保持数据的响应式，应该使用 storeToRefs 方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; storeToRefs &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="comment">// 接下来我们可以从仓库中解构数据出来</span></span><br><span class="line"><span class="keyword">const</span> &#123; num, doubleCount &#125; = <span class="title function_">storeToRefs</span>(store);</span><br></pre></td></tr></table></figure>

<p>如果是获取方法，直接从 store 里面解构出来即可。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从仓库将方法解构出来</span></span><br><span class="line"><span class="keyword">const</span> &#123; increment, asyncIncrement, asyncDecrement &#125; = store;</span><br></pre></td></tr></table></figure>



<p>另外，仓库还提供了两个好用的 api：</p>
<ul>
<li>store.$reset ：重置 state</li>
<li>store.$patch：变更 state</li>
</ul>
<h4 id="组合式风格"><a href="#组合式风格" class="headerlink" title="组合式风格"></a>组合式风格</h4><p>组合式风格就和 Vue3 中的使用方法是一样的，通过 ref 或者 reactive 来定义仓库数据。</p>
<p>通过普通的方法来操作仓库数据。无论是数据还是方法最终需要导出出去。</p>
<p>通过 computed 来做 getter。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; reactive, computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入其他仓库</span></span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&quot;./useCounterStore.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useListStore = <span class="title function_">defineStore</span>(<span class="string">&quot;list&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> counterStore = <span class="title function_">useCounterStore</span>();</span><br><span class="line">  <span class="comment">// 组合 api 风格</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 创建仓库数据，类似于 state</span></span><br><span class="line">  <span class="keyword">const</span> list = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">items</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&quot;学习 Pinia&quot;</span>,</span><br><span class="line">        <span class="attr">isCompleted</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&quot;打羽毛球&quot;</span>,</span><br><span class="line">        <span class="attr">isCompleted</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">text</span>: <span class="string">&quot;玩游戏&quot;</span>,</span><br><span class="line">        <span class="attr">isCompleted</span>: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">counter</span>: <span class="number">100</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 使用 vue 里面的计算属性来做 getters</span></span><br><span class="line">  <span class="keyword">const</span> doubleCounter = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> list.<span class="property">counter</span> * <span class="number">2</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// 接下来我们再来创建一个 getter，该 getter 使用的是其他仓库的数据</span></span><br><span class="line">  <span class="keyword">const</span> otherCounter = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> counterStore.<span class="property">doubleCount</span> * <span class="number">3</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 添加新的事项</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">addItem</span>(<span class="params">newItem</span>) &#123;</span><br><span class="line">    list.<span class="property">items</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">      <span class="attr">text</span>: newItem,</span><br><span class="line">      <span class="attr">isCompleted</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 切换事项对应的完成状态</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">completeHandle</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    list.<span class="property">items</span>[index].<span class="property">isCompleted</span> = !list.<span class="property">items</span>[index].<span class="property">isCompleted</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除待办事项对应下标的某一项</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">deleteItem</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    list.<span class="property">items</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    list,</span><br><span class="line">    doubleCounter,</span><br><span class="line">    otherCounter,</span><br><span class="line">    addItem,</span><br><span class="line">    completeHandle,</span><br><span class="line">    deleteItem,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在一个仓库中，可以使用其他仓库的 getter 数据。两种风格都可以使用。具体使用方式请自行查看文档。</p>
<h4 id="真题解答-1"><a href="#真题解答-1" class="headerlink" title="真题解答"></a>真题解答</h4><blockquote>
<p>题目：是否使用过 Pinia？简单谈一下 Pinia 的使用？<br>参考答案：</p>
<p>在 Pinia 中，核心概念有</p>
<ul>
<li>state：仓库的核心，主要是用于维护仓库的数据</li>
<li>getters：用于对数据做二次计算的，等同于 store 的 state 的计算值</li>
<li>actions ：对仓库状态进行操作的方法</li>
</ul>
<p>相比 Vuex，Pinia 中没有 mutations，同步方法和异步方法都放在 actions 里面。Pinia 同时支持 Vue2 和 Vue3，内部支持两种编码风格，分别是：</p>
<ul>
<li>选项式 API ：编码风格基本就和之前的 Vuex 是相似的</li>
<li>组合式 API ： 编码风格和 Vue3 非常相似，使用 ref 或者 reactive 来定义仓库数据，使用 computed 来做 getters，actions 里面的方法直接书写即可，最后将数据和方法通过 return 导出。</li>
</ul>
</blockquote>
<h3 id="10-3-添加插件"><a href="#10-3-添加插件" class="headerlink" title="10.3 添加插件"></a>10.3 添加插件</h3><blockquote>
<p>面试题：是否给 Pinia 添加过插件？具体添加的方式是什么？</p>
</blockquote>
<p>在 Pinia 中，我们可以为仓库添加插件，通过添加插件能够扩展以下的内容：</p>
<ul>
<li>为 store 添加新的属性</li>
<li>定义 store 时增加新的选项</li>
<li>为 store 增加新的方法</li>
<li>包装现有的方法</li>
<li>改变甚至取消 action</li>
<li>实现副作用，如<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">本地存储</a></li>
<li><strong>仅</strong>应用插件于特定 store</li>
</ul>
<h4 id="自定义插件"><a href="#自定义插件" class="headerlink" title="自定义插件"></a>自定义插件</h4><p>首先建议插件单独拿一个目录来存放，一个插件就是一个方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPiniaPlugin1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 给所有的仓库添加了一条全局属性</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&quot;the cake is a lie&quot;</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPiniaPlugin2</span>(<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="comment">//   console.log(context);</span></span><br><span class="line">  <span class="keyword">const</span> &#123; store &#125; = context;</span><br><span class="line">  store.<span class="property">test</span> = <span class="string">&quot;this is a test&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 给特定的仓库来扩展内容</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">*</span>&#125; <span class="variable">param0</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPiniaPlugin3</span>(<span class="params">&#123; store &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (store.<span class="property">$id</span> === <span class="string">&quot;counter&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// 为当前 id 为 counter 的仓库来扩展属性</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;my name is pinia&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 重置仓库状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">myPiniaPlugin4</span>(<span class="params">&#123; store &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// 我们首先可以将初始状态深拷贝一份</span></span><br><span class="line">  <span class="keyword">const</span> state = <span class="title function_">deepClone</span>(store.<span class="property">$state</span>);</span><br><span class="line">  store.<span class="property">reset</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    store.$patch(<span class="title function_">deepClone</span>(state));</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每个插件在扩展内容时，会对所有的仓库进行内容扩展，如果想要针对某一个仓库进行内容扩展，可以通过 context.store.$id 来指定某一个仓库来扩展内容。</p>
<p>插件书写完毕后，需要通过 <em>pinia</em> 实例对插件进行一个注册操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入自定义插件</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  myPiniaPlugin1,</span><br><span class="line">  myPiniaPlugin2,</span><br><span class="line">  myPiniaPlugin3,</span><br><span class="line">  myPiniaPlugin4,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;./plugins&quot;</span>;</span><br><span class="line"></span><br><span class="line">pinia.<span class="title function_">use</span>(myPiniaPlugin1);</span><br><span class="line">pinia.<span class="title function_">use</span>(myPiniaPlugin2);</span><br><span class="line">pinia.<span class="title function_">use</span>(myPiniaPlugin3);</span><br><span class="line">pinia.<span class="title function_">use</span>(myPiniaPlugin4);</span><br></pre></td></tr></table></figure>



<h4 id="添加第三方插件"><a href="#添加第三方插件" class="headerlink" title="添加第三方插件"></a>添加第三方插件</h4><p>有一些第三方插件，直接通过 npm 安装使用即可。</p>
<p>具体的使用方法一定要参阅文档。</p>
<p>如：持久化存储插件<code>pinia-plugin-persistedstate</code></p>
<h4 id="真题解答-2"><a href="#真题解答-2" class="headerlink" title="真题解答"></a>真题解答</h4><blockquote>
<p>题目：是否给 Pinia 添加过插件？具体添加的方式是什么？<br>参考答案：</p>
<p>在 Pinia 中可以非常方便的添加插件。一个插件就是一个函数，该函数接收一个 context 上下文对象，通过 context 对象可以拿到诸如 store、app 等信息。</p>
<p>每个插件在扩展内容时，会对所有的仓库进行内容扩展，如果想要针对某一个仓库进行内容扩展，可以通过 context.store.$id 来指定某一个仓库来扩展内容。</p>
<p>插件书写完毕后，需要通过 <em>pinia</em> 实例对插件进行一个注册操作。</p>
<p>另外，我们还可以使用一些第三方插件，直接通过 npm 安装使用即可。安装完毕后，使用方法和自定义插件是一样的，具体的使用方法一定要参阅文档。</p>
</blockquote>
<h3 id="10-4-最佳实践与补充内容"><a href="#10-4-最佳实践与补充内容" class="headerlink" title="10.4 最佳实践与补充内容"></a>10.4 最佳实践与补充内容</h3><blockquote>
<p>面试题：在目前的 Vue 应用中，使用状态管理库进行状态管理时有哪些最佳实践？请列举一至两条</p>
</blockquote>
<h4 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h4><ul>
<li>分离状态逻辑和业务逻辑</li>
</ul>
<p>实际上这个就是我们使用状态管理库的目的，我们使用状态管理库，就是为了将组件的状态分离出来，这样可以方便我们维护，也方便组件之间进行状态的共享。</p>
<p>没有使用状态管理库：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-11-04-023144.png" alt="image-20221104103143856" style="zoom:50%;" />

<p>使用状态管理库之后：</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2022-11-04-023459.png" alt="image-20221104103459131" style="zoom:50%;" />

<p>但是需要注意一点，并非所有的 Vue 应用都需要使用状态管理库，这个取决于我们所开发的应用的规模大小。如果只是小规模的 Vue 应用，使用状态管理库反而显得更麻烦。</p>
<ul>
<li>选择 Pinia 来进行状态管理</li>
</ul>
<p>目前 Vue 官方已经推荐开发者使用 Pinia 来替代 Vuex 作为状态管理库，你可以将 Pinia 看作是 Vuex5.x</p>
<p>相比 Vuex，Pinia 真的真的真的很轻量，大小只有 1kb 左右，基本上可以忽略</p>
<p>当然相比之前的 Vuex，还有一些其他的优点：</p>
<p><a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/introduction.html#comparison-with-vuex">https://pinia.vuejs.org/zh/introduction.html#comparison-with-vuex</a></p>
<p>另外如果你之前的项目使用的是 Vuex，那么你可以看一下官方的迁移指南：</p>
<p><a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/cookbook/migration-vuex.html">https://pinia.vuejs.org/zh/cookbook/migration-vuex.html</a></p>
<ul>
<li>避免直接操作 store 的状态</li>
</ul>
<p>虽然我们可以直接操作 store 的状态，但是在 Pinia 中我们最好还是避免直接操作 store 里面的状态，而是通过对应的 getters 来读取，actions 来修改</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 计数器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;num++&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 待办事项</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addHandle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (newItem.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(list.<span class="property">value</span>.<span class="property">items</span>);</span><br><span class="line">    <span class="comment">// 直接操作 store 的状态</span></span><br><span class="line">    list.<span class="property">value</span>.<span class="property">items</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">      text : newItem.<span class="property">value</span>,</span><br><span class="line">      <span class="attr">isCompleted</span>: <span class="literal">false</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    newItem.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&quot;请填写新增项目&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>与其对应的应该使用 getters 和 actions 等 API 来处理状态的读取和修改</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;increment&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addHandle</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (newItem.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="title function_">addItem</span>(newItem.<span class="property">value</span>);</span><br><span class="line">    newItem.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="string">&quot;请填写新增项目&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样做的好处在于提高了代码的可维护性，应该数据的改变始终来自于 actions 的方法，而不是分散于组件的各个部分。</p>
<ul>
<li>使用 TypeScript</li>
</ul>
<p>Pinia 本身就是使用 typescript 编写的，因此我们在使用 pinia 的时候，能够非常方便的、非常自然的使用 typescript，使用 typescript 可以更好的提供类型检查和代码提示，让我们的代码更加可靠和易于维护。</p>
<p>官方文档对应：<a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/core-concepts/state.html#typescript">https://pinia.vuejs.org/zh/core-concepts/state.html#typescript</a></p>
<ul>
<li>将状态划分为多个模块</li>
</ul>
<p>在一个大型应用中，如果将所有组件的状态放置在一个状态仓库中，那么会显得该状态仓库非常的臃肿。因此一般在大型项目中，是一定会将状态仓库进行拆分的。</p>
<p>在早期的 Vuex 中，就已经支持将状态仓库按照不同的功能模块进行拆分，只不过在 Vuex 时期，状态仓库拆分时按照的是嵌套的方式进行代码组织的。</p>
<p>在 Pinia 中，组织状态仓库的形式不再采用像 Vuex 一样的嵌套，而是采用的是扁平化的设计，每一个状态仓库都是独立的，这个其实也是 Pinia 这个名字的来源。</p>
<h4 id="补充内容"><a href="#补充内容" class="headerlink" title="补充内容"></a>补充内容</h4><ul>
<li>辅助函数 <a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/api/modules/pinia.html#mapstate">模块：pinia | Pinia</a></li>
<li>订阅 state 以及 action <a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/core-concepts/state.html#subscribing-to-the-state">State | Pinia</a></li>
<li>插件选项 <a target="_blank" rel="noopener" href="https://pinia.vuejs.org/zh/core-concepts/plugins.html#adding-new-options">插件 | Pinia</a></li>
</ul>
<h4 id="真题解答-3"><a href="#真题解答-3" class="headerlink" title="真题解答"></a>真题解答</h4><blockquote>
<p>题目：在目前的 Vue 应用中，使用状态管理库进行状态管理时有哪些最佳实践？请列举一至两条</p>
<p>参考答案：</p>
<p>在使用 Vue 开发应用时，有关组件的状态管理这一块，有如下的最佳实践：</p>
<ul>
<li>使用专门的状态仓库来管理组件状态，以达到状态逻辑和业务逻辑的分离</li>
<li>比起 Vuex，目前更推荐使用 Pinia 来管理仓库的状态</li>
<li>尽量都集中使用 actions 中的方法来操作 store 的状态，避免直接操作 store</li>
<li>使用 typescript 以便得到更好的类型提示</li>
<li>根据不同的功能模块来创建对应的独立的状态仓库</li>
</ul>
</blockquote>
<h3 id="10-5-Pinia部分源码解析"><a href="#10-5-Pinia部分源码解析" class="headerlink" title="10.5 Pinia部分源码解析"></a>10.5 Pinia部分源码解析</h3><p>养成阅读源码的习惯，有如下的好处：</p>
<ul>
<li>阅读源码可以帮助我们扩宽自己的视野，可以看到优秀的程序员是如何书写代码的，从而提升我们自己的编码水平</li>
<li>知其然知其所以然。如果你阅读过源码，那么你自然能够知道某一个 API 是如何实现，背后的实现原理是什么，那么你也就能够自然的避免在使用该 API 时可能会遇到的一些 bug，会有一些自己独特的优化心得</li>
<li>最后一点就是阅读源码能够冲击大厂，大厂在面试的时候不会考察某个 API 如何使用，没什么意义，因为 API 经常也在变化，一般都是考察 API 背后的原理</li>
</ul>
<p>阅读源码时的一些注意事项</p>
<ul>
<li>阅读源码基于你已经使用过了该库或者该框架，对里面的 API 已经很熟悉了，是一种自发的行为</li>
<li>阅读源码一定要<strong>耐心</strong></li>
<li>不要<strong>陷入于细节</strong>，在阅读源码的时候往往需要你站在一个更高的角度</li>
</ul>
<h4 id="defineStore-方法"><a href="#defineStore-方法" class="headerlink" title="defineStore 方法"></a>defineStore 方法</h4><p>回顾 defineStore 方法的使用。defineStore 方法支持两种变成风格，一种是 option store，另一种是 setup store</p>
<p>option store 风格：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">double</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>option store 风格可以将 id 写到选项里面：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;counter&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;),</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    <span class="attr">double</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> state.<span class="property">count</span> * <span class="number">2</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>setup store 风格：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = <span class="title function_">defineStore</span>(<span class="string">&#x27;counter&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">ref</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">increment</span>(<span class="params"></span>) &#123;</span><br><span class="line">    count.<span class="property">value</span>++</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; count, increment &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>defineStore 对应的源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">defineStore</span>(<span class="params"></span></span><br><span class="line"><span class="params"><span class="comment">// <span class="doctag">TODO:</span> add proper types from above</span></span></span><br><span class="line"><span class="params">idOrOptions, setup, setupOptions</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> id;</span><br><span class="line">    <span class="keyword">let</span> options;</span><br><span class="line">    <span class="comment">// isSetupStore 会是一个布尔值，如果是 setup 函数，isSetupStore 为 true，否则为 false</span></span><br><span class="line">    <span class="keyword">const</span> isSetupStore = <span class="keyword">typeof</span> setup === <span class="string">&#x27;function&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> idOrOptions === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果进入此 if，说明 idOrOptions 是该仓库的 id</span></span><br><span class="line">        <span class="comment">// id 是 defineStore 函数内部的变量，存储仓库 id</span></span><br><span class="line">        id = idOrOptions;</span><br><span class="line">        <span class="comment">// the option store setup will contain the actual options in this case</span></span><br><span class="line">        <span class="comment">// 如果是 setup 风格，就将第三个参数（如果有）赋值给 options，否则就将配置对象赋值给 options</span></span><br><span class="line">        options = isSetupStore ? setupOptions : setup;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// idOrOptions 参数为配置对象</span></span><br><span class="line">        options = idOrOptions;</span><br><span class="line">        id = idOrOptions.<span class="property">id</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 这个函数就是最终返回给外部的函数</span></span><br><span class="line">    <span class="comment">// 外部通过执行这个函数拿到 store 仓库 </span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">useStore</span>(<span class="params">pinia, hot</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> currentInstance = <span class="title function_">getCurrentInstance</span>();</span><br><span class="line">        pinia =</span><br><span class="line">            <span class="comment">// in test mode, ignore the argument provided as we can always retrieve a</span></span><br><span class="line">            <span class="comment">// pinia instance with getActivePinia()</span></span><br><span class="line">            (pinia) ||</span><br><span class="line">                (currentInstance &amp;&amp; <span class="title function_">inject</span>(piniaSymbol, <span class="literal">null</span>));</span><br><span class="line">        <span class="keyword">if</span> (pinia)</span><br><span class="line">            <span class="title function_">setActivePinia</span>(pinia);</span><br><span class="line">        <span class="keyword">if</span> (!activePinia) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">`[🍍]: getActivePinia was called with no active Pinia. Did you forget to install pinia?\n`</span> +</span><br><span class="line">                <span class="string">`\tconst pinia = createPinia()\n`</span> +</span><br><span class="line">                <span class="string">`\tapp.use(pinia)\n`</span> +</span><br><span class="line">                <span class="string">`This will fail in production.`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        pinia = activePinia;</span><br><span class="line">        <span class="keyword">if</span> (!pinia.<span class="property">_s</span>.<span class="title function_">has</span>(id)) &#123;</span><br><span class="line">            <span class="comment">// creating the store registers it in `pinia._s`</span></span><br><span class="line">            <span class="comment">// 创建一个仓库，并且将这个仓库注册到 pinia._s</span></span><br><span class="line">            <span class="comment">// 根据不同的风格开始创建仓库</span></span><br><span class="line">            <span class="keyword">if</span> (isSetupStore) &#123;</span><br><span class="line">                <span class="comment">// 如果是 setup 风格，调用的是 createSetupStore</span></span><br><span class="line">                <span class="title function_">createSetupStore</span>(id, setup, options, pinia);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 如果是 option 风格，调用的是 createOptionsStore</span></span><br><span class="line">                <span class="comment">// createOptionsStore 方法背后实际上也是在调用 createSetupStore，内部会创建一个名为 setup 的函数</span></span><br><span class="line">                <span class="comment">// 将选项转为 setup 函数内部的项目，然后调用 createSetupStore 方法，将 setup 函数作为第二个参数传递过去</span></span><br><span class="line">                <span class="comment">// 因此理论上来讲，setup 实践上要更加高效一些，因为 option store 背后也是转为 setup，这些是你不阅读源码无法知道的</span></span><br><span class="line">                <span class="title function_">createOptionsStore</span>(id, options, pinia);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* istanbul ignore else */</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// @ts-expect-error: not the right inferred type</span></span><br><span class="line">                useStore.<span class="property">_pinia</span> = pinia;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> store = pinia.<span class="property">_s</span>.<span class="title function_">get</span>(id);</span><br><span class="line">        <span class="keyword">if</span> (hot) &#123;</span><br><span class="line">            <span class="keyword">const</span> hotId = <span class="string">&#x27;__hot:&#x27;</span> + id;</span><br><span class="line">            <span class="keyword">const</span> newStore = isSetupStore</span><br><span class="line">                ? <span class="title function_">createSetupStore</span>(hotId, setup, options, pinia, <span class="literal">true</span>)</span><br><span class="line">                : <span class="title function_">createOptionsStore</span>(hotId, <span class="title function_">assign</span>(&#123;&#125;, options), pinia, <span class="literal">true</span>);</span><br><span class="line">            hot.<span class="title function_">_hotUpdate</span>(newStore);</span><br><span class="line">            <span class="comment">// cleanup the state properties and the store from the cache</span></span><br><span class="line">            <span class="keyword">delete</span> pinia.<span class="property">state</span>.<span class="property">value</span>[hotId];</span><br><span class="line">            pinia.<span class="property">_s</span>.<span class="title function_">delete</span>(hotId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// save stores in instances to access them devtools</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable constant_">IS_CLIENT</span> &amp;&amp;</span><br><span class="line">            currentInstance &amp;&amp;</span><br><span class="line">            currentInstance.<span class="property">proxy</span> &amp;&amp;</span><br><span class="line">            <span class="comment">// avoid adding stores that are just built for hot module replacement</span></span><br><span class="line">            !hot) &#123;</span><br><span class="line">            <span class="keyword">const</span> vm = currentInstance.<span class="property">proxy</span>;</span><br><span class="line">            <span class="keyword">const</span> cache = <span class="string">&#x27;_pStores&#x27;</span> <span class="keyword">in</span> vm ? vm.<span class="property">_pStores</span> : (vm.<span class="property">_pStores</span> = &#123;&#125;);</span><br><span class="line">            cache[id] = store;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// StoreGeneric cannot be casted towards Store</span></span><br><span class="line">        <span class="keyword">return</span> store;</span><br><span class="line">    &#125;</span><br><span class="line">    useStore.<span class="property">$id</span> = id; <span class="comment">// 在 useStore 函数上面还挂了一个 $id，存储了该仓库的 id</span></span><br><span class="line">    <span class="keyword">return</span> useStore; <span class="comment">// 在向外部返回这个函数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="storeToRefs-方法"><a href="#storeToRefs-方法" class="headerlink" title="storeToRefs 方法"></a>storeToRefs 方法</h4><p>首先我们还是回顾该方法的用法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; storeToRefs &#125; from &#x27;pinia&#x27;</span><br><span class="line">const store = useCounterStore()</span><br><span class="line">const &#123; name, doubleCount &#125; = storeToRefs(store)</span><br><span class="line">const &#123; increment &#125; = store</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>源码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">storeToRefs</span>(<span class="params">store</span>) &#123;</span><br><span class="line">    <span class="comment">// See https://github.com/vuejs/pinia/issues/852</span></span><br><span class="line">    <span class="comment">// It&#x27;s easier to just use toRefs() even if it includes more stuff</span></span><br><span class="line">    <span class="comment">// 针对 Vue2 版本的处理</span></span><br><span class="line">    <span class="keyword">if</span> (isVue2) &#123;</span><br><span class="line">        <span class="comment">// @ts-expect-error: toRefs include methods and others</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">toRefs</span>(store);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        store = <span class="title function_">toRaw</span>(store);</span><br><span class="line">        <span class="comment">// 创建了一个空对象</span></span><br><span class="line">        <span class="keyword">const</span> refs = &#123;&#125;;</span><br><span class="line">        <span class="comment">// 遍历仓库对象</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> store) &#123;</span><br><span class="line">            <span class="comment">// 拿到仓库对象对应的每一项的值</span></span><br><span class="line">            <span class="keyword">const</span> value = store[key];</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isRef</span>(value) || <span class="title function_">isReactive</span>(value)) &#123;</span><br><span class="line">                <span class="comment">// @ts-expect-error: the key is state or getter</span></span><br><span class="line">                <span class="comment">// 如果这个值本身是响应式的，将这个值以原本的 key 添加到 refs 对象上面</span></span><br><span class="line">                refs[key] =</span><br><span class="line">                    <span class="comment">// ---</span></span><br><span class="line">                    <span class="title function_">toRef</span>(store, key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 整个 for 循环完了之后，所有响应式的值被添加到了 refs 对象上面</span></span><br><span class="line">        <span class="comment">// 向外部返回这个 refs 对象</span></span><br><span class="line">        <span class="keyword">return</span> refs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">拾贰</div><div class="post-copyright__author_desc">得失从缘,心无增减</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/11/27/Vue3/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/11/27/Vue3/')">Vue3入门+就业</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/11/27/Vue3/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Vue3入门+就业&amp;url=http://example.com/2024/11/27/Vue3/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">拾贰</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Vue3/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Vue3<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/11/18/Vue%E9%A1%B9%E7%9B%AE%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">个人博客后台</div></div></a></div><div class="next-post pull-right"><a href="/2024/12/04/TypeScript%E5%9F%BA%E7%A1%80/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">TypeScript基础</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/zhheo/Sticker-Heo@latest/Sticker-100/滑稽被子.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">拾贰进行项目开发</b>相关的问题和看法，还有<b style="color:#fff">一些其他的知识</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">拾贰</h1><div class="author-info__desc">得失从缘,心无增减</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/tentwo24" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/2104980654" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">一、入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Vue2%E5%92%8CVue3%E7%9A%84%E7%AE%80%E5%8D%95%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.</span> <span class="toc-text">1.Vue2和Vue3的简单区别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%B0%B1%E4%B8%9A"><span class="toc-number">2.</span> <span class="toc-text">二、就业</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Vite%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">1.Vite原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%88%E7%8E%87%E7%9A%84%E6%8F%90%E5%8D%87"><span class="toc-number">2.2.</span> <span class="toc-text">2.效率的提升</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E6%8F%90%E5%8D%87"><span class="toc-number">2.2.1.</span> <span class="toc-text">静态提升</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%96"><span class="toc-number">2.2.2.</span> <span class="toc-text">预字符串化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="toc-number">2.2.3.</span> <span class="toc-text">缓存事件处理函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Block-Tree"><span class="toc-number">2.2.4.</span> <span class="toc-text">Block Tree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PatchFlag"><span class="toc-number">2.2.5.</span> <span class="toc-text">PatchFlag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-API%E5%92%8C%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">2.3.</span> <span class="toc-text">3.API和数据响应式的变化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E6%8E%89%E4%BA%86Vue%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.1.</span> <span class="toc-text">去掉了Vue构造函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%AE%9E%E4%BE%8B%E4%B8%AD%E7%9A%84API"><span class="toc-number">2.3.2.</span> <span class="toc-text">组件实例中的API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="toc-number">2.3.3.</span> <span class="toc-text">对比数据响应式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88"><span class="toc-number">2.3.4.</span> <span class="toc-text">面试题参考答案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%A8%A1%E6%9D%BF%E4%B8%AD%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">2.4.</span> <span class="toc-text">4.模板中的变化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#v-model"><span class="toc-number">2.4.1.</span> <span class="toc-text">v-model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-if-v-for"><span class="toc-number">2.4.2.</span> <span class="toc-text">v-if v-for</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#key"><span class="toc-number">2.4.3.</span> <span class="toc-text">key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fragment"><span class="toc-number">2.4.4.</span> <span class="toc-text">Fragment</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BB%84%E4%BB%B6%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">2.5.</span> <span class="toc-text">5.组件的变化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#defineAsyncComponent"><span class="toc-number">2.5.1.</span> <span class="toc-text">defineAsyncComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Teleport"><span class="toc-number">2.5.2.</span> <span class="toc-text">Teleport</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-reactivityApi%F0%9F%94%BA"><span class="toc-number">2.6.</span> <span class="toc-text">6.reactivityApi🔺</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE"><span class="toc-number">2.6.1.</span> <span class="toc-text">获取响应式数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E6%95%B0%E6%8D%AE%E5%8F%98%E5%8C%96"><span class="toc-number">2.6.2.</span> <span class="toc-text">监听数据变化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD"><span class="toc-number">2.6.3.</span> <span class="toc-text">判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2"><span class="toc-number">2.6.4.</span> <span class="toc-text">转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%8D%E4%BD%8E%E5%BF%83%E6%99%BA%E8%B4%9F%E6%8B%85"><span class="toc-number">2.6.5.</span> <span class="toc-text">降低心智负担</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-CompositionApi"><span class="toc-number">2.7.</span> <span class="toc-text">7.CompositionApi</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#setup"><span class="toc-number">2.7.1.</span> <span class="toc-text">setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">2.7.2.</span> <span class="toc-text">生命周期函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88-1"><span class="toc-number">2.7.3.</span> <span class="toc-text">面试题参考答案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE"><span class="toc-number">2.8.</span> <span class="toc-text">8.共享数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vuex%E6%96%B9%E6%A1%88"><span class="toc-number">2.8.1.</span> <span class="toc-text">vuex方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#global-state"><span class="toc-number">2.8.2.</span> <span class="toc-text">global state</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Provide-Inject"><span class="toc-number">2.8.3.</span> <span class="toc-text">Provide&amp;Inject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">2.8.4.</span> <span class="toc-text">对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-script-setup"><span class="toc-number">2.9.</span> <span class="toc-text">9.script setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-pinia"><span class="toc-number">2.10.</span> <span class="toc-text">10.pinia</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-Pinia%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.10.1.</span> <span class="toc-text">10.1 Pinia基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Pinia-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.10.1.1.</span> <span class="toc-text">Pinia 的基本介绍</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pinia-%E4%BC%98%E5%8A%BF"><span class="toc-number">2.10.1.2.</span> <span class="toc-text">Pinia 优势</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%9F%E9%A2%98%E8%A7%A3%E7%AD%94"><span class="toc-number">2.10.1.3.</span> <span class="toc-text">真题解答</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-Pinia%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">2.10.2.</span> <span class="toc-text">10.2 Pinia快速入门</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Pinia"><span class="toc-number">2.10.2.1.</span> <span class="toc-text">安装 Pinia</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E9%A1%B9%E5%BC%8F%E9%A3%8E%E6%A0%BC"><span class="toc-number">2.10.2.2.</span> <span class="toc-text">选项式风格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%BC%8F%E9%A3%8E%E6%A0%BC"><span class="toc-number">2.10.2.3.</span> <span class="toc-text">组合式风格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%9F%E9%A2%98%E8%A7%A3%E7%AD%94-1"><span class="toc-number">2.10.2.4.</span> <span class="toc-text">真题解答</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-%E6%B7%BB%E5%8A%A0%E6%8F%92%E4%BB%B6"><span class="toc-number">2.10.3.</span> <span class="toc-text">10.3 添加插件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8F%92%E4%BB%B6"><span class="toc-number">2.10.3.1.</span> <span class="toc-text">自定义插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8F%92%E4%BB%B6"><span class="toc-number">2.10.3.2.</span> <span class="toc-text">添加第三方插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%9F%E9%A2%98%E8%A7%A3%E7%AD%94-2"><span class="toc-number">2.10.3.3.</span> <span class="toc-text">真题解答</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%B8%8E%E8%A1%A5%E5%85%85%E5%86%85%E5%AE%B9"><span class="toc-number">2.10.4.</span> <span class="toc-text">10.4 最佳实践与补充内容</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">2.10.4.1.</span> <span class="toc-text">最佳实践</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%E5%86%85%E5%AE%B9"><span class="toc-number">2.10.4.2.</span> <span class="toc-text">补充内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%9F%E9%A2%98%E8%A7%A3%E7%AD%94-3"><span class="toc-number">2.10.4.3.</span> <span class="toc-text">真题解答</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-Pinia%E9%83%A8%E5%88%86%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="toc-number">2.10.5.</span> <span class="toc-text">10.5 Pinia部分源码解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#defineStore-%E6%96%B9%E6%B3%95"><span class="toc-number">2.10.5.1.</span> <span class="toc-text">defineStore 方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#storeToRefs-%E6%96%B9%E6%B3%95"><span class="toc-number">2.10.5.2.</span> <span class="toc-text">storeToRefs 方法</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/17/React/" title="React">React</a><time datetime="2024-12-17T03:10:03.971Z" title="发表于 2024-12-17 11:10:03">2024-12-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/16/%E6%96%B0React/" title="新React">新React</a><time datetime="2024-12-16T06:27:55.246Z" title="发表于 2024-12-16 14:27:55">2024-12-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/04/TypeScript%E5%9F%BA%E7%A1%80/" title="TypeScript基础">TypeScript基础</a><time datetime="2024-12-04T09:17:42.905Z" title="发表于 2024-12-04 17:17:42">2024-12-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/27/Vue3/" title="Vue3入门+就业">Vue3入门+就业</a><time datetime="2024-11-27T05:23:16.877Z" title="发表于 2024-11-27 13:23:16">2024-11-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/18/Vue%E9%A1%B9%E7%9B%AE%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86/" title="个人博客后台">个人博客后台</a><time datetime="2024-11-18T06:37:03.534Z" title="发表于 2024-11-18 14:37:03">2024-11-18</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="拾贰" target="_blank">拾贰</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HTML-CSS/" style="font-size: 0.88rem;">HTML+CSS<sup>4</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>4</sup></a><a href="/tags/React/" style="font-size: 0.88rem;">React<sup>2</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>1</sup></a><a href="/tags/Uniapp/" style="font-size: 0.88rem;">Uniapp<sup>2</sup></a><a href="/tags/Vue/" style="font-size: 0.88rem;">Vue<sup>2</sup></a><a href="/tags/Vue2/" style="font-size: 0.88rem;">Vue2<sup>2</sup></a><a href="/tags/Vue3/" style="font-size: 0.88rem;">Vue3<sup>1</sup></a><a href="/tags/Webpack/" style="font-size: 0.88rem;">Webpack<sup>2</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/" style="font-size: 0.88rem;">工具库<sup>1</sup></a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 0.88rem;">工程化<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">网络<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 拾贰 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>