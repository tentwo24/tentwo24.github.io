<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>JavaScript语言提升(ES6+) | 拾贰</title><meta name="keywords" content="JavaScript"><meta name="author" content="拾贰"><meta name="copyright" content="拾贰"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="JavaScript语言提升(ES6+)"><meta name="application-name" content="JavaScript语言提升(ES6+)"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="JavaScript语言提升(ES6+)"><meta property="og:url" content="http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/index.html"><meta property="og:site_name" content="拾贰"><meta property="og:description" content="一、零碎的改动1.严格模式此为ES5新增语法 参考：https:&amp;#x2F;&amp;#x2F;www.runoob.com&amp;#x2F;js&amp;#x2F;js-strict.html 参考：https:&amp;#x2F;&amp;#x2F;developer.mozilla.org&amp;#x2F;zh-CN&amp;#x2F;docs&amp;#x2F;Web&amp;#x2F;JavaScript&amp;#x2F;Reference&amp;#x2F;Strict_mode 2."><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg"><meta property="article:author" content="拾贰"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg"><meta name="description" content="一、零碎的改动1.严格模式此为ES5新增语法 参考：https:&amp;#x2F;&amp;#x2F;www.runoob.com&amp;#x2F;js&amp;#x2F;js-strict.html 参考：https:&amp;#x2F;&amp;#x2F;developer.mozilla.org&amp;#x2F;zh-CN&amp;#x2F;docs&amp;#x2F;Web&amp;#x2F;JavaScript&amp;#x2F;Reference&amp;#x2F;Strict_mode 2."><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 前端开发爱好者","🔍 分享与热心帮助","🔨 设计开发一条龙","🏃 脚踏实地行动派","🧱 团队小组发动机"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 拾贰","link":"链接: ","source":"来源: 拾贰","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '拾贰',
  title: 'JavaScript语言提升(ES6+)',
  postAI: '',
  pageFillDescription: '一、零碎的改动, 1.严格模式, 2.let 和 const, 3.幂运算, 4.字符串新增API, 5.模板字符串, 二、数组, 1.for-of 循环, 2.新增API, 三、对象, 1.对象成员速写, 2.解构, 3.展开运算符, 4.属性描述符, getter 和 setter, 5.键值对, 6.冻结, 7.相同性判定, 8.Set, 9.Map, 四、函数, 1.箭头函数, 2.剩余参数, 3.参数默认值, 4.类语法, 5.函数API, 五、事件循环, 1.浏览器的进程模型, 何为进程？, 何为线程？, 浏览器有哪些进程和线程？, 2.渲染主线程是如何工作的？, 3.若干解释, 何为异步？, JS为何会阻碍渲染？, 任务有优先级吗？, 六、Promise基础, 1.邓哥的烦恼, 2.Promise规范, 3.Promise API, 4. 邓哥的解决方案, 七、Promise的链式处理, 1.catch方法, 2.链式调用, 3.邓哥的解决方案, 八、Promise的静态方法, 1.邓哥的新问题, 2.Promise的静态方法, 3.邓哥的解决方案, 九、async和await, 1.async, 2.await, 3.邓哥表白的完美解决方案, 十、面试题考点, 1.Promise的基本概念, 2.链式调用规则, 3.Promise的静态方法, 4.async和await, async, await, 5.事件循环, 十一、面试题一零碎的改动严格模式此为新增语法参考参考和建议不再使用定义变量而使用定义变量定义常量使用定义变量变量的值是可修改的使用定义常量报错常量的值不可修改属性可以修改报错常量的值不可修改对于开发的影响均使用实在需要修改变量再改为防止误修改无论是还是它们均解决了长久以来变量定义的问题使用它们定义变量具有以下特点全局定义的变量不再作为属性添加到全局对象中在变量定义之前使用它会报错不可重复定义同名变量使用定义变量时必须初始化变量具有块级作用域在代码块之外不可使用注意在循环中使用定义变量变量所在的作用域是循环体因此在循环外不能使用另外循环会对该变量做特殊处理让每次循环使用的都是一个独立的循环变量这可以解决由来已久的问题过去的问题输出过去的解决办法输出现在的做法输出幂运算字符串新增含义字符串中是否包含某个子串去掉字符串首尾空白字符去掉字符串开始的空白字符去掉字符串末尾的空白字符将字符串中所有的替换为判断字符串是否以开头判断字符串是否以结尾模板字符串提供了一种新的字符串字面量的书写方式即模板字符串写法为字符串内容模板字符串可以轻松的实现换行和拼接姓名年龄等同于姓名年龄和均为姓名年龄在需要换行或拼接时模板字符串远胜于普通字符串通常我们可以使用模板字符串拼接姓名年龄姓名年龄二数组循环提供了一种爽翻天的方式遍历各种数组和伪数组示例过去的方式垃圾的方式结果一样示例的方式为获取到的每一个元素新增作用图示判断是否为一个数组将某个伪数组转换为一个真数组返回将数组的某些项设置为遍历数组传入一个函数每次遍历会运行该函数数组映射传入一个函数映射数组中的每一项数组筛选传入一个函数仅保留满足条件的项数组聚合传入一个函数对数组每一项按照该函数的返回聚合传入一个函数判断数组中是否有至少一个通过该函数测试的项传入一个函数判断数组中是否所有项都能通过该函数的测试传入一个函数找到数组中第一个能通过该函数测试的项判断数组中是否存在判定规则使用的是三对象对象成员速写在某些场景下提供了一种更加简洁的方式书写对象成员示例过去的方式速写示例过去的方式速写解构提供了一种特殊的语法通过该语法可以轻松的从数组或对象中取出想要的部分示例黑龙江哈尔滨取出中的和取出中的哈尔滨示例取出数组每一项的值分别放到变量中仅取出数组下标的值仅取出数组下标的值取出数组前两位的值放到变量和中剩下的值放到一个新数组中示例交换两个变量示例在参数位置对传入的对象进行解构示例箭头函数也可以在参数位置进行解构示例邓哥在遍历时进行解构展开运算符示例对数组的展开相当于示例对对象的展开示例示例邓哥邓哥属性描述符对于对象中的每个成员使用属性描述符来描述它们上面的对象在内部被描述为属性的描述符该属性的描述符是否可以被重新定义该属性是否允许被遍历会影响循环该属性是否允许被修改属性的描述符该属性的描述符是否可以被重新定义该属性是否允许被遍历会影响循环该属性是否允许被修改提供了一系列的针对属性描述符进行操作该方法用于获取一个属性的描述符该属性的描述符是否可以被重新定义该属性是否允许被遍历会影响循环该属性是否允许被修改该方法用于定义某个属性的描述符邓哥将其值进行修改让该属性不能被遍历让该属性无法被重新赋值和属性描述符中有两个特殊的配置分别为和通过它们可以把属性的取值和赋值变为方法调用读取属性时得到的是该方法的返回值设置属性时会把值传入调用该方法输出输出输出键值对获取对象的属性名组成的数组获取对象的值组成的数组获取对象属性名和属性值组成的数组将属性名和属性值的数组转换为对象示例冻结使用可以冻结一个对象该对象的所有属性均不可更改冻结对象不报错代码无效不报错代码无效不报错代码无效不报错代码无效对象没有被冻结有效可以使用来判断一个对象是否被冻结相同性判定方法可以判断两个值是否相同它和的功能基本一致区别在于和相等和不相等和唯一区别新增了结构用于保存唯一值的序列数组去重获取一个不包含重复项的新数组会去掉重复项返回转化为数组新增了结构用于保存键值对的映射它和对象的最大区别在于对象的键只能是字符串而的键可以是任何类型四函数箭头函数所有使用函数表达式的位置均可以替换为箭头函数函数声明函数表达式箭头函数语法完整语法参数列表函数体若有且仅有一个参数参数函数体若函数体有且仅有一条返回语句参数列表返回语句示例箭头函数写法示例箭头函数写法示例箭头函数写法箭头函数有以下特点不能使用调用没有原型即没有属性没有没有有些教程中会说箭头函数的永远指向箭头函数定义位置的因为箭头函数会绑定这个说法没错根本原因是它没有它里面的使用的是外层的这里的指向这里的实际上是函数的不能用箭头函数替代的部分函数表达式原格式箭头函数报错语法错误会把当成一个参数参数名不合法生成器函数原格式箭头函数报错没有这种写法箭头函数的这些特点都足以说明箭头函数特别适用于那些临时需要函数的位置我们将来会在面试指导阶段对指向进行总结剩余参数不建议再使用来获取参数列表它推荐使用剩余参数来收集未知数量的参数为剩余参数注意剩余参数只能声明为最后一个参数参数默认值提供了参数默认值当参数没有传递或传递为时会使用默认值示例对参数使用了默认值示例对参数使用了默认值对参数使用默认值可以用默认值写法代替和三元运算符如练习题答案开发时可以参考使用函数如果不传参数就给一个空对象然后解构赋默认值类语法过去函数有着两种调用方式直接调用作为构造函数调用这种做法无法从定义上明确函数的用途因此推出了一种全新的语法来书写构造函数示例旧的写法静态方法实例方法新的等效写法示例旧方式的继承狗设置继承关系新的方式狗函数含义调用函数绑定为后续以列表的形式提供参数调用函数绑定为以数组的形式提供参数返回一个函数的拷贝新函数的被绑定为起始参数被绑定为上面五个点可以做下练习练习题地址语言提升拾贰码云开源中国语言提升五事件循环浏览器的进程模型何为进程程序运行需要有它自己专属的内存空间可以把这块内存空间简单的理解为进程每个应用至少有一个进程进程之间相互独立即使要通信也需要双方同意何为线程有了进程后就可以运行程序的代码了运行代码的人称之为线程一个进程至少有一个线程所以在进程开启后会自动创建一个线程来运行代码该线程称之为主线程如果程序需要同时执行多块代码主线程就会启动更多的线程来执行代码所以一个进程中可以包含多个线程浏览器有哪些进程和线程浏览器是一个多进程多线程的应用程序浏览器内部工作极其复杂为了避免相互影响为了减少连环崩溃的几率当启动浏览器后它会自动启动多个进程可以在浏览器的任务管理器中查看当前的所有进程其中最主要的进程有浏览器进程主要负责界面显示用户交互子进程管理等浏览器进程内部会启动多个线程处理不同的任务网络进程负责加载网络资源网络进程内部会启动多个线程来处理不同的网络任务渲染进程本节课重点讲解的进程渲染进程启动后会开启一个渲染主线程主线程负责执行代码默认情况下浏览器会为每个标签页开启一个新的渲染进程以保证不同的标签页之间不相互影响将来该默认模式可能会有所改变有兴趣的同学可参见官方说明文档渲染主线程是如何工作的渲染主线程是浏览器中最繁忙的线程需要它处理的任务包括但不限于解析解析计算样式布局处理图层每秒把页面画次执行全局代码执行事件处理函数执行计时器的回调函数思考题为什么渲染进程不适用多个线程来处理这些事情要处理这么多的任务主线程遇到了一个前所未有的难题如何调度任务比如我正在执行一个函数执行到一半的时候用户点击了按钮我该立即去执行点击事件的处理函数吗我正在执行一个函数执行到一半的时候某个计时器到达了时间我该立即去执行它的回调吗浏览器进程通知我用户点击了按钮与此同时某个计时器也到达了时间我应该处理哪一个呢渲染主线程想出了一个绝妙的主意来处理这个问题排队在最开始的时候渲染主线程会进入一个无限循环每一次循环会检查消息队列中是否有任务存在如果有就取出第一个任务执行执行完一个后进入下一次循环如果没有则进入休眠状态其他所有线程包括其他进程的线程可以随时向消息队列添加任务新任务会加到消息队列的末尾在添加新任务时如果主线程是休眠状态则会将其唤醒以继续循环拿取任务这样一来就可以让每个任务有条不紊的持续的进行下去了整个过程被称之为事件循环消息循环标准是事件循环浏览器是消息循环若干解释何为异步代码在执行过程中会遇到一些无法立即处理的任务比如计时完成后需要执行的任务网络通信完成后需要执行的任务用户操作后需要执行的任务如果让渲染主线程等待这些任务的时机达到就会导致主线程长期处于阻塞的状态从而导致浏览器卡死渲染主线程承担着极其重要的工作无论如何都不能阻塞因此浏览器选择异步来解决这个问题使用异步的方式渲染主线程永不阻塞面试题如何理解的异步参考答案是一门单线程的语言这是因为它运行在浏览器的渲染主线程中而渲染主线程只有一个而渲染主线程承担着诸多的工作渲染页面执行都在其中运行如果使用同步的方式就极有可能导致主线程产生阻塞从而导致消息队列中的很多其他任务无法得到执行这样一来一方面会导致繁忙的主线程白白的消耗时间另一方面导致页面无法及时更新给用户造成卡死现象所以浏览器采用异步的方式来避免具体做法是当某些任务发生时比如计时器网络事件监听主线程将任务交给其他线程去处理自身立即结束任务的执行转而执行后续代码当其他线程完成时将事先传递的回调函数包装成任务加入到消息队列的末尾排队等待主线程调度执行在这种异步模式下浏览器永不阻塞从而最大限度的保证了单线程的流畅运行为何会阻碍渲染先看代码死循环指定的时间袁老师很帅会产生一个任务进入消息队列等死循环完成后再执行该任务三秒后文本才会发生改变点击按钮后会发生什么呢见具体演示语言提升事件循环演示拾贰码云开源中国语言提升事件循环演示任务有优先级吗任务没有优先级在消息队列中先进先出但消息队列是有优先级的根据的最新解释每个任务都有一个任务类型同一个类型的任务必须在一个队列不同类型的任务可以分属于不同的队列在一次事件循环中浏览器可以根据实际情况从不同的队列中取出任务执行浏览器必须准备好一个微队列微队列中的任务优先所有其他任务执行随着浏览器的复杂度急剧提升不再使用宏队列的说法之前是宏任务和微任务在目前的实现中至少包含了下面的队列延时队列用于存放计时器到达后的回调任务优先级中交互队列用于存放用户操作后产生的事件处理任务优先级高微队列用户存放需要最快执行的任务优先级最高添加任务到微队列的主要方式主要是使用例如立即把一个函数添加到微队列函数浏览器还有很多其他的队列由于和我们开发关系不大不作考虑面试题阐述一下的事件循环参考答案事件循环又叫做消息循环是浏览器渲染主线程的工作方式在的源码中它开启一个不会结束的循环每次循环从消息队列中取出第一个任务执行而其他线程只需要在合适的时候将任务加入到队列末尾即可过去把消息队列简单分为宏队列和微队列这种说法目前已无法满足复杂的浏览器环境取而代之的是一种更加灵活多变的处理方式根据官方的解释每个任务有不同的类型同类型的任务必须在同一个队列不同的任务可以属于不同的队列不同任务队列有不同的优先级在一次事件循环中由浏览器自行决定取哪一个队列的任务一般先取交互队列的因为不希望出现点击某个按钮不能立即响应的问题但浏览器必须有一个微队列微队列的任务一定具有最高的优先级必须优先调度执行面试题中的计时器能做到精确计时吗为什么参考答案不行因为计算机硬件没有原子钟无法做到精确计时操作系统的计时函数本身就有少量偏差由于的计时器最终调用的是操作系统的函数也就携带了这些偏差按照的标准浏览器实现计时器时如果嵌套层级超过层则会带有毫秒的最少时间这样在计时时间少于毫秒时又带来了偏差受事件循环的影响计时器的回调函数只能在主线程空闲时运行因此又带来了偏差事件循环相关题目语言提升事件循环拾贰码云开源中国语言提升事件循环注意单线程是异步产生的原因事件循环是异步的实现方式六基础本节课的任务理解规范的基本概念学会创建学会针对进行后续处理邓哥的烦恼邓哥心中有很多女神他今天下定决心要向这些女神表白他认为只要女神够多根据概率学原理总有一个会接收他稳妥起见邓哥决定使用串行的方式进行表白先给第位女神发送短信然后等待女神的回应如果成功了就结束如果失败了则再给第位女神发送短信依次类推邓哥的女神一共有位名字分别是李建国王富贵周聚财刘人勇发短信是一个重复性的劳动邓哥是个程序员因此决定用函数封装这个动作向某位女生发送一则表白短信女神的姓名成功后的回调失败后的回调模拟发送表白短信邓哥最近有谣言说我喜欢你我要澄清一下那不是谣言等待回复模拟女神回复需要一段时间模拟有的几率成功成功调用并传递女神的回复邓哥我是九你是三除了你还是你失败调用并传递女神的回复邓哥你是个好人有了这个函数后邓哥于是开始编写程序发送短信了首先向李建国发送消息李建国如果成功了输出回复的消息后结束如果失败了输出回复的消息后向王富贵发送消息王富贵如果成功了输出回复的消息后结束如果失败了输出回复的消息后向周聚财发送消息周聚财如果成功了输出回复的消息后结束如果失败了输出回复的消息后向刘人勇发送消息刘人勇如果成功了输出回复的消息后结束如果失败了就彻底没戏了邓哥命犯天煞孤星注定孤独终老该程序完成后邓哥内心是崩溃的这一层一层的回调嵌套形成了传说中的回调地狱邓哥是个完美主义者怎么能忍受这样的代码呢要解决这样的问题需要出马规范是一套专门处理异步场景的规范它能有效的避免回调地狱的产生使异步代码更加清晰简洁统一这套规范最早诞生于前端社区规范名称为该规范出现后立即得到了很多开发者的响应规定所有的异步场景都可以看作是一个异步任务每个异步任务在中应该表现为一个对象该对象称之为对象也叫做任务对象每个任务对象都应该有两个阶段三个状态根据常理它们之间存在以下逻辑任务总是从未决阶段变到已决阶段无法逆行任务总是从挂起状态变到完成或失败状态无法逆行时间不能倒流历史不可改写任务一旦完成或失败状态就固定下来永远无法改变挂起完成称之为挂起失败称之为任务完成时可能有一个相关数据任务失败时可能有一个失败原因可以针对任务进行后续处理针对完成状态的后续处理称之为针对失败的后续处理称之为提供了一套实现了规范基本使用如下创建一个任务对象该任务立即进入状态创建的回调立即执行任务的具体执行流程该函数会立即被执行调用可将任务变为状态为需要传递的相关数据调用可将任务变为状态为需要传递的失败原因初始状态为挂起函数当任务完成后会自动运行该函数为任务完成的相关数据函数当任务失败后会自动运行该函数为任务失败的相关原因邓哥的解决方案学习了的后邓哥决定对函数进行改造改造结果如下向某位女生发送一则表白短信女神的姓名该函数返回一个任务对象模拟发送表白短信邓哥最近有谣言说我喜欢你我要澄清一下那不是谣言等待回复模拟女神回复需要一段时间模拟有的几率成功成功调用并传递女神的回复邓哥我是九你是三除了你还是你失败调用并传递女神的回复邓哥你是个好人之后就可以使用该函数来发送消息了李建国女神答应了输出女神的回复女神拒绝了输出女神的回复至此回调地狱的问题仍然没能解决要解决回调地狱还需要进一步学习的知识七的链式处理方法链式调用方法必定会返回一个新的可理解为后续处理也是一个任务学习考试会返回一个新的新任务的状态取决于后续处理若没有相关的后续处理新任务的状态和前任务一致数据为前任务的数据学习考试是的后续处理因为没有对进行失败处理所以也是失败状态且原因一样是对调用和方法后返回的结果当一个被或方法处理后返回的仍然是一个新的对象在这个例子中由于被拒绝方法被执行但是方法中没有显式地返回一个值所以默认返回这就导致是一个对象其状态取决于的执行结果而由于没有显式返回值最终结果为注意在这里袁老师说的是也是失败态也就是而豆包说这里应该是豆包解释上述结论如下一关于新任务的状态和前任务一致当提到新任务的状态和前任务一致时这里的新任务通常指的是基于前一个任务比如一个进行进一步操作后产生的新的异步操作或任务以为例如果前一个处于已决状态成功态或拒绝态而新任务没有对这个已决状态进行明确的处理例如通过等方法那么新任务的状态在一定程度上会反映前任务的状态比如前任务是拒绝状态新任务没有处理拒绝的逻辑那么新任务可能也会被认为处于一种不稳定或类似拒绝的状态尽管严格来说新任务的实际状态可能是待定但在行为表现上与前任务的拒绝状态有相似之处因为没有进行恰当的处理来改变其状态走向二关于数据为前任务的数据如果前任务已经有了确定的结果数据当新任务的状态与前任务状态相关联且没有进行额外的数据处理时新任务所涉及的数据可能会继承或与前任务的数据有紧密联系例如在的链式调用中如果前一个被拒绝并带有一个特定的错误信息新任务没有对这个错误进行处理那么在某些情况下如果新任务最终被观察到其结果时可能会发现它似乎携带了与前任务相同的错误信息或者在行为表现上受到前任务数据的影响总之这句话强调了在异步操作的链条中如果不进行适当的处理新的操作或任务会在状态和数据方面受到前一个任务的强烈影响提醒开发者在进行异步编程时要注意对每个任务的状态和结果数据进行恰当的处理和管理以确保程序的正确性和稳定性若有后续处理但还未执行新任务挂起学习考试打印若后续处理执行了则根据后续处理的情况确定新任务的状态后续处理执行无错新任务的状态为完成数据为后续处理的返回值后续处理执行有错新任务的状态为失败数据为异常对象后续执行后返回的是一个任务对象新任务的状态和数据与该任务对象一致第二点第一点和第二点思维一致错误的状态是是对的后续处理如果里面成功处理没有报错则处理成功是成功态否则是失败态第三点的状态和返回的任务对象状态一致由于链式任务的存在异步代码拥有了更强的表达力常见任务处理代码任务成功后执行处理失败则执行处理处理处理处理处理任务成功后依次执行处理处理处理处理任务成功后依次执行处理处理若任务失败或前面的处理有错执行处理处理处理处理邓哥的解决方案向某位女生发送一则表白短信女神的姓名成功后的回调失败后的回调模拟发送表白短信邓哥最近有谣言说我喜欢你我要澄清一下那不是谣言等待回复模拟女神回复需要一段时间模拟有的几率成功成功调用并传递女神的回复邓哥我是九你是三除了你还是你失败调用并传递女神的回复邓哥你是个好人李建国失败继续王富贵失败继续周聚财失败继续刘人勇成功结束邓哥终于找到了自己的伴侣最后一个也失败了邓哥命犯天煞孤星无伴终老孤独一生八的静态方法邓哥的新问题邓嫂出门时给邓哥交待了几个任务做饭可交给电饭煲完成洗衣服可交给洗衣机完成打扫卫生可交给扫地机器人完成邓哥需要在所有任务结束后给邓嫂汇报工作哪些成功了哪些失败了为了最大程度的节约时间邓哥希望这些任务同时进行最终汇总结果统一处理每个任务可以看做是一个返回的函数做饭邓哥打开了电饭煲饭已做饭却忘了加水米饭变成了爆米花洗衣服邓哥打开了洗衣机衣服已经洗好洗衣服时停水了洗了个寂寞打扫卫生邓哥打开了扫地机器人地板扫的非常干净扫地机器人被哈士奇一爪掀翻了如何利用这三个函数实现邓哥的要求呢的静态方法方法名含义直接返回一个完成状态的任务直接返回一个拒绝状态的任务任务数组返回一个任务任务数组全部成功则成功任何一个失败则失败返回第一个失败结果和全部成功结果任务数组返回一个任务任务数组任一成功则成功任务全部失败则失败返回第一个成功结果和全部失败结果任务数组返回一个任务任务数组全部已决则成功该任务不会失败返回全部结果任务数组返回一个任务任务数组任一已决则已决状态和其一致返回第一个完成的结果补充将一个数组中的子数组全部展开变成一个数组邓哥的解决方案处理汇总结果九和有了异步任务就有了一种统一的处理方式有了统一的处理方式官方就可以对其进一步优化推出了两个关键字和用于更加优雅的表达关键字用于修饰函数被它修饰的函数一定返回如果函数内部显式地返回一个对象那么这个对象会直接被返回如果函数内部返回一个非值如一个数值字符串对象等会自动将这个值包装在一个的对象中并返回是语法糖被它修饰的函数一定返回如在这里执行原本函数内部的逻辑假设原本函数内部只是简单地返回一个值如果有异步操作可以在异步操作完成后调用或例如假设原本函数内部返回一个则返回一样内容可以理解为没写该函数的返回值是完成后的数据若返回的是则得到的状态和其一致可以理解为没写若执行过程报错则任务是个人扩展不理解的地方可以看成大致可以看成此时已被调用为什么二者输出不一样呢一当你使用来调用这个函数时被赋值为一个对象虽然函数内部返回的已经是状态但在外部看来这个对象的状态还处于未决状态这是因为异步操作的结果在被外部获取之前外部并不知道这个已经被原因在于的异步执行机制当异步函数被调用时它的执行不会阻塞后续代码的执行所以在外部代码执行到查看的状态时实际上异步函数内部的虽然已经确定了结果但外部代码还没有机会去消费这个结果因此表现为状态如果直接打印会输出原因如下打印操作是同步进行的当执行打印语句时异步函数已经开始执行但还没有完成将内部的的结果传递给外部仅仅打印函数调用的结果实际上是打印了对象本身而在这个时候由于外部还没有接收到的值所以只能看到对象的初始状态描述即二在这个版本中异步函数直接返回一个值会自动将这个值包装在一个的对象中并返回关键字表示等待某个完成它必须用于函数中只会阻塞所在的异步函数不会阻塞整个程序的执行如果有其他不相关的代码在其他地方执行或者在另一个异步函数中它们不会被这个阻塞如果后面的表达式不是一个对象引擎会尝试将其转换为一个已兑现的对象其值为该表达式的值表达式后面的代码都是在中执行也就是放入微队列上面的函数等同于也可以等待其他数据等同于如果需要针对失败的任务进行处理可以使用语法这句代码将抛出异常成功失败输出失败邓哥表白的完美解决方案邓哥的女神可不是只有位而是位为了更加方便的编写表白代码邓哥决定把这位女神放到一个数组中然后利用和轻松完成代码女神的名字数组梁平邱杰王超冯秀兰赖军顾强戴敏吕涛冯静蔡明廖磊冯洋韩杰江涛文艳杜秀英丁艳邓静江刚乔刚史平康娜袁磊龙秀英姚静潘娜萧磊邵勇李芳谭芳夏秀英程娜武杰崔军廖勇崔强康秀英余磊邵勇贺涛向某位女生发送一则表白短信女神的姓名模拟发送表白短信邓哥最近有谣言说我喜欢你我要澄清一下那不是谣言等待回复模拟女神回复需要一段时间模拟有的几率成功成功调用并传递女神的回复邓哥我是九你是三除了你还是你失败调用并传递女神的回复邓哥你是个好人批量表白的程序等这个函数调用完成再进行下一步表白成功表白成功退出循环表白失败邓哥注定孤独一生十面试题考点的基本概念链式调用规则方法必定会返回一个新的可理解为后续处理也是一个任务新任务的状态取决于后续处理若没有相关的后续处理新任务的状态和前任务一致数据为前任务的数据若有后续处理但还未执行新任务挂起若后续处理执行了则根据后续处理的情况确定新任务的状态后续处理执行无错新任务的状态为完成数据为后续处理的返回值后续处理执行有错新任务的状态为失败数据为异常对象后续执行后返回的是一个任务对象新任务的状态和数据与该任务对象一致的静态方法方法名含义直接返回一个完成状态的任务直接返回一个拒绝状态的任务任务数组返回一个任务任务数组全部成功则成功任何一个失败则失败任务数组返回一个任务任务数组任一成功则成功任务全部失败则失败任务数组返回一个任务任务数组全部已决则成功该任务不会失败任务数组返回一个任务任务数组任一已决则已决状态和其一致和有了异步任务就有了一种统一的处理方式有了统一的处理方式官方就可以对其进一步优化推出了两个关键字和用于更加优雅的表达关键字用于修饰函数被它修饰的函数一定返回该函数的返回值是完成后的数据若返回的是则得到的状态和其一致若执行过程报错则任务是关键字表示等待某个完成它必须用于函数中上面的函数等同于也可以等待其他数据等同于如果需要针对失败的任务进行处理可以使用语法这句代码将抛出异常成功失败输出失败事件循环根据目前所学进入事件队列的函数有以下几种的回调宏任务的回调宏任务的函数回调微任务的回调宏任务事件处理函数宏任务十一面试题下面代码的输出结果是什么任务进入微队列下面代码的输出结果是什么定时器进入宏队列调用后才进入微队列下面代码的输出结果是什么下面代码的输出结果是什么放入微队列上面等价于下面代码的输出结果是什么因为函数还没运行完因为将赋值也就是方法放入了微队列要等代码执行完再执行微队列里的任务完成后这句代码才会放入微队列下面代码的输出结果是什么放入微队列下面代码的输出结果是什么如果里面传的不是函数可以看作没写直接删掉严格来说如果不是函数可以理解为该方法返回的是原来的单独看不是一个函数而是一个对象的创建表达式函数下面代码的输出结果是什么下面代码的输出结果是什么里的进入微队列',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-23 13:45:33',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">拾贰</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HTML-CSS/" style="font-size: 1.05rem;">HTML+CSS<sup>4</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>4</sup></a><a href="/tags/React/" style="font-size: 1.05rem;">React<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem;">TypeScript<sup>1</sup></a><a href="/tags/Uniapp/" style="font-size: 1.05rem;">Uniapp<sup>2</sup></a><a href="/tags/Vue/" style="font-size: 1.05rem;">Vue<sup>2</sup></a><a href="/tags/Vue2/" style="font-size: 1.05rem;">Vue2<sup>2</sup></a><a href="/tags/Vue3/" style="font-size: 1.05rem;">Vue3<sup>1</sup></a><a href="/tags/Webpack/" style="font-size: 1.05rem;">Webpack<sup>2</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/" style="font-size: 1.05rem;">工具库<sup>1</sup></a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 1.05rem;">工程化<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">网络<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B8%A1%E4%B8%80%E5%A4%A7%E5%B8%88%E8%AF%BE%E4%B9%8B%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/" itemprop="url">渡一大师课之技术提升</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/JavaScript/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>JavaScript</span></a></span></div></div><h1 class="post-title" itemprop="name headline">JavaScript语言提升(ES6+)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-10-08T01:35:13.852Z" title="发表于 2024-10-08 09:35:13">2024-10-08</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-10-23T05:45:33.389Z" title="更新于 2024-10-23 13:45:33">2024-10-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为新乡"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>新乡</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/"><header><a class="post-meta-categories" href="/categories/%E6%B8%A1%E4%B8%80%E5%A4%A7%E5%B8%88%E8%AF%BE%E4%B9%8B%E6%8A%80%E6%9C%AF%E6%8F%90%E5%8D%87/" itemprop="url">渡一大师课之技术提升</a><a href="/tags/JavaScript/" tabindex="-1" itemprop="url">JavaScript</a><h1 id="CrawlerTitle" itemprop="name headline">JavaScript语言提升(ES6+)</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">拾贰</span><time itemprop="dateCreated datePublished" datetime="2024-10-08T01:35:13.852Z" title="发表于 2024-10-08 09:35:13">2024-10-08</time><time itemprop="dateCreated datePublished" datetime="2024-10-23T05:45:33.389Z" title="更新于 2024-10-23 13:45:33">2024-10-23</time></header><h2 id="一、零碎的改动"><a href="#一、零碎的改动" class="headerlink" title="一、零碎的改动"></a>一、零碎的改动</h2><h3 id="1-严格模式"><a href="#1-严格模式" class="headerlink" title="1.严格模式"></a>1.严格模式</h3><p>此为ES5新增语法</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.runoob.com/js/js-strict.html">https://www.runoob.com/js/js-strict.html</a></p>
<p>参考：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode</a></p>
<h3 id="2-let-和-const"><a href="#2-let-和-const" class="headerlink" title="2.let 和 const"></a>2.let 和 const</h3><p>ES6建议不再使用<code>var</code>定义变量，而使用<code>let</code>定义变量，<code>const</code>定义常量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>; <span class="comment">// 使用 let 定义变量</span></span><br><span class="line">a = <span class="number">2</span>; <span class="comment">// 变量的值是可修改的</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = <span class="number">1</span>; <span class="comment">// 使用 const 定义常量</span></span><br><span class="line">b = <span class="number">2</span>; <span class="comment">// ❌ 报错，常量的值不可修改</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;;</span><br><span class="line">obj.<span class="property">a</span> = <span class="number">3</span>; <span class="comment">// 属性可以修改</span></span><br><span class="line">obj = &#123;&#125;; <span class="comment">// ❌ 报错，常量的值不可修改</span></span><br></pre></td></tr></table></figure>

<p><strong>对于开发的影响：均使用const，实在需要修改变量，再改为let，防止误修改</strong></p>
<p>无论是let还是const，它们均解决了长久以来变量定义的问题，使用它们定义变量，具有以下特点：</p>
<ul>
<li><p>全局定义的变量不再作为属性添加到全局对象中</p>
</li>
<li><p>在变量定义之前使用它会报错</p>
</li>
<li><p>不可重复定义同名变量</p>
</li>
<li><p>使用<code>const</code>定义变量时，必须初始化</p>
</li>
<li><p>变量具有块级作用域，在代码块之外不可使用</p>
<p>注意，在for循环中使用let定义变量，变量所在的作用域是循环体，因此在循环外不能使用。另外，for循环会对该变量做特殊处理，让每次循环使用的都是一个独立的循环变量，这可以解决JS由来已久的问题。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 过去的问题</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出：3 3 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 过去的解决办法：IIFE</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params">i</span>)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;)(i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出：0 1 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 现在的做法</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">  &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出：0 1 2</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-幂运算"><a href="#3-幂运算" class="headerlink" title="3.幂运算"></a>3.幂运算</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> ** <span class="number">3</span>  <span class="comment">// 8</span></span><br><span class="line"><span class="number">2</span> ** <span class="number">4</span>  <span class="comment">// 16</span></span><br></pre></td></tr></table></figure>

<h3 id="4-字符串新增API"><a href="#4-字符串新增API" class="headerlink" title="4.字符串新增API"></a>4.字符串新增API</h3><table>
<thead>
<tr>
<th>API</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/includes">String.prototype.includes(s)</a></td>
<td>字符串中是否包含某个子串</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/trim">String.prototype.trim()</a></td>
<td>去掉字符串首尾空白字符</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/trimstart">String.prototype.trimStart()</a></td>
<td>去掉字符串开始的空白字符</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/trimend">String.prototype.trimEnd()</a></td>
<td>去掉字符串末尾的空白字符</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replaceall">String.prototype.replaceAll(s, t)</a></td>
<td>将字符串中<strong>所有</strong>的s替换为t</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/startswith">String.prototype.startsWith(s)</a></td>
<td>判断字符串是否以s开头</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/endswith">String.prototype.endsWith(s)</a></td>
<td>判断字符串是否以s结尾</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="5-模板字符串"><a href="#5-模板字符串" class="headerlink" title="5.模板字符串"></a>5.模板字符串</h3><p>ES6提供了一种新的字符串字面量的书写方式，即模板字符串，写法为</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`字符串内容`</span></span><br></pre></td></tr></table></figure>

<p>模板字符串可以轻松的实现换行和拼接</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>, <span class="attr">age</span>: <span class="number">17</span> &#125;</span><br><span class="line"><span class="keyword">const</span> s1 = <span class="string">`姓名：<span class="subst">$&#123;user.name&#125;</span>，年龄：<span class="subst">$&#123;user.age&#125;</span></span></span><br><span class="line"><span class="string">my name is <span class="subst">$&#123;user.name&#125;</span>`</span>;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">const</span> s2 = <span class="string">&#x27;姓名：&#x27;</span> + user.<span class="property">name</span> + <span class="string">&#x27;，年龄：&#x27;</span> + user.<span class="property">age</span> + <span class="string">&#x27;\nmy name is &#x27;</span> + user.<span class="property">name</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * s1和s2均为：</span></span><br><span class="line"><span class="comment"> * 姓名：monica，年龄：17</span></span><br><span class="line"><span class="comment"> * my name is monica</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p>在需要换行或拼接时，模板字符串远胜于普通字符串</p>
<p>通常，我们可以使用模板字符串拼接html</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>, <span class="attr">age</span>: <span class="number">17</span> &#125;</span><br><span class="line"><span class="keyword">const</span> html = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;div&gt;</span></span><br><span class="line"><span class="string">	&lt;p&gt;&lt;span class=&quot;k&quot;&gt;姓名&lt;/span&gt;&lt;span class=&quot;v&quot;&gt;<span class="subst">$&#123;user.name&#125;</span>&lt;/span&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">	&lt;p&gt;&lt;span class=&quot;k&quot;&gt;年龄&lt;/span&gt;&lt;span class=&quot;v&quot;&gt;<span class="subst">$&#123;user.age&#125;</span>&lt;/span&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * &lt;div&gt;</span></span><br><span class="line"><span class="comment"> *  &lt;p&gt;&lt;span class=&quot;k&quot;&gt;姓名&lt;/span&gt;&lt;span class=&quot;v&quot;&gt;monica&lt;/span&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *  &lt;p&gt;&lt;span class=&quot;k&quot;&gt;年龄&lt;/span&gt;&lt;span class=&quot;v&quot;&gt;17&lt;/span&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment"> * &lt;/div&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>



<h2 id="二、数组"><a href="#二、数组" class="headerlink" title="二、数组"></a>二、数组</h2><h3 id="1-for-of-循环"><a href="#1-for-of-循环" class="headerlink" title="1.for-of 循环"></a>1.for-of 循环</h3><p>ES6提供了一种爽翻天的方式遍历各种数组和伪数组</p>
<p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line"><span class="comment">// 过去的方式——垃圾</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">  <span class="keyword">const</span> item = arr[i]</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for of 的方式，结果一样</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">of</span> arr)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(item)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>示例2:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> elements = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.item&#x27;</span>);</span><br><span class="line"><span class="comment">// for of 的方式</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> elem <span class="keyword">of</span> elements)&#123;</span><br><span class="line">  <span class="comment">// elem 为获取到的每一个元素</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-新增API"><a href="#2-新增API" class="headerlink" title="2.新增API"></a>2.新增API</h3><table>
<thead>
<tr>
<th>API</th>
<th>作用</th>
<th>图示</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray">Array.isArray(target)</a></td>
<td>判断target是否为一个数组</td>
<td></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/from">Array.from(source)</a></td>
<td>将某个伪数组source转换为一个真数组返回</td>
<td></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/fill">Array.prototype.fill(n)</a></td>
<td>将数组的某些项设置为n</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602165516.png" alt="image-20210602165515908" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach">Array.prototype.forEach(fn)</a></td>
<td>遍历数组，传入一个函数，每次遍历会运行该函数</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602165832.png" alt="image-20210602165832725" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/map">Array.prototype.map(fn)</a></td>
<td>数组映射，传入一个函数，映射数组中的每一项</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602170025.png" alt="image-20210602170025141" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/filter">Array.prototype.filter(fn)</a></td>
<td>数组筛选，传入一个函数，仅保留满足条件的项</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602170149.png" alt="image-20210602170149489" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">Array.prototype.reduce(fn)</a></td>
<td>数组聚合，传入一个函数，对数组每一项按照该函数的返回聚合</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602170451.png" alt="image-20210602170451299" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/some">Array.prototype.some(fn)</a></td>
<td>传入一个函数，判断数组中是否有至少一个通过该函数测试的项</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602171403.png" alt="image-20210602171403455" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/every">Array.prototype.every(fn)</a></td>
<td>传入一个函数，判断数组中是否所有项都能通过该函数的测试</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602171441.png" alt="image-20210602171441468" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/find">Array.prototype.find(fn)</a></td>
<td>传入一个函数，找到数组中第一个能通过该函数测试的项</td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602171510.png" alt="image-20210602171510075" style="zoom:50%;" /></td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/includes">Array.prototype.includes(item)</a></td>
<td>判断数组中是否存在item，判定规则使用的是<code>Object.is</code>，<code>===</code></td>
<td><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210602170615.png" alt="image-20210602170615564" style="zoom:50%;" /></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="三、对象"><a href="#三、对象" class="headerlink" title="三、对象"></a>三、对象</h2><h3 id="1-对象成员速写"><a href="#1-对象成员速写" class="headerlink" title="1.对象成员速写"></a>1.对象成员速写</h3><p>在某些场景下，ES6提供了一种更加简洁的方式书写对象成员</p>
<p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&#x27;monica&#x27;</span>, age = <span class="number">17</span>;</span><br><span class="line"><span class="keyword">const</span> sayHello = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 过去的方式</span></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: name,</span><br><span class="line">  <span class="attr">age</span>: age,</span><br><span class="line">  <span class="attr">sayHello</span>: sayHello</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 速写</span></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  name,</span><br><span class="line">  age,</span><br><span class="line">  sayHello</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>示例2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 过去的方式</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyMath</span> = &#123;</span><br><span class="line">  <span class="attr">sum</span>: <span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">random</span>: <span class="keyword">function</span>(<span class="params">min, max</span>)&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 速写</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyMath</span> = &#123;</span><br><span class="line">  <span class="title function_">sum</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">random</span>(<span class="params">min, max</span>)&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-解构"><a href="#2-解构" class="headerlink" title="2.解构"></a>2.解构</h3><p>ES6提供了一种特殊的语法，通过该语法，可以轻松的从数组或对象中取出想要的部分</p>
<p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span>,</span><br><span class="line">  <span class="attr">addr</span>: &#123;</span><br><span class="line">    <span class="attr">province</span>: <span class="string">&#x27;黑龙江&#x27;</span>,</span><br><span class="line">    <span class="attr">city</span>: <span class="string">&#x27;哈尔滨&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取出 user 中的 name 和 age</span></span><br><span class="line"><span class="keyword">const</span> &#123; name, age &#125; = user;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name, age); <span class="comment">//  monica 17</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 取出 user 中的 city</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">addr</span>: &#123; city &#125; &#125; = user</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(city); <span class="comment">//  哈尔滨</span></span><br></pre></td></tr></table></figure>

<p>示例2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment">// 取出数组每一项的值，分别放到变量a、b、c、d中</span></span><br><span class="line"><span class="keyword">const</span> [a, b, c, d] = arr;</span><br><span class="line"><span class="comment">// 仅取出数组下标1、2的值</span></span><br><span class="line"><span class="keyword">const</span> [, a, b] = arr; </span><br><span class="line"><span class="comment">// 仅取出数组下标1、3的值</span></span><br><span class="line"><span class="keyword">const</span> [, a, , b] = arr;</span><br><span class="line"><span class="comment">// 取出数组前两位的值，放到变量a和b中，剩下的值放到一个新数组arr2中</span></span><br><span class="line"><span class="keyword">const</span> [a, b, ...arr2] = arr;</span><br></pre></td></tr></table></figure>

<p>示例3：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>, b = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 交换两个变量</span></span><br><span class="line">[b, a] = [a, b]</span><br></pre></td></tr></table></figure>

<p>示例4：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在参数位置对传入的对象进行解构</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">method</span>(<span class="params">&#123;a, b&#125;</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>:<span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>:<span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>:<span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">method</span>(obj); <span class="comment">// 1 2</span></span><br></pre></td></tr></table></figure>

<p>示例5：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 箭头函数也可以在参数位置进行解构</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">method</span> = (<span class="params">&#123;a, b&#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>:<span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>:<span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>:<span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">method</span>(obj); <span class="comment">// 1 2</span></span><br></pre></td></tr></table></figure>

<p>示例6：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> users = [</span><br><span class="line">  &#123;<span class="attr">name</span>:<span class="string">&#x27;monica&#x27;</span>, <span class="attr">age</span>:<span class="number">17</span>&#125;,</span><br><span class="line">  &#123;<span class="attr">name</span>:<span class="string">&#x27;邓哥&#x27;</span>, <span class="attr">age</span>:<span class="number">70</span>&#125;</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 在遍历时进行解构</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">const</span> &#123;name, age&#125; <span class="keyword">of</span> users)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(name, age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-展开运算符"><a href="#3-展开运算符" class="headerlink" title="3.展开运算符"></a>3.展开运算符</h3><p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">3</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">2</span>];</span><br><span class="line"><span class="comment">// 对数组的展开</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">max</span>(...arr); <span class="comment">// 相当于：Math.max(3, 6, 1, 7, 2)</span></span><br></pre></td></tr></table></figure>

<p>示例2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> o1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>, </span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> o2 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">3</span>, </span><br><span class="line">  <span class="attr">c</span>: <span class="number">4</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 对对象的展开</span></span><br><span class="line"><span class="keyword">const</span> o3 = &#123;</span><br><span class="line">  ...o1,</span><br><span class="line">  ...o2</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	o3：&#123;</span></span><br><span class="line"><span class="comment">		a: 3,</span></span><br><span class="line"><span class="comment">		b: 2,</span></span><br><span class="line"><span class="comment">		c: 4</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>示例3：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, ...arr, <span class="number">5</span>]; <span class="comment">// [1,2,3,4,5]</span></span><br></pre></td></tr></table></figure>

<p>示例4：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> user2 = &#123;</span><br><span class="line">  ...user,</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;邓哥&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// user2: &#123; name:&#x27;邓哥&#x27;, age: 17 &#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-属性描述符"><a href="#4-属性描述符" class="headerlink" title="4.属性描述符"></a>4.属性描述符</h3><p>对于对象中的每个成员，JS使用属性描述符来描述它们</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的对象，在JS内部被描述为</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 属性 name 的描述符</span></span><br><span class="line">  <span class="attr">name</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>, <span class="comment">// 该属性的描述符是否可以被重新定义</span></span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="comment">// 该属性是否允许被遍历，会影响for-in循环</span></span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">true</span> <span class="comment">// 该属性是否允许被修改</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 属性 age 的描述符</span></span><br><span class="line">  <span class="attr">age</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">17</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>, <span class="comment">// 该属性的描述符是否可以被重新定义</span></span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>, <span class="comment">// 该属性是否允许被遍历，会影响for-in循环</span></span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">true</span> <span class="comment">// 该属性是否允许被修改</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ES5提供了一系列的API，针对属性描述符进行操作</p>
<ol>
<li><p><code>Object.getOwnPropertyDescriptor(obj, propertyName)</code></p>
<p>该方法用于获取一个属性的描述符</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(user, <span class="string">&#x27;name&#x27;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    value: &#x27;monica&#x27;,</span></span><br><span class="line"><span class="comment">    configurable: true, // 该属性的描述符是否可以被重新定义</span></span><br><span class="line"><span class="comment">    enumerable: true, // 该属性是否允许被遍历，会影响for-in循环</span></span><br><span class="line"><span class="comment">    writable: true // 该属性是否允许被修改</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>Object.defineProperty(obj, propertyName, descriptor)</code></p>
<p>该方法用于定义某个属性的描述符</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, <span class="string">&#x27;name&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;邓哥&#x27;</span>, <span class="comment">// 将其值进行修改</span></span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">false</span>, <span class="comment">// 让该属性不能被遍历</span></span><br><span class="line">  <span class="attr">writable</span>: <span class="literal">false</span> <span class="comment">// 让该属性无法被重新赋值</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="getter-和-setter"><a href="#getter-和-setter" class="headerlink" title="getter 和 setter"></a>getter 和 setter</h4><p>属性描述符中有两个特殊的配置，分别为<code>get</code>和<code>set</code>，通过它们，可以把属性的取值和赋值变为方法调用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, <span class="string">&#x27;a&#x27;</span>, &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params"></span>)&#123; <span class="comment">// 读取属性a时，得到的是该方法的返回值</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">set</span>(<span class="params">val</span>)&#123; <span class="comment">// 设置属性a时，会把值传入val，调用该方法</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(val)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">a</span>); <span class="comment">// 输出：1</span></span><br><span class="line">obj.<span class="property">a</span> = <span class="number">3</span>; <span class="comment">// 输出：3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">a</span>); <span class="comment">// 输出：1</span></span><br></pre></td></tr></table></figure>

<h3 id="5-键值对"><a href="#5-键值对" class="headerlink" title="5.键值对"></a>5.键值对</h3><p><code>Object.keys(obj)</code>：获取对象的属性名组成的数组</p>
<p><code>Object.values(obj)</code>：获取对象的值组成的数组</p>
<p><code>Object.entries(obj)</code>：获取对象属性名和属性值组成的数组</p>
<p><code>Object.fromEntries(entries)</code>：将属性名和属性值的数组转换为对象</p>
<p>示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;monica&#x27;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">17</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(user); <span class="comment">// [&quot;name&quot;, &quot;age&quot;]</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">values</span>(user); <span class="comment">// [&quot;monica&quot;, 17]</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">entries</span>(user); <span class="comment">// [ [&quot;name&quot;, &quot;monica&quot;], [&quot;age&quot;, 17] ]</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">fromEntries</span>([ [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;monica&quot;</span>], [<span class="string">&quot;age&quot;</span>, <span class="number">17</span>] ]); <span class="comment">// &#123;name:&#x27;monica&#x27;, age:17&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-冻结"><a href="#6-冻结" class="headerlink" title="6.冻结"></a>6.冻结</h3><p>使用<code>Object.freeze(obj)</code>可以冻结一个对象，该对象的所有属性均不可更改</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: &#123;</span><br><span class="line">    <span class="attr">c</span>: <span class="number">3</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">freeze</span>(obj); <span class="comment">//  冻结对象obj</span></span><br><span class="line"></span><br><span class="line">obj.<span class="property">a</span> = <span class="number">2</span>; <span class="comment">// 不报错，代码无效</span></span><br><span class="line">obj.<span class="property">k</span> = <span class="number">4</span>; <span class="comment">// 不报错，代码无效</span></span><br><span class="line"><span class="keyword">delete</span> obj.<span class="property">a</span>; <span class="comment">// 不报错，代码无效</span></span><br><span class="line">obj.<span class="property">b</span> = <span class="number">5</span>; <span class="comment">// 不报错，代码无效</span></span><br><span class="line"></span><br><span class="line">obj.<span class="property">b</span>.<span class="property">c</span> = <span class="number">5</span>; <span class="comment">// b对象没有被冻结，有效</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj); <span class="comment">// &#123;a:1, b:&#123; c: 5 &#125; &#125;</span></span><br></pre></td></tr></table></figure>

<p>可以使用<code>Object.isFrozen</code>来判断一个对象是否被冻结</p>
<h3 id="7-相同性判定"><a href="#7-相同性判定" class="headerlink" title="7.相同性判定"></a>7.相同性判定</h3><p><code>Object.is</code>方法，可以判断两个值是否相同，它和<code>===</code>的功能基本一致，区别在于：</p>
<ul>
<li>NaN和NaN相等</li>
<li>+0和-0不相等</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="string">&quot;1&quot;</span>, <span class="number">1</span>); <span class="comment">// false</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(<span class="title class_">NaN</span>, <span class="title class_">NaN</span>); <span class="comment">// true 和 === 唯一区别 NaN === NaN true</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(+<span class="number">0</span>, -<span class="number">0</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<h3 id="8-Set"><a href="#8-Set" class="headerlink" title="8.Set"></a>8.Set</h3><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set">Set MDN</a></p>
<p>ES6新增了Set结构，用于保存唯一值的序列</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"><span class="comment">// 数组去重：获取一个不包含重复项的新数组</span></span><br><span class="line"><span class="keyword">const</span> s = <span class="keyword">new</span> <span class="title class_">Set</span>(arr);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s); <span class="comment">// 会去掉重复项 返回 &#123;1,4,7,2,3,5,6&#125;</span></span><br><span class="line"><span class="comment">// 转化为数组</span></span><br><span class="line"><span class="keyword">const</span> newArr = [...s]</span><br></pre></td></tr></table></figure>

<h3 id="9-Map"><a href="#9-Map" class="headerlink" title="9.Map"></a>9.Map</h3><p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map">Map MDN</a></p>
<p>ES6新增了Map结构，用于保存键值对的映射，它和对象的最大区别在于：对象的键只能是字符串，而Map的键可以是任何类型</p>
<h2 id="四、函数"><a href="#四、函数" class="headerlink" title="四、函数"></a>四、函数</h2><h3 id="1-箭头函数"><a href="#1-箭头函数" class="headerlink" title="1.箭头函数"></a>1.箭头函数</h3><p>所有使用<strong>函数表达式</strong>的位置，均可以替换为箭头函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>箭头函数语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 完整语法</span></span><br><span class="line">(参数列表) =&gt; &#123; 函数体 &#125;</span><br><span class="line"><span class="comment">// 若有且仅有一个参数</span></span><br><span class="line">参数 =&gt; &#123; 函数体 &#125;</span><br><span class="line"><span class="comment">// 若函数体有且仅有一条返回语句</span></span><br><span class="line">(参数列表) =&gt; 返回语句</span><br></pre></td></tr></table></figure>

<p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sum = <span class="keyword">function</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 箭头函数写法</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params">a, b</span>) =&gt; a + b</span><br></pre></td></tr></table></figure>

<p>示例2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dom.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">  <span class="comment">// ....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 箭头函数写法</span></span><br><span class="line">dom.<span class="property">onclick</span> = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>示例3：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 箭头函数写法</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<p>箭头函数有以下特点：</p>
<ol>
<li><p>不能使用<code>new</code>调用</p>
</li>
<li><p>没有原型，即没有<code>prototype</code>属性</p>
</li>
<li><p>没有<code>arugments</code></p>
</li>
<li><p>没有<code>this</code></p>
<blockquote>
<p>有些教程中会说：箭头函数的<code>this</code>永远指向箭头函数定义位置的<code>this</code>，因为箭头函数会绑定<code>this</code>。</p>
<p>这个说法没错，根本原因是它没有<code>this</code>，它里面的<code>this</code>使用的是外层的<code>this</code></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> counter = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">start</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 这里的 this 指向 counter</span></span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 这里的 this 实际上是 start 函数的 this</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++;</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>不能用箭头函数替代的部分函数表达式</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. </span></span><br><span class="line"><span class="comment">// 原格式</span></span><br><span class="line">!<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125; <span class="comment">// false</span></span><br><span class="line"><span class="comment">// 箭头函数</span></span><br><span class="line">!<span class="function">()=&gt;</span>&#123;&#125; <span class="comment">// 报错，语法错误，会把&#x27;!()&#x27;当成一个参数，参数名不合法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.生成器函数</span></span><br><span class="line"><span class="comment">// 原格式</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">a</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"><span class="comment">// 箭头函数</span></span><br><span class="line">*<span class="function">()=&gt;</span>&#123;&#125; <span class="comment">// 报错，没有这种写法</span></span><br></pre></td></tr></table></figure></li>
</ol>
<p>箭头函数的这些特点，都足以说明：<strong>箭头函数特别适用于那些临时需要函数的位置</strong></p>
<blockquote>
<p>我们将来会在面试指导阶段对this指向进行总结</p>
</blockquote>
<h3 id="2-剩余参数"><a href="#2-剩余参数" class="headerlink" title="2.剩余参数"></a>2.剩余参数</h3><p>ES6不建议再使用<code>arguments</code>来获取参数列表，它推荐使用剩余参数来收集未知数量的参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...args为剩余参数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">method</span>(<span class="params">a, b, ...args</span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, args)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>); <span class="comment">// 1 2 [3, 4, 5, 6, 7]</span></span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1 2 []</span></span><br></pre></td></tr></table></figure>

<p><strong>注意，剩余参数只能声明为最后一个参数</strong></p>
<h3 id="3-参数默认值"><a href="#3-参数默认值" class="headerlink" title="3.参数默认值"></a>3.参数默认值</h3><p>ES6提供了参数默认值，当参数没有传递或传递为<code>undefined</code>时，会使用默认值</p>
<p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对参数 b 使用了默认值1</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">method</span>(<span class="params">a, b = <span class="number">1</span></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1  2</span></span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>); <span class="comment">// 1 1</span></span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>, <span class="literal">undefined</span>); <span class="comment">// 1 1</span></span><br></pre></td></tr></table></figure>

<p>示例2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对参数 b 使用了默认值1， 对参数 c 使用默认值2  可以用默认值写法代替 ||和三元运算符 如：page: page || 1</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">method</span> = (<span class="params">a, b = <span class="number">1</span>, c = <span class="number">2</span>, d</span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c, d)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// 1 2 2 undefined</span></span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>); <span class="comment">// 1 1 2 undefined</span></span><br><span class="line"><span class="title function_">method</span>(<span class="number">1</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="number">4</span>); <span class="comment">// 1 1 2 4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 练习题p5答案,开发时可以参考使用</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getDatas</span> = (<span class="params">&#123;page = <span class="number">1</span>,limit = <span class="number">10</span>,keyword = <span class="string">&#x27;&#x27;</span>&#125; = &#123;&#125;</span>)=&gt;&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(page,limit,keyword)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// getDatas函数如果不传参数，就给一个空对象，然后解构，赋默认值</span></span><br></pre></td></tr></table></figure>

<h3 id="4-类语法"><a href="#4-类语法" class="headerlink" title="4.类语法"></a>4.类语法</h3><p>过去，函数有着两种调用方式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">A</span>(); <span class="comment">// 直接调用</span></span><br><span class="line"><span class="keyword">new</span> <span class="title function_">A</span>(); <span class="comment">// 作为构造函数调用</span></span><br></pre></td></tr></table></figure>

<p>这种做法无法从定义上明确函数的用途，因此，ES6推出了一种全新的语法来书写构造函数</p>
<p>示例1：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧的写法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">User</span>(<span class="params">firstName, lastName</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">firstName</span> = firstName;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">lastName</span> = lastName;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">fullName</span> = <span class="string">`<span class="subst">$&#123;firstName&#125;</span> <span class="subst">$&#123;lastName&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 静态方法</span></span><br><span class="line"><span class="title class_">User</span>.<span class="property">isUser</span> = <span class="keyword">function</span>(<span class="params">u</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> !!u &amp;&amp; !!u.<span class="property">fullName</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 实例方法</span></span><br><span class="line"><span class="title class_">User</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.fullName&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新的等效写法</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">firstName, lastName</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">firstName</span> = firstName;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">lastName</span> = lastName;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">fullName</span> = <span class="string">`<span class="subst">$&#123;firstName&#125;</span> <span class="subst">$&#123;lastName&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="title function_">isUser</span>(<span class="params">u</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> !!u &amp;&amp; !!u.<span class="property">fullName</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">sayHello</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.fullName&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>示例2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 旧方式的继承</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params">type, name</span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">type</span> = type;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">intro</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`I am <span class="subst">$&#123;<span class="variable language_">this</span>.type&#125;</span>, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Dog</span>(<span class="params">name</span>)&#123;</span><br><span class="line">  <span class="title class_">Animal</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, <span class="string">&#x27;狗&#x27;</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Dog</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>); <span class="comment">// 设置继承关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 新的方式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">type, name</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = type;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">intro</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`I am <span class="subst">$&#123;<span class="variable language_">this</span>.type&#125;</span>, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Animal</span>&#123;</span><br><span class="line"> 	<span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">super</span>(<span class="string">&#x27;狗&#x27;</span>, name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="5-函数API"><a href="#5-函数API" class="headerlink" title="5.函数API"></a>5.函数API</h3><table>
<thead>
<tr>
<th>API</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call">Function.prototype.call(obj, …args)</a></td>
<td>调用函数，绑定this为obj<br />后续以列表的形式提供参数</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">Function.prototype.apply(obj, args)</a></td>
<td>调用函数，绑定this为obj<br />args以数组的形式提供参数</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">Function.prototype.bind(obj, …args)</a></td>
<td>返回一个函数的拷贝<br />新函数的this被绑定为obj<br />起始参数被绑定为args</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p><strong>上面五个点可以做下练习</strong>：**练习题地址：[02. JavaScript语言提升 · 拾贰&#x2F;frontend-training - 码云 - 开源中国 (gitee.com) ](<a target="_blank" rel="noopener" href="https://gitee.com/xlt-vue/frontend-training/tree/master/02">https://gitee.com/xlt-vue/frontend-training/tree/master/02</a>. JavaScript语言提升) **</p>
<h2 id="五、事件循环"><a href="#五、事件循环" class="headerlink" title="五、事件循环"></a>五、事件循环</h2><h3 id="1-浏览器的进程模型"><a href="#1-浏览器的进程模型" class="headerlink" title="1.浏览器的进程模型"></a>1.浏览器的进程模型</h3><h4 id="何为进程？"><a href="#何为进程？" class="headerlink" title="何为进程？"></a>何为进程？</h4><p>程序运行需要有它自己专属的内存空间，可以把这块内存空间简单的理解为进程</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/202208092057573.png" alt="image-20220809205743532" style="zoom:50%;" />

<p>每个应用至少有一个进程，进程之间相互独立，即使要通信，也需要双方同意。</p>
<h4 id="何为线程？"><a href="#何为线程？" class="headerlink" title="何为线程？"></a>何为线程？</h4><p>有了进程后，就可以运行程序的代码了。</p>
<p>运行代码的「人」称之为「线程」。</p>
<p>一个进程至少有一个线程，所以在进程开启后会自动创建一个线程来运行代码，该线程称之为主线程。</p>
<p>如果程序需要同时执行多块代码，主线程就会启动更多的线程来执行代码，所以一个进程中可以包含多个线程。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/202208092108499.png" alt="image-20220809210859457"></p>
<h4 id="浏览器有哪些进程和线程？"><a href="#浏览器有哪些进程和线程？" class="headerlink" title="浏览器有哪些进程和线程？"></a>浏览器有哪些进程和线程？</h4><p><strong>浏览器是一个多进程多线程的应用程序</strong></p>
<p>浏览器内部工作极其复杂。</p>
<p>为了避免相互影响，为了减少连环崩溃的几率，当启动浏览器后，它会自动启动多个进程。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/202208092131410.png" alt="image-20220809213152371"></p>
<blockquote>
<p>可以在浏览器的任务管理器中查看当前的所有进程</p>
</blockquote>
<p>其中，最主要的进程有：</p>
<ol>
<li><p>浏览器进程</p>
<p>主要负责界面显示、用户交互、子进程管理等。浏览器进程内部会启动多个线程处理不同的任务。</p>
</li>
<li><p>网络进程</p>
<p>负责加载网络资源。网络进程内部会启动多个线程来处理不同的网络任务。</p>
</li>
<li><p><strong>渲染进程</strong>（本节课重点讲解的进程）</p>
<p>渲染进程启动后，会开启一个<strong>渲染主线程</strong>，主线程负责执行 HTML、CSS、JS 代码。</p>
<p>默认情况下，浏览器会为每个标签页开启一个新的渲染进程，以保证不同的标签页之间不相互影响。</p>
<blockquote>
<p>将来该默认模式可能会有所改变，有兴趣的同学可参见<a target="_blank" rel="noopener" href="https://chromium.googlesource.com/chromium/src/+/main/docs/process_model_and_site_isolation.md#Modes-and-Availability">chrome官方说明文档</a></p>
</blockquote>
</li>
</ol>
<h3 id="2-渲染主线程是如何工作的？"><a href="#2-渲染主线程是如何工作的？" class="headerlink" title="2.渲染主线程是如何工作的？"></a>2.渲染主线程是如何工作的？</h3><p>渲染主线程是浏览器中最繁忙的线程，需要它处理的任务包括但不限于：</p>
<ul>
<li>解析 HTML</li>
<li>解析 CSS</li>
<li>计算样式</li>
<li>布局</li>
<li>处理图层</li>
<li>每秒把页面画 60 次</li>
<li>执行全局 JS 代码</li>
<li>执行事件处理函数</li>
<li>执行计时器的回调函数</li>
<li>……</li>
</ul>
<blockquote>
<p>思考题：为什么渲染进程不适用多个线程来处理这些事情？</p>
</blockquote>
<p>要处理这么多的任务，主线程遇到了一个前所未有的难题：如何调度任务？</p>
<p>比如：</p>
<ul>
<li>我正在执行一个 JS 函数，执行到一半的时候用户点击了按钮，我该立即去执行点击事件的处理函数吗？</li>
<li>我正在执行一个 JS 函数，执行到一半的时候某个计时器到达了时间，我该立即去执行它的回调吗？</li>
<li>浏览器进程通知我“用户点击了按钮”，与此同时，某个计时器也到达了时间，我应该处理哪一个呢？</li>
<li>……</li>
</ul>
<p>渲染主线程想出了一个绝妙的主意来处理这个问题：排队</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/202208092230847.png" alt="image-20220809223027806"></p>
<ol>
<li>在最开始的时候，渲染主线程会进入一个无限循环</li>
<li>每一次循环会检查消息队列中是否有任务存在。如果有，就取出第一个任务执行，执行完一个后进入下一次循环；如果没有，则进入休眠状态。</li>
<li>其他所有线程（包括其他进程的线程）可以随时向消息队列添加任务。新任务会加到消息队列的末尾。在添加新任务时，如果主线程是休眠状态，则会将其唤醒以继续循环拿取任务</li>
</ol>
<p>这样一来，就可以让每个任务有条不紊的、持续的进行下去了。</p>
<p><strong>整个过程，被称之为事件循环（消息循环）</strong></p>
<blockquote>
<p>w3c标准是事件循环，浏览器是消息循环</p>
</blockquote>
<h3 id="3-若干解释"><a href="#3-若干解释" class="headerlink" title="3.若干解释"></a>3.若干解释</h3><h4 id="何为异步？"><a href="#何为异步？" class="headerlink" title="何为异步？"></a>何为异步？</h4><p>代码在执行过程中，会遇到一些无法立即处理的任务，比如：</p>
<ul>
<li>计时完成后需要执行的任务 —— <code>setTimeout</code>、<code>setInterval</code></li>
<li>网络通信完成后需要执行的任务 – <code>XHR</code>、<code>Fetch</code></li>
<li>用户操作后需要执行的任务 – <code>addEventListener</code></li>
</ul>
<p>如果让渲染主线程等待这些任务的时机达到，就会导致主线程长期处于「阻塞」的状态，从而导致浏览器「卡死」</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/202208101043348.png" alt="image-20220810104344296"></p>
<p><strong>渲染主线程承担着极其重要的工作，无论如何都不能阻塞！</strong></p>
<p>因此，浏览器选择<strong>异步</strong>来解决这个问题</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/202208101048899.png" alt="image-20220810104858857"></p>
<p>使用异步的方式，<strong>渲染主线程永不阻塞</strong></p>
<blockquote>
<p>面试题：如何理解 JS 的异步？</p>
<p>参考答案：</p>
<p>JS是一门单线程的语言，这是因为它运行在浏览器的渲染主线程中，而渲染主线程只有一个。</p>
<p>而渲染主线程承担着诸多的工作，渲染页面、执行 JS 都在其中运行。</p>
<p>如果使用同步的方式，就极有可能导致主线程产生阻塞，从而导致消息队列中的很多其他任务无法得到执行。这样一来，一方面会导致繁忙的主线程白白的消耗时间，另一方面导致页面无法及时更新，给用户造成卡死现象。</p>
<p>所以浏览器采用异步的方式来避免。具体做法是当某些任务发生时，比如计时器、网络、事件监听，主线程将任务交给其他线程去处理，自身立即结束任务的执行，转而执行后续代码。当其他线程完成时，将事先传递的回调函数包装成任务，加入到消息队列的末尾排队，等待主线程调度执行。</p>
<p>在这种异步模式下，浏览器永不阻塞，从而最大限度的保证了单线程的流畅运行。</p>
</blockquote>
<h4 id="JS为何会阻碍渲染？"><a href="#JS为何会阻碍渲染？" class="headerlink" title="JS为何会阻碍渲染？"></a>JS为何会阻碍渲染？</h4><p>先看代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Mr.Yuan is awesome!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> h1 = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;h1&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 死循环指定的时间</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">delay</span>(<span class="params">duration</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> start = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">while</span> (<span class="title class_">Date</span>.<span class="title function_">now</span>() - start &lt; duration) &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  btn.<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    h1.<span class="property">textContent</span> = <span class="string">&#x27;袁老师很帅！&#x27;</span>; <span class="comment">// 会产生一个任务进入消息队列，等死循环完成后再执行该任务</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">delay</span>(<span class="number">3000</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 三秒后文本才会发生改变</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击按钮后，会发生什么呢？</p>
<p>&lt;见具体演示&gt; [02. JavaScript语言提升&#x2F;05. 事件循环&#x2F;演示.dio · 拾贰&#x2F;frontend-training - 码云 - 开源中国 (gitee.com)](<a target="_blank" rel="noopener" href="https://gitee.com/xlt-vue/frontend-training/blob/master/02">https://gitee.com/xlt-vue/frontend-training/blob/master/02</a>. JavaScript语言提升&#x2F;05. 事件循环&#x2F;演示.dio)</p>
<h4 id="任务有优先级吗？"><a href="#任务有优先级吗？" class="headerlink" title="任务有优先级吗？"></a>任务有优先级吗？</h4><p>任务没有优先级，在消息队列中先进先出</p>
<p>但<strong>消息队列是有优先级的</strong></p>
<p>根据 W3C 的最新解释:</p>
<ul>
<li>每个任务都有一个任务类型，同一个类型的任务必须在一个队列，不同类型的任务可以分属于不同的队列。<br>在一次事件循环中，浏览器可以根据实际情况从不同的队列中取出任务执行。</li>
<li>浏览器必须准备好一个微队列，微队列中的任务优先所有其他任务执行<br><a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint">https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint</a></li>
</ul>
<blockquote>
<p>随着浏览器的复杂度急剧提升，W3C 不再使用宏队列的说法（之前是宏任务和微任务）</p>
</blockquote>
<p>在目前 chrome 的实现中，至少包含了下面的队列：</p>
<ul>
<li>延时队列：用于存放计时器到达后的回调任务，优先级「中」</li>
<li>交互队列：用于存放用户操作后产生的事件处理任务，优先级「高」</li>
<li>微队列：用户存放需要最快执行的任务，优先级「最高」</li>
</ul>
<blockquote>
<p>添加任务到微队列的主要方式主要是使用 Promise、MutationObserver</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 立即把一个函数添加到微队列</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(函数)</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>浏览器还有很多其他的队列，由于和我们开发关系不大，不作考虑</p>
</blockquote>
<blockquote>
<p>面试题：阐述一下 JS 的事件循环</p>
<p>参考答案：</p>
<p>事件循环又叫做消息循环，是浏览器渲染主线程的工作方式。</p>
<p>在 Chrome 的源码中，它开启一个不会结束的 for 循环，每次循环从消息队列中取出第一个任务执行，而其他线程只需要在合适的时候将任务加入到队列末尾即可。</p>
<p>过去把消息队列简单分为宏队列和微队列，这种说法目前已无法满足复杂的浏览器环境，取而代之的是一种更加灵活多变的处理方式。</p>
<p>根据 W3C 官方的解释，每个任务有不同的类型，同类型的任务必须在同一个队列，不同的任务可以属于不同的队列。不同任务队列有不同的优先级，在一次事件循环中，由浏览器自行决定取哪一个队列的任务（一般先取交互队列的，因为不希望出现点击某个按钮不能立即响应的问题）。但浏览器必须有一个微队列，微队列的任务一定具有最高的优先级，必须优先调度执行。</p>
</blockquote>
<blockquote>
<p>面试题：JS 中的计时器能做到精确计时吗？为什么？</p>
<p>参考答案：</p>
<p>不行，因为：</p>
<ol>
<li>计算机硬件没有原子钟，无法做到精确计时</li>
<li>操作系统的计时函数本身就有少量偏差，由于 JS 的计时器最终调用的是操作系统的函数，也就携带了这些偏差</li>
<li>按照 W3C 的标准，浏览器实现计时器时，如果嵌套层级超过 5 层，则会带有 4 毫秒的最少时间，这样在计时时间少于 4 毫秒时又带来了偏差</li>
<li>受事件循环的影响，计时器的回调函数只能在主线程空闲时运行，因此又带来了偏差</li>
</ol>
</blockquote>
<p><strong>事件循环相关题目：[02. JavaScript语言提升&#x2F;05. 事件循环 · 拾贰&#x2F;frontend-training - 码云 - 开源中国 (gitee.com)](<a target="_blank" rel="noopener" href="https://gitee.com/xlt-vue/frontend-training/tree/master/02">https://gitee.com/xlt-vue/frontend-training/tree/master/02</a>. JavaScript语言提升&#x2F;05. 事件循环)</strong></p>
<p><strong>注意</strong>：单线程是异步产生的原因，事件循环是异步的实现方式</p>
<h2 id="六、Promise基础"><a href="#六、Promise基础" class="headerlink" title="六、Promise基础"></a>六、Promise基础</h2><blockquote>
<p>本节课的任务：</p>
<ol>
<li>理解Promise A+规范的基本概念</li>
<li>学会创建Promise</li>
<li>学会针对Promise进行后续处理</li>
</ol>
</blockquote>
<h3 id="1-邓哥的烦恼"><a href="#1-邓哥的烦恼" class="headerlink" title="1.邓哥的烦恼"></a>1.邓哥的烦恼</h3><p>邓哥心中有很多女神，他今天下定决心，要向这些女神表白，他认为，只要女神够多，根据概率学原理，总有一个会接收他</p>
<p>稳妥起见，邓哥决定使用<strong>串行</strong>的方式进行表白：先给第1位女神发送短信，然后等待女神的回应，如果成功了，就结束，如果失败了，则再给第2位女神发送短信，依次类推</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618150543.png" alt="image-20210618150543263"></p>
<p>邓哥的女神一共有4位，名字分别是：李建国、王富贵、周聚财、刘人勇</p>
<p>发短信是一个重复性的劳动，邓哥是个程序员，因此决定用函数封装这个动作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向某位女生发送一则表白短信</span></span><br><span class="line"><span class="comment">// name: 女神的姓名</span></span><br><span class="line"><span class="comment">// onFulffiled: 成功后的回调</span></span><br><span class="line"><span class="comment">// onRejected: 失败后的回调</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">name, onFulffiled, onRejected</span>) &#123;</span><br><span class="line">  <span class="comment">// 模拟 发送表白短信</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">    <span class="string">`邓哥 -&gt; <span class="subst">$&#123;name&#125;</span>：最近有谣言说我喜欢你，我要澄清一下，那不是谣言😘`</span></span><br><span class="line">  );</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`等待<span class="subst">$&#123;name&#125;</span>回复......`</span>);</span><br><span class="line">  <span class="comment">// 模拟 女神回复需要一段时间</span></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 模拟 有10%的几率成功</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt;= <span class="number">0.1</span>) &#123;</span><br><span class="line">      <span class="comment">// 成功，调用 onFuffiled，并传递女神的回复</span></span><br><span class="line">      <span class="title function_">onFulffiled</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：我是九，你是三，除了你还是你😘`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 失败，调用 onRejected，并传递女神的回复</span></span><br><span class="line">      <span class="title function_">onRejected</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：你是个好人😜`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>有了这个函数后，邓哥于是开始编写程序发送短信了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 首先向 李建国 发送消息</span></span><br><span class="line"><span class="title function_">sendMessage</span>(</span><br><span class="line">  <span class="string">&#x27;李建国&#x27;</span>,</span><br><span class="line">  <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果成功了，输出回复的消息后，结束</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 如果失败了，输出回复的消息后，向 王富贵 发送消息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">    <span class="title function_">sendMessage</span>(</span><br><span class="line">      <span class="string">&#x27;王富贵&#x27;</span>,</span><br><span class="line">      <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 如果成功了，输出回复的消息后，结束</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 如果失败了，输出回复的消息后，向 周聚财 发送消息</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">        <span class="title function_">sendMessage</span>(</span><br><span class="line">          <span class="string">&#x27;周聚财&#x27;</span>,</span><br><span class="line">          <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 如果成功了，输出回复的消息后，结束</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 如果失败了，输出回复的消息后，向 刘人勇 发送消息</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">            <span class="title function_">sendMessage</span>(</span><br><span class="line">              <span class="string">&#x27;刘人勇&#x27;</span>,</span><br><span class="line">              <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 如果成功了，输出回复的消息后，结束</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 如果失败了，就彻底没戏了</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥命犯天煞孤星，注定孤独终老！！&#x27;</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>该程序完成后，邓哥内心是崩溃的</p>
<p>这一层一层的回调嵌套，形成了传说中的「<strong>回调地狱 callback hell</strong>」</p>
<p>邓哥是个完美主义者，怎么能忍受这样的代码呢？</p>
<p>要解决这样的问题，需要Promise出马</p>
<h3 id="2-Promise规范"><a href="#2-Promise规范" class="headerlink" title="2.Promise规范"></a>2.Promise规范</h3><p>Promise是一套专门处理异步场景的规范，它能有效的避免回调地狱的产生，使异步代码更加清晰、简洁、统一</p>
<p>这套规范最早诞生于前端社区，规范名称为<a target="_blank" rel="noopener" href="https://promisesaplus.com/">Promise A+</a></p>
<p>该规范出现后，立即得到了很多开发者的响应</p>
<p>Promise A+ 规定：</p>
<ol>
<li><p>所有的异步场景，都可以看作是一个异步任务，每个异步任务，在JS中应该表现为一个<strong>对象</strong>，该对象称之为<strong>Promise对象</strong>，也叫做任务对象</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618154556.png" alt="image-20210618154556558" style="zoom:50%;" />
</li>
<li><p>每个任务对象，都应该有两个阶段、三个状态</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618155145.png" alt="image-20210618155145355" style="zoom:50%;" />

<p>根据常理，它们之间存在以下逻辑：</p>
<ul>
<li>任务总是从未决阶段变到已决阶段，无法逆行</li>
<li>任务总是从挂起状态变到完成或失败状态，无法逆行</li>
<li>时间不能倒流，历史不可改写，任务一旦完成或失败，状态就固定下来，永远无法改变</li>
</ul>
</li>
<li><p><code>挂起-&gt;完成</code>，称之为<code>resolve</code>；<code>挂起-&gt;失败</code>称之为<code>reject</code>。任务完成时，可能有一个相关数据；任务失败时，可能有一个失败原因。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618160538.png" alt="image-20210618160538875"></p>
</li>
<li><p>可以针对任务进行后续处理，针对完成状态的后续处理称之为onFulfilled，针对失败的后续处理称之为onRejected</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618161125.png" alt="image-20210618161125894"></p>
</li>
</ol>
<h3 id="3-Promise-API"><a href="#3-Promise-API" class="headerlink" title="3.Promise API"></a>3.Promise API</h3><p>ES6提供了一套API，实现了Promise A+规范</p>
<p>基本使用如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个任务对象，该任务立即进入 pending 状态。创建Promise的回调立即执行</span></span><br><span class="line"><span class="keyword">const</span> pro = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 任务的具体执行流程，该函数会立即被执行</span></span><br><span class="line">  <span class="comment">// 调用 resolve(data)，可将任务变为 fulfilled 状态， data 为需要传递的相关数据</span></span><br><span class="line">  <span class="comment">// 调用 reject(reason)，可将任务变为 rejected 状态，reason 为需要传递的失败原因</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pro) <span class="comment">// pending 初始状态为挂起</span></span><br><span class="line">pro.<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// onFulfilled 函数，当任务完成后，会自动运行该函数，data为任务完成的相关数据</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">reason</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// onRejected 函数，当任务失败后，会自动运行该函数，reason为任务失败的相关原因</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="4-邓哥的解决方案"><a href="#4-邓哥的解决方案" class="headerlink" title="4. 邓哥的解决方案"></a>4. 邓哥的解决方案</h3><p>学习了ES6的Promise后，邓哥决定对<code>sendMessage</code>函数进行改造，改造结果如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向某位女生发送一则表白短信</span></span><br><span class="line"><span class="comment">// name: 女神的姓名</span></span><br><span class="line"><span class="comment">// 该函数返回一个任务对象</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 模拟 发送表白短信</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">`邓哥 -&gt; <span class="subst">$&#123;name&#125;</span>：最近有谣言说我喜欢你，我要澄清一下，那不是谣言😘`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`等待<span class="subst">$&#123;name&#125;</span>回复......`</span>);</span><br><span class="line">    <span class="comment">// 模拟 女神回复需要一段时间</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 模拟 有10%的几率成功</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt;= <span class="number">0.1</span>) &#123;</span><br><span class="line">        <span class="comment">// 成功，调用 resolve，并传递女神的回复</span></span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：我是九，你是三，除了你还是你😘`</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 失败，调用 reject，并传递女神的回复</span></span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：你是个好人😜`</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>之后，就可以使用该函数来发送消息了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">sendMessage</span>(<span class="string">&#x27;李建国&#x27;</span>).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 女神答应了，输出女神的回复</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">reason</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 女神拒绝了，输出女神的回复</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reason);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>至此，回调地狱的问题仍然没能解决</p>
<p>要解决回调地狱，还需要进一步学习Promise的知识</p>
</blockquote>
<h2 id="七、Promise的链式处理"><a href="#七、Promise的链式处理" class="headerlink" title="七、Promise的链式处理"></a>七、Promise的链式处理</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618161125.png" alt="image-20210618161125894"></p>
<h3 id="1-catch方法"><a href="#1-catch方法" class="headerlink" title="1.catch方法"></a>1.catch方法</h3><p><code>.catch(onRejected)</code> &#x3D; <code>.then(null, onRejected)</code></p>
<h3 id="2-链式调用"><a href="#2-链式调用" class="headerlink" title="2.链式调用"></a>2.链式调用</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210621103501.png" alt="image-20210621103501094"></p>
<ol>
<li><p>then方法必定会返回一个新的Promise</p>
<p>可理解为<code>后续处理也是一个任务</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pro1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;学习&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pro1); <span class="comment">// promise</span></span><br><span class="line"><span class="keyword">const</span> pro2 = pro1.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;考试&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pro2); <span class="comment">// then会返回一个新的 promise </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>新任务的状态取决于后续处理：</p>
<ul>
<li>若没有相关的后续处理，新任务的状态和前任务一致，数据为前任务的数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pro1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">reject</span>(<span class="string">&#x27;学习&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pro1); <span class="comment">// reject</span></span><br><span class="line"><span class="keyword">const</span> pro2 = pro1.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;考试&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(pro2); <span class="comment">// pro2是pro1的后续处理，因为pro2没有对pro1进行失败处理，所以pro2也是失败状态，且原因一样</span></span><br><span class="line"><span class="comment">// pro2 是对 pro1 调用 .then() 和 .catch() 方法后返回的结果。当一个 Promise 被 .then() 或 .catch() 方法处理后，返回的仍然是一个新的Promise 对象。</span></span><br><span class="line"><span class="comment">// 在这个例子中，由于 pro1 被拒绝，.catch() 方法被执行，但是 .catch() 方法中没有显式地返回一个值，所以默认返回 undefined。这就导致 pro2 是一个 Promise 对象，其状态取决于 .catch() 的执行结果，而由于没有显式返回值，最终结果为 Promise &#123; undefined &#125;。</span></span><br><span class="line"><span class="comment">// 注意：在这里袁老师说的是pro2也是失败态，也就是rejected，而豆包说这里应该是pending，豆包解释上述结论如下</span></span><br><span class="line"><span class="comment">/* 一、关于新任务的状态和前任务一致</span></span><br><span class="line"><span class="comment">当提到 “新任务的状态和前任务一致” 时，这里的 “新任务” 通常指的是基于前一个任务（比如一个 Promise）进行进一步操作后产生的新的异步操作或任务。</span></span><br><span class="line"><span class="comment">以 Promise 为例，如果前一个 Promise 处于已决状态（成功态或拒绝态），而新任务没有对这个已决状态进行明确的处理（例如通过 .then()、.catch() 等方法），那么新任务的状态在一定程度上会反映前任务的状态。比如前任务是拒绝状态，新任务没有处理拒绝的逻辑，那么新任务可能也会被认为处于一种不稳定或类似拒绝的状态，尽管严格来说新任务的实际状态可能是 “待定”（pending），但在行为表现上与前任务的拒绝状态有相似之处，因为没有进行恰当的处理来改变其状态走向。</span></span><br><span class="line"><span class="comment">二、关于数据为前任务的数据</span></span><br><span class="line"><span class="comment">如果前任务已经有了确定的结果数据，当新任务的状态与前任务状态相关联且没有进行额外的数据处理时，新任务所涉及的数据可能会继承或与前任务的数据有紧密联系。</span></span><br><span class="line"><span class="comment">例如在 Promise 的链式调用中，如果前一个 Promise 被拒绝并带有一个特定的错误信息，新任务没有对这个错误进行处理，那么在某些情况下，如果新任务最终被观察到其结果时，可能会发现它似乎携带了与前任务相同的错误信息，或者在行为表现上受到前任务数据的影响。</span></span><br><span class="line"><span class="comment">总之，这句话强调了在异步操作的链条中，如果不进行适当的处理，新的操作或任务会在状态和数据方面受到前一个任务的强烈影响，提醒开发者在进行异步编程时要注意对每个任务的状态和结果数据进行恰当的处理和管理，以确保程序的正确性和稳定性。 */</span></span><br></pre></td></tr></table></figure>

<ul>
<li>若有后续处理但还未执行，新任务挂起。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pro1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="string">&#x27;学习&#x27;</span>)</span><br><span class="line">  &#125;, <span class="number">2000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> pro2 = pro1.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;考试&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(pro2); <span class="comment">// 打印 Promise &#123; &lt;pending&gt; &#125;</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>若后续处理执行了，则根据后续处理的情况确定新任务的状态<ul>
<li>后续处理执行无错，新任务的状态为完成，数据为后续处理的返回值</li>
<li>后续处理执行有错，新任务的状态为失败，数据为异常对象</li>
<li>后续执行后返回的是一个任务对象，新任务的状态和数据与该任务对象一致</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第二点，第一点和第二点思维一致</span></span><br><span class="line"><span class="keyword">const</span> pro1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> pro2 = pro1.<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;错误&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(pro2);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="comment">// pro1的状态是rejected pro2是对pro1的后续处理，如果catch里面成功处理没有报错，则处理成功pro2是成功态，否则是失败态</span></span><br><span class="line"><span class="comment">// 第三点</span></span><br><span class="line"><span class="keyword">const</span> pro1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">reject</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> pro2 = pro1.<span class="title function_">catch</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(pro2); <span class="comment">// pending pro2的状态和返回的任务对象状态一致</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure></li>
</ol>
<p>由于链式任务的存在，异步代码拥有了更强的表达力</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 常见任务处理代码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 任务成功后，执行处理1，失败则执行处理2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">pro.<span class="title function_">then</span>(处理<span class="number">1</span>).<span class="title function_">catch</span>(处理<span class="number">2</span>) === pro.<span class="title function_">then</span>(处理<span class="number">1</span>，处理<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 任务成功后，依次执行处理1、处理2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">pro.<span class="title function_">then</span>(处理<span class="number">1</span>).<span class="title function_">then</span>(处理<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 任务成功后，依次执行处理1、处理2，若任务失败或前面的处理有错，执行处理3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">pro.<span class="title function_">then</span>(处理<span class="number">1</span>).<span class="title function_">then</span>(处理<span class="number">2</span>).<span class="title function_">catch</span>(处理<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-邓哥的解决方案"><a href="#3-邓哥的解决方案" class="headerlink" title="3.邓哥的解决方案"></a>3.邓哥的解决方案</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向某位女生发送一则表白短信</span></span><br><span class="line"><span class="comment">// name: 女神的姓名</span></span><br><span class="line"><span class="comment">// onFulffiled: 成功后的回调</span></span><br><span class="line"><span class="comment">// onRejected: 失败后的回调</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 模拟 发送表白短信</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">`邓哥 -&gt; <span class="subst">$&#123;name&#125;</span>：最近有谣言说我喜欢你，我要澄清一下，那不是谣言😘`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`等待<span class="subst">$&#123;name&#125;</span>回复......`</span>);</span><br><span class="line">    <span class="comment">// 模拟 女神回复需要一段时间</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 模拟 有10%的几率成功</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt;= <span class="number">0.1</span>) &#123;</span><br><span class="line">        <span class="comment">// 成功，调用 onFuffiled，并传递女神的回复</span></span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：我是九，你是三，除了你还是你😘`</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 失败，调用 onRejected，并传递女神的回复</span></span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：你是个好人😜`</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sendMessage</span>(<span class="string">&#x27;李建国&#x27;</span>)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 失败，继续</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">sendMessage</span>(<span class="string">&#x27;王富贵&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 失败，继续</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">sendMessage</span>(<span class="string">&#x27;周聚财&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 失败，继续</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">sendMessage</span>(<span class="string">&#x27;刘人勇&#x27;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(</span><br><span class="line">    <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 成功，结束</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥终于找到了自己的伴侣&#x27;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function">(<span class="params">reply</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 最后一个也失败了</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥命犯天煞孤星，无伴终老，孤独一生&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>

<h2 id="八、Promise的静态方法"><a href="#八、Promise的静态方法" class="headerlink" title="八、Promise的静态方法"></a>八、Promise的静态方法</h2><h3 id="1-邓哥的新问题"><a href="#1-邓哥的新问题" class="headerlink" title="1.邓哥的新问题"></a>1.邓哥的新问题</h3><p>邓嫂出门时，给邓哥交待了几个任务：</p>
<ol>
<li><p>做饭</p>
<p>可交给电饭煲完成</p>
</li>
<li><p>洗衣服</p>
<p>可交给洗衣机完成</p>
</li>
<li><p>打扫卫生</p>
<p>可交给扫地机器人完成</p>
</li>
</ol>
<p>邓哥需要在所有任务结束后给邓嫂汇报工作，哪些成功了，哪些失败了</p>
<p>为了最大程度的节约时间，邓哥希望这些任务同时进行，最终汇总结果统一处理</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210621142519.png" alt="image-20210621142519937" style="zoom:50%;" />

<p>每个任务可以看做是一个返回Promise的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 做饭</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cook</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥打开了电饭煲&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.5</span>) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">&#x27;饭已ok&#x27;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;做饭却忘了加水，米饭变成了爆米花&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 洗衣服</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">wash</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥打开了洗衣机&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.5</span>) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">&#x27;衣服已经洗好&#x27;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;洗衣服时停水了，洗了个寂寞&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">2500</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打扫卫生</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sweep</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥打开了扫地机器人&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt; <span class="number">0.5</span>) &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">&#x27;地板扫的非常干净&#x27;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">&#x27;扫地机器人被哈士奇一爪掀翻了&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如何利用这三个函数实现邓哥的要求呢？</p>
<h3 id="2-Promise的静态方法"><a href="#2-Promise的静态方法" class="headerlink" title="2.Promise的静态方法"></a>2.Promise的静态方法</h3><table>
<thead>
<tr>
<th>方法名</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>Promise.resolve(data)</td>
<td>直接返回一个完成状态的任务</td>
</tr>
<tr>
<td>Promise.reject(reason)</td>
<td>直接返回一个拒绝状态的任务</td>
</tr>
<tr>
<td>Promise.all(任务数组)</td>
<td>返回一个任务<br />任务数组全部成功则成功<br />任何一个失败则失败<br />返回第一个失败结果和全部成功结果</td>
</tr>
<tr>
<td>Promise.any(任务数组)</td>
<td>返回一个任务<br />任务数组任一成功则成功<br />任务全部失败则失败<br />返回第一个成功结果和全部失败结果</td>
</tr>
<tr>
<td>Promise.allSettled(任务数组)</td>
<td>返回一个任务<br />任务数组全部已决则成功<br />该任务不会失败<br />返回全部结果</td>
</tr>
<tr>
<td>Promise.race(任务数组)</td>
<td>返回一个任务<br />任务数组任一已决则已决，状态和其一致<br />返回第一个完成的结果</td>
</tr>
<tr>
<td><code>补充</code>:Array.prototype.flat()</td>
<td>将一个数组中的子数组全部展开，变成一个数组<br />[[1,2,3],[4,5,6]]-&gt;[1,2,3,4,5,6]</td>
</tr>
</tbody></table>
<h3 id="3-邓哥的解决方案-1"><a href="#3-邓哥的解决方案-1" class="headerlink" title="3.邓哥的解决方案"></a>3.邓哥的解决方案</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([<span class="title function_">cook</span>(), <span class="title function_">wash</span>(), <span class="title function_">sweep</span>()]).<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 处理汇总结果</span></span><br><span class="line">  <span class="keyword">const</span> report = result</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">r</span>) =&gt;</span> (r.<span class="property">status</span> === <span class="string">&#x27;fulfilled&#x27;</span> ? r.<span class="property">value</span> : r.<span class="property">reason</span>))</span><br><span class="line">    .<span class="title function_">join</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(report);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="九、async和await"><a href="#九、async和await" class="headerlink" title="九、async和await"></a>九、async和await</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618161125.png" alt="image-20210618161125894"></p>
<p>有了Promise，异步任务就有了一种统一的处理方式</p>
<p>有了统一的处理方式，ES官方就可以对其进一步优化</p>
<p>ES7推出了两个关键字<code>async</code>和<code>await</code>，用于更加优雅的表达Promise</p>
<h3 id="1-async"><a href="#1-async" class="headerlink" title="1.async"></a>1.async</h3><p>async关键字用于修饰函数，被它修饰的函数，一定返回Promise</p>
<ul>
<li>如果函数内部显式地返回一个 Promise 对象，那么这个 Promise 对象会直接被返回。</li>
<li>如果函数内部返回一个非 Promise 值（如一个数值、字符串、对象等），JavaScript 会自动将这个值包装在一个 resolved 的 Promise 对象中并返回。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// async 是语法糖 被它修饰的函数，一定返回Promise，如：</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">example</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">example</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 在这里执行原本 async 函数内部的逻辑</span></span><br><span class="line">    <span class="comment">// 假设原本 async 函数内部只是简单地返回一个值</span></span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">123</span>);</span><br><span class="line">    <span class="comment">// 如果有异步操作，可以在异步操作完成后调用 resolve 或 reject</span></span><br><span class="line">    <span class="comment">// 例如：</span></span><br><span class="line">    <span class="comment">// someAsyncOperation().then(result =&gt; resolve(result)).catch(error =&gt; reject(error));</span></span><br><span class="line">    <span class="comment">// 假设原本 async 函数内部返回一个Promise,则返回一样内容;可以理解为没写async</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="title function_">resolve</span>(<span class="number">123</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method1</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 该函数的返回值是Promise完成后的数据</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method1</span>(); <span class="comment">// Promise &#123; 1 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method2</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>); <span class="comment">// 若返回的是Promise，则method得到的Promise状态和其一致;可以理解为没写async</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method2</span>(); <span class="comment">// Promise &#123; pending &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method3</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="number">1</span>); <span class="comment">// 若执行过程报错，则任务是rejected</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method3</span>(); <span class="comment">// Promise &#123; &lt;rejected&gt; Error(1) &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 个人扩展不理解的地方</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">all1</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">123</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// all1 可以看成</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">all1</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,rejected</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="number">123</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">all2</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// all2 大致可以看成</span></span><br><span class="line"><span class="keyword">const</span> all2 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,rejected</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">resolve</span>(<span class="number">123</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">all1</span>(),<span class="title function_">all2</span>()) <span class="comment">// Promise &#123; pending &#125;,Promise &#123; 123 &#125;</span></span><br><span class="line"><span class="keyword">const</span> value = <span class="title function_">all1</span>()</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(value); <span class="comment">// Promise &#123; 123 &#125; 此时resolve(123)已被调用</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="comment">/* 为什么二者输出不一样呢</span></span><br><span class="line"><span class="comment">一、const all1 = async () =&gt; &#123; return Promise.resolve(123); &#125;</span></span><br><span class="line"><span class="comment">当你使用const result = all1();来调用这个函数时：</span></span><br><span class="line"><span class="comment">result被赋值为一个 Promise 对象。虽然函数内部返回的 Promise 已经是 resolved 状态，但在外部看来，这个 Promise 对象的状态还处于未决状态（pending）。这是因为异步操作的结果在被外部获取之前，外部并不知道这个 Promise 已经被 resolved。</span></span><br><span class="line"><span class="comment">原因在于 JavaScript 的异步执行机制。当异步函数被调用时，它的执行不会阻塞后续代码的执行。所以，在外部代码执行到查看result的状态时，实际上异步函数内部的 Promise 虽然已经确定了结果，但外部代码还没有机会去消费这个结果，因此表现为 pending 状态。</span></span><br><span class="line"><span class="comment">如果直接打印console.log(all1());，会输出Promise &#123; &lt;pending&gt; &#125;，原因如下：</span></span><br><span class="line"><span class="comment">打印操作是同步进行的。当执行打印语句时，异步函数all1已经开始执行，但还没有完成将内部的 resolved Promise 的结果传递给外部。</span></span><br><span class="line"><span class="comment">仅仅打印函数调用的结果，实际上是打印了 Promise 对象本身。而在这个时候，由于外部还没有接收到 Promise 的 resolved 值，所以只能看到 Promise 对象的初始状态描述，即&lt;pending&gt;。</span></span><br><span class="line"><span class="comment">二、const all2 = async () =&gt; &#123; return 123; &#125;</span></span><br><span class="line"><span class="comment">在这个版本中，异步函数直接返回一个值 123。</span></span><br><span class="line"><span class="comment">JavaScript 会自动将这个值包装在一个 resolved 的 Promise 对象中并返回。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h3 id="2-await"><a href="#2-await" class="headerlink" title="2.await"></a>2.await</h3><p><code>await</code>关键字表示等待某个Promise完成，<strong>它必须用于<code>async</code>函数中</strong></p>
<blockquote>
<p><code>await</code>只会阻塞所在的异步函数，不会阻塞整个程序的执行。如果有其他不相关的代码在其他地方执行，或者在另一个异步函数中，它们不会被这个<code>await</code>阻塞。如果 <code>await</code> 后面的表达式不是一个 Promise 对象，JavaScript 引擎会尝试将其转换为一个已兑现的 Promise 对象，其值为该表达式的值。await 表达式 后面的代码都是在.then中执行，也就是放入微队列。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">// 1</span></span><br><span class="line">  <span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上面的函数等同于</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">// async</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// await</span></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>).<span class="title function_">then</span>(<span class="function"><span class="params">n</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">      <span class="title function_">resolve</span>(n)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>await</code>也可以等待其他数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="number">1</span>; <span class="comment">// 等同于 await Promise.resolve(1)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果需要针对失败的任务进行处理，可以使用<code>try-catch</code>语法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="number">123</span>); <span class="comment">// 这句代码将抛出异常</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;成功&#x27;</span>, n)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(err)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;失败&#x27;</span>, err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method</span>(); <span class="comment">// 输出： 失败 123</span></span><br></pre></td></tr></table></figure>

<h3 id="3-邓哥表白的完美解决方案"><a href="#3-邓哥表白的完美解决方案" class="headerlink" title="3.邓哥表白的完美解决方案"></a>3.邓哥表白的完美解决方案</h3><p>邓哥的女神可不是只有4位，而是40位！</p>
<p>为了更加方便的编写表白代码，邓哥决定把这40位女神放到一个数组中，然后利用async和await轻松完成代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 女神的名字数组</span></span><br><span class="line"><span class="keyword">const</span> beautyGirls = [</span><br><span class="line">  <span class="string">&#x27;梁平&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;邱杰&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;王超&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;冯秀兰&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;赖军&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;顾强&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;戴敏&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;吕涛&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;冯静&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;蔡明&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;廖磊&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;冯洋&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;韩杰&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;江涛&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;文艳&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;杜秀英&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;丁艳&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;邓静&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;江刚&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;乔刚&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;史平&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;康娜&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;袁磊&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;龙秀英&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;姚静&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;潘娜&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;萧磊&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;邵勇&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;李芳&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;谭芳&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;夏秀英&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;程娜&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;武杰&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;崔军&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;廖勇&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;崔强&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;康秀英&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;余磊&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;邵勇&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;贺涛&#x27;</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向某位女生发送一则表白短信</span></span><br><span class="line"><span class="comment">// name: 女神的姓名</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 模拟 发送表白短信</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">`邓哥 -&gt; <span class="subst">$&#123;name&#125;</span>：最近有谣言说我喜欢你，我要澄清一下，那不是谣言😘`</span></span><br><span class="line">    );</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`等待<span class="subst">$&#123;name&#125;</span>回复......`</span>);</span><br><span class="line">    <span class="comment">// 模拟 女神回复需要一段时间</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 模拟 有10%的几率成功</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &lt;= <span class="number">0.1</span>) &#123;</span><br><span class="line">        <span class="comment">// 成功，调用 onFuffiled，并传递女神的回复</span></span><br><span class="line">        <span class="title function_">resolve</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：我是九，你是三，除了你还是你😘`</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 失败，调用 onRejected，并传递女神的回复</span></span><br><span class="line">        <span class="title function_">reject</span>(<span class="string">`<span class="subst">$&#123;name&#125;</span> -&gt; 邓哥：你是个好人😜`</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 批量表白的程序</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">proposal</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> isSuccess = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> girl <span class="keyword">of</span> beautyGirls) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> reply = <span class="keyword">await</span> <span class="title function_">sendMessage</span>(girl); <span class="comment">// 等这个函数调用完成再进行下一步</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;表白成功!&#x27;</span>);</span><br><span class="line">      isSuccess = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>; <span class="comment">// 表白成功退出循环</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (reply) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(reply);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;表白失败&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!isSuccess) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;邓哥注定孤独一生&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">proposal</span>();</span><br></pre></td></tr></table></figure>

<h2 id="十、面试题考点"><a href="#十、面试题考点" class="headerlink" title="十、面试题考点"></a>十、面试题考点</h2><h3 id="1-Promise的基本概念"><a href="#1-Promise的基本概念" class="headerlink" title="1.Promise的基本概念"></a>1.Promise的基本概念</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210618161125.png" alt="image-20210618161125894"></p>
<h3 id="2-链式调用规则"><a href="#2-链式调用规则" class="headerlink" title="2.链式调用规则"></a>2.链式调用规则</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210621103501.png" alt="image-20210621103501094"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://mdrs.yuanjin.tech/img/20210621103501.png" alt="image-20210621103501094"></p>
<ol>
<li><p>then方法必定会返回一个新的Promise</p>
<p>可理解为<code>后续处理也是一个任务</code></p>
</li>
<li><p>新任务的状态取决于后续处理：</p>
<ul>
<li><p>若没有相关的后续处理，新任务的状态和前任务一致，数据为前任务的数据</p>
</li>
<li><p>若有后续处理但还未执行，新任务挂起。</p>
</li>
<li><p>若后续处理执行了，则根据后续处理的情况确定新任务的状态</p>
<ul>
<li>后续处理执行无错，新任务的状态为完成，数据为后续处理的返回值</li>
<li>后续处理执行有错，新任务的状态为失败，数据为异常对象</li>
<li>后续执行后返回的是一个任务对象，新任务的状态和数据与该任务对象一致</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="3-Promise的静态方法"><a href="#3-Promise的静态方法" class="headerlink" title="3.Promise的静态方法"></a>3.Promise的静态方法</h3><table>
<thead>
<tr>
<th>方法名</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>Promise.resolve(data)</td>
<td>直接返回一个完成状态的任务</td>
</tr>
<tr>
<td>Promise.reject(reason)</td>
<td>直接返回一个拒绝状态的任务</td>
</tr>
<tr>
<td>Promise.all(任务数组)</td>
<td>返回一个任务<br />任务数组全部成功则成功<br />任何一个失败则失败</td>
</tr>
<tr>
<td>Promise.any(任务数组)</td>
<td>返回一个任务<br />任务数组任一成功则成功<br />任务全部失败则失败</td>
</tr>
<tr>
<td>Promise.allSettled(任务数组)</td>
<td>返回一个任务<br />任务数组全部已决则成功<br />该任务不会失败</td>
</tr>
<tr>
<td>Promise.race(任务数组)</td>
<td>返回一个任务<br />任务数组任一已决则已决，状态和其一致</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="4-async和await"><a href="#4-async和await" class="headerlink" title="4.async和await"></a>4.async和await</h3><p>有了Promise，异步任务就有了一种统一的处理方式</p>
<p>有了统一的处理方式，ES官方就可以对其进一步优化</p>
<p>ES7推出了两个关键字<code>async</code>和<code>await</code>，用于更加优雅的表达Promise</p>
<h4 id="async"><a href="#async" class="headerlink" title="async"></a>async</h4><p>async关键字用于修饰函数，被它修饰的函数，一定返回Promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method1</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 该函数的返回值是Promise完成后的数据</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method1</span>(); <span class="comment">// Promise &#123; 1 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method2</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>); <span class="comment">// 若返回的是Promise，则method得到的Promise状态和其一致</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method2</span>(); <span class="comment">// Promise &#123; 1 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method3</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="number">1</span>); <span class="comment">// 若执行过程报错，则任务是rejected</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method3</span>(); <span class="comment">// Promise &#123; &lt;rejected&gt; Error(1) &#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="await"><a href="#await" class="headerlink" title="await"></a>await</h4><p><code>await</code>关键字表示等待某个Promise完成，<strong>它必须用于<code>async</code>函数中</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上面的函数等同于</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>).<span class="title function_">then</span>(<span class="function"><span class="params">n</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">      <span class="title function_">resolve</span>(<span class="number">1</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>await</code>也可以等待其他数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="number">1</span>; <span class="comment">// 等同于 await Promise.resolve(1)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果需要针对失败的任务进行处理，可以使用<code>try-catch</code>语法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">method</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="number">123</span>); <span class="comment">// 这句代码将抛出异常</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;成功&#x27;</span>, n)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span>(err)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;失败&#x27;</span>, err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">method</span>(); <span class="comment">// 输出： 失败 123</span></span><br></pre></td></tr></table></figure>

<h3 id="5-事件循环"><a href="#5-事件循环" class="headerlink" title="5.事件循环"></a>5.事件循环</h3><p>根据目前所学，进入事件队列的函数有以下几种：</p>
<ul>
<li><code>setTimeout</code>的回调，宏任务（macro task）</li>
<li><code>setInterval</code>的回调，宏任务（macro task）</li>
<li>Promise的<code>then</code>函数回调，<strong>微任务</strong>（micro task）</li>
<li><code>requestAnimationFrame</code>的回调，宏任务（macro task）</li>
<li>事件处理函数，宏任务(macro task)</li>
</ul>
<h2 id="十一、面试题"><a href="#十一、面试题" class="headerlink" title="十一、面试题"></a>十一、面试题</h2><ol>
<li><p>下面代码的输出结果是什么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>); </span><br><span class="line">    <span class="title function_">resolve</span>(); </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>); <span class="comment">// then任务进入微队列</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br><span class="line"><span class="comment">// 1 2 4 3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>); </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123; <span class="comment">// 定时器进入宏队列</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)</span><br><span class="line">      <span class="title function_">resolve</span>(); </span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>); <span class="comment">// resolve()调用后才进入微队列</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>);</span><br><span class="line"><span class="comment">// 1 5 2 3 4</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise1 = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">resolve</span>()</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> promise2 = promise1.<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>, promise1) <span class="comment">// pending</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>, promise2) <span class="comment">// pending</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>, promise1) <span class="comment">// Promise &#123; undefined &#125; fulfilled</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>, promise2) <span class="comment">// Promise &#123; undefined &#125; fulfilled</span></span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么 ▲</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">m</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="number">1</span>; <span class="comment">// 放入微队列</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 上面等价于</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">m</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">n</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(n)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125; </span><br><span class="line"><span class="title function_">m</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么 ▲</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">m</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">m</span>()); <span class="comment">// pending 因为函数还没运行完 因为将n赋值也就是.then方法放入了微队列，要等js代码执行完再执行微队列里的任务</span></span><br><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">m</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>); <span class="comment">// m()完成后，这句代码才会放入微队列</span></span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0 3 1 2</span></span><br></pre></td></tr></table></figure>


</li>
<li><p>下面代码的输出结果是什么 🔺</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">m1</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">m2</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="keyword">await</span> <span class="title function_">m1</span>(); <span class="comment">// 放入微队列</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">m3</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> n = <span class="title function_">m2</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">m3</span>().<span class="title function_">then</span>(<span class="function"><span class="params">n</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">m3</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br><span class="line"><span class="comment">// pending pending 4 1 3 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">1</span>)	</span><br><span class="line">  .<span class="title function_">then</span>(<span class="number">2</span>) <span class="comment">// 如果then里面传的不是函数，可以看作没写，直接删掉.then(2)。严格来说，如果不是函数，可以理解为该then方法返回的是原来的Promise</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">3</span>)) <span class="comment">// 单独看Promise.resolve(3)不是一个函数，而是一个 Promise 对象的创建表达式</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="variable language_">console</span>.<span class="property">log</span>) <span class="comment">// 函数</span></span><br><span class="line"><span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么🔺</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">resolve</span>();</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise3&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise4&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">a = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">async</span> (resolve, reject) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="keyword">await</span> b;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;after1&#x27;</span>);</span><br><span class="line">  <span class="keyword">await</span> a</span><br><span class="line">  <span class="title function_">resolve</span>(<span class="literal">true</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;after2&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;end&#x27;</span>);</span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下面代码的输出结果是什么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async1</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async1 start&#x27;</span>);</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">async2</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async1 end&#x27;</span>); <span class="comment">// async2.then里的，进入微队列</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">async2</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;async2&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script start&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;setTimeout&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">async1</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise1&#x27;</span>);</span><br><span class="line">    <span class="title function_">resolve</span>();</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;promise2&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;script end&#x27;</span>);</span><br><span class="line"><span class="comment">// script start,async1 start,async2，promise1，script end，async1 end，promise2，setTimeout</span></span><br></pre></td></tr></table></figure></li>
</ol>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">拾贰</div><div class="post-copyright__author_desc">得失从缘,心无增减</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/')">JavaScript语言提升(ES6+)</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/q6Stn5jbXVzxHmC.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/Qa1oSxc3nlEeGOt.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=JavaScript语言提升(ES6+)&amp;url=http://example.com/2024/10/08/JavaScript%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-%20ES6+/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">拾贰</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/JavaScript/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>JavaScript<span class="tagsPageCount">4</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/30/HTML-CSS%E8%AF%AD%E8%A8%80%E6%8F%90%E5%8D%87-HTML5%E6%89%8B%E5%86%8C/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">HTML+CSS语言提升(HTML5手册)</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/22/%E7%BD%91%E7%BB%9C/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">网络</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/09/03/JS%E6%94%B6%E5%AE%98-%E4%B8%80/" title="JS收官(一)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-03</div><div class="title">JS收官(一)</div></div></a></div><div><a href="/2024/09/24/JS%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" title="JS项目实战"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-24</div><div class="title">JS项目实战</div></div></a></div><div><a href="/2024/09/09/JS%E6%94%B6%E5%AE%98-%E4%BA%8C/" title="JS收官(二)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-09</div><div class="title">JS收官(二)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2023/09/01/NzaWb31teHk5UuX.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/zhheo/Sticker-Heo@latest/Sticker-100/滑稽被子.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">拾贰进行项目开发</b>相关的问题和看法，还有<b style="color:#fff">一些其他的知识</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">拾贰</h1><div class="author-info__desc">得失从缘,心无增减</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/tentwo24" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/2104980654" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%9B%B6%E7%A2%8E%E7%9A%84%E6%94%B9%E5%8A%A8"><span class="toc-number">1.</span> <span class="toc-text">一、零碎的改动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.1.</span> <span class="toc-text">1.严格模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-let-%E5%92%8C-const"><span class="toc-number">1.2.</span> <span class="toc-text">2.let 和 const</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B9%82%E8%BF%90%E7%AE%97"><span class="toc-number">1.3.</span> <span class="toc-text">3.幂运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B0%E5%A2%9EAPI"><span class="toc-number">1.4.</span> <span class="toc-text">4.字符串新增API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.5.</span> <span class="toc-text">5.模板字符串</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B0%E7%BB%84"><span class="toc-number">2.</span> <span class="toc-text">二、数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-for-of-%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.1.</span> <span class="toc-text">1.for-of 循环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%96%B0%E5%A2%9EAPI"><span class="toc-number">2.2.</span> <span class="toc-text">2.新增API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.</span> <span class="toc-text">三、对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%AF%B9%E8%B1%A1%E6%88%90%E5%91%98%E9%80%9F%E5%86%99"><span class="toc-number">3.1.</span> <span class="toc-text">1.对象成员速写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%A7%A3%E6%9E%84"><span class="toc-number">3.2.</span> <span class="toc-text">2.解构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B1%95%E5%BC%80%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">3.3.</span> <span class="toc-text">3.展开运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="toc-number">3.4.</span> <span class="toc-text">4.属性描述符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#getter-%E5%92%8C-setter"><span class="toc-number">3.4.1.</span> <span class="toc-text">getter 和 setter</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%94%AE%E5%80%BC%E5%AF%B9"><span class="toc-number">3.5.</span> <span class="toc-text">5.键值对</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%86%BB%E7%BB%93"><span class="toc-number">3.6.</span> <span class="toc-text">6.冻结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E7%9B%B8%E5%90%8C%E6%80%A7%E5%88%A4%E5%AE%9A"><span class="toc-number">3.7.</span> <span class="toc-text">7.相同性判定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Set"><span class="toc-number">3.8.</span> <span class="toc-text">8.Set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-Map"><span class="toc-number">3.9.</span> <span class="toc-text">9.Map</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">四、函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.</span> <span class="toc-text">1.箭头函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%89%A9%E4%BD%99%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.</span> <span class="toc-text">2.剩余参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%82%E6%95%B0%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">4.3.</span> <span class="toc-text">3.参数默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%B1%BB%E8%AF%AD%E6%B3%95"><span class="toc-number">4.4.</span> <span class="toc-text">4.类语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%87%BD%E6%95%B0API"><span class="toc-number">4.5.</span> <span class="toc-text">5.函数API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF"><span class="toc-number">5.</span> <span class="toc-text">五、事件循环</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E8%BF%9B%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.1.</span> <span class="toc-text">1.浏览器的进程模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%95%E4%B8%BA%E8%BF%9B%E7%A8%8B%EF%BC%9F"><span class="toc-number">5.1.1.</span> <span class="toc-text">何为进程？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%95%E4%B8%BA%E7%BA%BF%E7%A8%8B%EF%BC%9F"><span class="toc-number">5.1.2.</span> <span class="toc-text">何为线程？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%9C%89%E5%93%AA%E4%BA%9B%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B%EF%BC%9F"><span class="toc-number">5.1.3.</span> <span class="toc-text">浏览器有哪些进程和线程？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%B8%B2%E6%9F%93%E4%B8%BB%E7%BA%BF%E7%A8%8B%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F"><span class="toc-number">5.2.</span> <span class="toc-text">2.渲染主线程是如何工作的？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%8B%A5%E5%B9%B2%E8%A7%A3%E9%87%8A"><span class="toc-number">5.3.</span> <span class="toc-text">3.若干解释</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%95%E4%B8%BA%E5%BC%82%E6%AD%A5%EF%BC%9F"><span class="toc-number">5.3.1.</span> <span class="toc-text">何为异步？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JS%E4%B8%BA%E4%BD%95%E4%BC%9A%E9%98%BB%E7%A2%8D%E6%B8%B2%E6%9F%93%EF%BC%9F"><span class="toc-number">5.3.2.</span> <span class="toc-text">JS为何会阻碍渲染？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E6%9C%89%E4%BC%98%E5%85%88%E7%BA%A7%E5%90%97%EF%BC%9F"><span class="toc-number">5.3.3.</span> <span class="toc-text">任务有优先级吗？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81Promise%E5%9F%BA%E7%A1%80"><span class="toc-number">6.</span> <span class="toc-text">六、Promise基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%82%93%E5%93%A5%E7%9A%84%E7%83%A6%E6%81%BC"><span class="toc-number">6.1.</span> <span class="toc-text">1.邓哥的烦恼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Promise%E8%A7%84%E8%8C%83"><span class="toc-number">6.2.</span> <span class="toc-text">2.Promise规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Promise-API"><span class="toc-number">6.3.</span> <span class="toc-text">3.Promise API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%82%93%E5%93%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">6.4.</span> <span class="toc-text">4. 邓哥的解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81Promise%E7%9A%84%E9%93%BE%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">七、Promise的链式处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-catch%E6%96%B9%E6%B3%95"><span class="toc-number">7.1.</span> <span class="toc-text">1.catch方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8"><span class="toc-number">7.2.</span> <span class="toc-text">2.链式调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%82%93%E5%93%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">7.3.</span> <span class="toc-text">3.邓哥的解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81Promise%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">8.</span> <span class="toc-text">八、Promise的静态方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%82%93%E5%93%A5%E7%9A%84%E6%96%B0%E9%97%AE%E9%A2%98"><span class="toc-number">8.1.</span> <span class="toc-text">1.邓哥的新问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Promise%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">8.2.</span> <span class="toc-text">2.Promise的静态方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%82%93%E5%93%A5%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-1"><span class="toc-number">8.3.</span> <span class="toc-text">3.邓哥的解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81async%E5%92%8Cawait"><span class="toc-number">9.</span> <span class="toc-text">九、async和await</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-async"><span class="toc-number">9.1.</span> <span class="toc-text">1.async</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-await"><span class="toc-number">9.2.</span> <span class="toc-text">2.await</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%82%93%E5%93%A5%E8%A1%A8%E7%99%BD%E7%9A%84%E5%AE%8C%E7%BE%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">9.3.</span> <span class="toc-text">3.邓哥表白的完美解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E9%9D%A2%E8%AF%95%E9%A2%98%E8%80%83%E7%82%B9"><span class="toc-number">10.</span> <span class="toc-text">十、面试题考点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Promise%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">10.1.</span> <span class="toc-text">1.Promise的基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%E8%A7%84%E5%88%99"><span class="toc-number">10.2.</span> <span class="toc-text">2.链式调用规则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Promise%E7%9A%84%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">10.3.</span> <span class="toc-text">3.Promise的静态方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-async%E5%92%8Cawait"><span class="toc-number">10.4.</span> <span class="toc-text">4.async和await</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#async"><span class="toc-number">10.4.1.</span> <span class="toc-text">async</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#await"><span class="toc-number">10.4.2.</span> <span class="toc-text">await</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF"><span class="toc-number">10.5.</span> <span class="toc-text">5.事件循环</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-number">11.</span> <span class="toc-text">十一、面试题</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/16/%E6%96%B0React/" title="新React">新React</a><time datetime="2024-12-16T06:27:55.246Z" title="发表于 2024-12-16 14:27:55">2024-12-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/04/TypeScript%E5%9F%BA%E7%A1%80/" title="TypeScript基础">TypeScript基础</a><time datetime="2024-12-04T09:17:42.905Z" title="发表于 2024-12-04 17:17:42">2024-12-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/27/Vue3/" title="Vue3入门+就业">Vue3入门+就业</a><time datetime="2024-11-27T05:23:16.877Z" title="发表于 2024-11-27 13:23:16">2024-11-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/18/Vue%E9%A1%B9%E7%9B%AE%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86/" title="个人博客后台">个人博客后台</a><time datetime="2024-11-18T06:37:03.534Z" title="发表于 2024-11-18 14:37:03">2024-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/29/Vue%E9%A1%B9%E7%9B%AE%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" title="个人博客前台">个人博客前台</a><time datetime="2024-10-29T03:19:35.564Z" title="发表于 2024-10-29 11:19:35">2024-10-29</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="拾贰" target="_blank">拾贰</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">23</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/HTML-CSS/" style="font-size: 0.88rem;">HTML+CSS<sup>4</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>4</sup></a><a href="/tags/React/" style="font-size: 0.88rem;">React<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>1</sup></a><a href="/tags/Uniapp/" style="font-size: 0.88rem;">Uniapp<sup>2</sup></a><a href="/tags/Vue/" style="font-size: 0.88rem;">Vue<sup>2</sup></a><a href="/tags/Vue2/" style="font-size: 0.88rem;">Vue2<sup>2</sup></a><a href="/tags/Vue3/" style="font-size: 0.88rem;">Vue3<sup>1</sup></a><a href="/tags/Webpack/" style="font-size: 0.88rem;">Webpack<sup>2</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7%E5%BA%93/" style="font-size: 0.88rem;">工具库<sup>1</sup></a><a href="/tags/%E5%B7%A5%E7%A8%8B%E5%8C%96/" style="font-size: 0.88rem;">工程化<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">网络<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 拾贰 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>